<!DOCTYPE html>
<!-- saved from url=(0037) #_freebuilder_mapping -->
<html lang="zh-CN" class="translated-ltr"><script id="allow-copy_script">(function agent() {
    let unlock = false
    document.addEventListener('allow_copy', (event) => {
      unlock = event.detail.unlock
    })

    const copyEvents = [
      'copy',
      'cut',
      'contextmenu',
      'selectstart',
      'mousedown',
      'mouseup',
      'mousemove',
      'keydown',
      'keypress',
      'keyup',
    ]
    const rejectOtherHandlers = (e) => {
      if (unlock) {
        e.stopPropagation()
        if (e.stopImmediatePropagation) e.stopImmediatePropagation()
      }
    }
    copyEvents.forEach((evt) => {
      document.documentElement.addEventListener(evt, rejectOtherHandlers, {
        capture: true,
      })
    })
  })()</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Jdbi 3 开发者指南</title>
<link rel="stylesheet" href="./Jdbi 3 开发者指南_files/css">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="./Jdbi 3 开发者指南_files/font-awesome.min.css">
<link rel="icon" type="image/png" href="http://jdbi.org/images/favicon.png">
<style type="text/css">/* Copyright 2014-present Evernote Corporation. All rights reserved. */
@keyframes caretBlink {
    from { opacity: 1.0; }
    to { opacity: 0.0; }
}

@keyframes rotateSpinner {
    from {
        transform:rotate(0deg);
    }
    to {
        transform:rotate(360deg);
    }
}

#text-tool-caret {
    animation-name: caretBlink;  
    animation-iteration-count: infinite;  
    animation-timing-function: cubic-bezier(1.0,0,0,1.0);
    animation-duration: 1s; 
}

#en-markup-loading-spinner {
    position: absolute;
    top: calc(50% - 16px);
    left: calc(50% - 16px);
    width: 32px;
    height: 32px;
}

#en-markup-loading-spinner img {
    position: relative;
    top: 0px;
    left: 0px;
    animation-name: rotateSpinner;
    animation-duration: 0.6s;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
</style><style type="text/css">/* Copyright 2014-present Evernote Corporation. All rights reserved. */
.skitchToastBoxContainer {
    position: absolute;
    width: 100%;
    text-align: center;
    top: 30px;
    -webkit-user-select: none;
    -moz-user-select: none;
    pointer-events: none;
}

.skitchToastBox {
    width: 200px;
    height: 16px;
    padding: 12px;
    background-color: rgba(47, 55, 61, 0.95);
    border-radius: 4px;
    color: white;
    cursor: default;
    font-size: 10pt;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.32);
    font-family: 'Soleil', Helvetica, Arial, sans-serif;
    border: 2px rgba(255, 255, 255, 0.38) solid;
}

.lang-zh-cn .skitchToastBox {
    font-family: '微软雅黑', 'Microsoft YaHei', SimSun,
        '&#x30E1;&#x30A4;&#x30EA;&#x30AA;', Meiryo, 'MS PGothic', 'Soleil',
        Helvetica, Arial, sans-serif;
}

.lang-ja-jp .skitchToastBox {
    font-family: '&#x30E1;&#x30A4;&#x30EA;&#x30AA;', Meiryo, 'MS PGothic',
        '微软雅黑', 'Microsoft YaHei', SimSun, 'Soleil', Helvetica, Arial,
        sans-serif;
}

.skitchToast {
    padding-left: 20px;
    padding-right: 20px;
    display: inline-block;
    height: 10px;
    color: #f1f5f8;
    text-align: center;
}

.skitchVisible {
    /* Don't remove this class it's a hack used by the Evernote Clipper */
}
</style><style type="text/css">/* Copyright 2014-present Evernote Corporation. All rights reserved. */

@font-face {
	font-family: 'Soleil';
	src: url(data:application/font-woff2;base64,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);
	font-weight: normal;
	font-style: normal;
}
</style><style type="text/css">/* Copyright 2019-present Evernote Corporation. All rights reserved. */

#en-markup-disabled {
    position: fixed;
    z-index: 9999;
    width: 100%;
    height: 100%;
    top: 0px;
    left: 0px;
    cursor: default;
    -webkit-user-select: none;
}

#en-markup-alert-container {
    position: absolute;
    z-index: 9999;
    width: 450px;
    left: calc(50% - 225px);
    top: calc(50% - 85px);
    background-color: white;
    box-shadow: 0 2px 7px 1px rgba(0,0,0,0.35);
    -webkit-user-select: none;
}

#en-markup-alert-container .cell-1 {
    position: relative;
    height: 110px;
    width: 105px;
    float: left;
    text-align: center;
    background-image: url(data:image/png;base64,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);
    background-position: 65% 50%;
    background-repeat: no-repeat;
}

#en-markup-alert-container .cell-2 {
    position: relative;
    float: left;
    width: 345px;
    margin-top: 29px;
    margin-bottom: 20px;
}

#en-markup-alert-container .cell-2 .cell-2-title {
    margin-bottom: 5px;
    padding-right: 30px;
    font-size: 12pt;
    font-family: Tahoma, Arial;
}

#en-markup-alert-container .cell-2 .cell-2-message {
    padding-right: 30px;
    font-size: 9.5pt;
    font-family: Tahoma, Arial;
}

#en-markup-alert-container .cell-3 {
    position: relative;
    width: 450px;
    height: 60px;
    float: left;
    background-color: rgb(240,240,240);
}

#en-markup-alert-container .cell-3 button {
    position: absolute;
    top: 12px;
    right: 15px;
    width: 110px;
    height: 36px;
}

#en-markup-alert-container .cell-3 button.alt-button {
    position: absolute;
    top: 12px;
    right: 140px;
    width: 110px;
    height: 36px;
}
</style><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Jdbi 3 开发者指南_files/translateelement.css"></head>
<body class="book toc2 toc-left vsc-initialized">
<div id="header">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 3 开发者指南</font></font></h1>
<div class="details">
<span id="revnumber"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本 3.21.1-快照，</font></font></span>
<span id="revdate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">07/16/2021 14:53 -0700</font></font></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></div>
<ul class="sectlevel1">
<li><a href=" #_introduction_to_jdbi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一、Jdbi介绍</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_fluent_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">流利的API</font></font></a></li>
<li><a href=" #_declarative_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">声明式 API</font></font></a></li>
</ul>
</li>
<li><a href=" #_getting_started"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. 入门</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_java_compatibility"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1. </font><font style="vertical-align: inherit;">Java 兼容性</font></font></a></li>
<li><a href=" #_modules"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2. </font><font style="vertical-align: inherit;">模块</font></font></a></li>
<li><a href=" #_forethoughts"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3. </font><font style="vertical-align: inherit;">远见</font></font></a></li>
</ul>
</li>
<li><a href=" #_core_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. 核心API</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_jdbi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1. </font><font style="vertical-align: inherit;">杰比</font></font></a></li>
<li><a href=" #_handle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2. </font><font style="vertical-align: inherit;">处理</font></font></a></li>
<li><a href=" #_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3. </font><font style="vertical-align: inherit;">参数</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_positional_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.1. </font><font style="vertical-align: inherit;">位置参数</font></font></a></li>
<li><a href=" #_named_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.2. </font><font style="vertical-align: inherit;">命名参数</font></font></a></li>
<li><a href=" #_supported_argument_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.3. </font><font style="vertical-align: inherit;">支持的参数类型</font></font></a></li>
<li><a href=" #_binding_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.4. </font><font style="vertical-align: inherit;">绑定参数</font></font></a></li>
<li><a href=" #_custom_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.5. </font><font style="vertical-align: inherit;">自定义参数</font></font></a></li>
</ul>
</li>
<li><a href=" #_queries"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.4. </font><font style="vertical-align: inherit;">查询</font></font></a></li>
<li><a href=" #_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5. </font><font style="vertical-align: inherit;">映射器</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_row_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.1. </font><font style="vertical-align: inherit;">行映射器</font></font></a></li>
<li><a href=" #_column_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.2. </font><font style="vertical-align: inherit;">列映射器</font></font></a></li>
<li><a href=" #_primitive_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.3. </font><font style="vertical-align: inherit;">原始映射</font></font></a></li>
<li><a href=" #_immutables_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.4. </font><font style="vertical-align: inherit;">不可变映射</font></font></a></li>
<li><a href=" #_freebuilder_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.5. </font><font style="vertical-align: inherit;">自由建造者映射</font></font></a></li>
<li><a href=" #_reflection_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.6. </font><font style="vertical-align: inherit;">反射映射器</font></font></a></li>
</ul>
</li>
<li><a href=" #_codecs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6. </font><font style="vertical-align: inherit;">编解码器</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_resolving_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6.1. </font><font style="vertical-align: inherit;">解析类型</font></font></a></li>
</ul>
</li>
<li><a href=" #_templating"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.7. </font><font style="vertical-align: inherit;">模板制作</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_classpathsqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.7.1. </font><font style="vertical-align: inherit;">类路径SqlLocator</font></font></a></li>
</ul>
</li>
<li><a href=" #_sql_arrays"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8. </font><font style="vertical-align: inherit;">SQL 数组</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_registering_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.1. </font><font style="vertical-align: inherit;">注册数组类型</font></font></a></li>
<li><a href=" #_binding_custom_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.2. </font><font style="vertical-align: inherit;">绑定自定义数组类型</font></font></a></li>
<li><a href=" #_mapping_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.3. </font><font style="vertical-align: inherit;">映射数组类型</font></font></a></li>
</ul>
</li>
<li><a href=" #_results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9. </font><font style="vertical-align: inherit;">结果</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_resultbearing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.1. </font><font style="vertical-align: inherit;">结果轴承</font></font></a></li>
<li><a href=" #_resultiterable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.2. </font><font style="vertical-align: inherit;">结果可迭代</font></font></a></li>
<li><a href=" #_joins"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.3. </font><font style="vertical-align: inherit;">加入</font></font></a></li>
</ul>
</li>
<li><a href=" #_updates"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.10. </font><font style="vertical-align: inherit;">更新</font></font></a></li>
<li><a href=" #_batches"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.11. </font><font style="vertical-align: inherit;">批次</font></font></a></li>
<li><a href=" #_prepared_batches"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.12. </font><font style="vertical-align: inherit;">准备批次</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_exception_rewriting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.12.1. </font><font style="vertical-align: inherit;">异常重写</font></font></a></li>
</ul>
</li>
<li><a href=" #_generated_keys"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.13. </font><font style="vertical-align: inherit;">生成的密钥</font></font></a></li>
<li><a href=" #_stored_procedure_calls"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.14. </font><font style="vertical-align: inherit;">存储过程调用</font></font></a></li>
<li><a href=" #_scripts"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.15. </font><font style="vertical-align: inherit;">脚本</font></font></a></li>
<li><a href=" #_transactions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.16. </font><font style="vertical-align: inherit;">交易</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_serializable_transactions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.16.1. </font><font style="vertical-align: inherit;">可序列化事务</font></font></a></li>
</ul>
</li>
<li><a href=" #_metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.17. </font><font style="vertical-align: inherit;">元数据</font></font></a></li>
</ul>
</li>
<li><a href=" #_configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. 配置</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_qualified_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1. </font><font style="vertical-align: inherit;">合格类型</font></font></a></li>
</ul>
</li>
<li><a href=" #_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. SQL 对象</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_annotated_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1. </font><font style="vertical-align: inherit;">注释方法</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_sqlupdate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.1. </font><font style="vertical-align: inherit;">@SqlUpdate</font></font></a></li>
<li><a href=" #_binding_arguments_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.2. </font><font style="vertical-align: inherit;">绑定参数</font></font></a></li>
<li><a href=" #_sqlquery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.3. </font><font style="vertical-align: inherit;">@SqlQuery</font></font></a></li>
<li><a href=" #_sqlbatch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.4. </font><font style="vertical-align: inherit;">@SqlBatch</font></font></a></li>
<li><a href=" #_sqlcall"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.5. </font><font style="vertical-align: inherit;">@SqlCall</font></font></a></li>
<li><a href=" #_sqlscript"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.6. </font><font style="vertical-align: inherit;">@SqlScript</font></font></a></li>
<li><a href=" #_getgeneratedkeys_3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.7. </font><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></li>
<li><a href=" #_sqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.8. </font><font style="vertical-align: inherit;">数据库定位器</font></font></a></li>
<li><a href=" #_createsqlobject"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.9. </font><font style="vertical-align: inherit;">@CreateSqlObject</font></font></a></li>
<li><a href=" #_timestamped"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.10. </font><font style="vertical-align: inherit;">@时间戳</font></font></a></li>
</ul>
</li>
<li><a href=" #_consumer_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2. </font><font style="vertical-align: inherit;">消费者方法</font></font></a></li>
<li><a href=" #_default_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.3. </font><font style="vertical-align: inherit;">默认方法</font></font></a></li>
<li><a href=" #_transaction_management"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.4. </font><font style="vertical-align: inherit;">交易管理</font></font></a></li>
<li><a href=" #_using_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5. </font><font style="vertical-align: inherit;">使用 SQL 对象</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_attached_to_handle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.1. </font><font style="vertical-align: inherit;">附在手柄上</font></font></a></li>
<li><a href=" #_temporary_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.2. </font><font style="vertical-align: inherit;">临时 SQL 对象</font></font></a></li>
<li><a href=" #_on_demand"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.3. </font><font style="vertical-align: inherit;">一经请求</font></font></a></li>
</ul>
</li>
<li><a href=" #_additional_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.6. </font><font style="vertical-align: inherit;">附加注释</font></font></a></li>
<li><a href=" #_annotations_and_inheritance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7. </font><font style="vertical-align: inherit;">注释和继承</font></font></a></li>
</ul>
</li>
<li><a href=" #_testing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. 测试</font></font></a></li>
<li><a href=" #_third_party_integration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. 第三方集成</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_google_guava"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1. </font><font style="vertical-align: inherit;">谷歌番石榴</font></font></a></li>
<li><a href=" #_h2_database"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2. </font><font style="vertical-align: inherit;">H2 数据库</font></font></a></li>
<li><a href=" #jdbi3-json"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3. </font><font style="vertical-align: inherit;">JSON</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_jackson_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.1. </font><font style="vertical-align: inherit;">杰克逊 2</font></font></a></li>
<li><a href=" #_gson_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.2. </font><font style="vertical-align: inherit;">Gson 2</font></font></a></li>
<li><a href=" #_moshi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.3. </font><font style="vertical-align: inherit;">莫希</font></font></a></li>
<li><a href=" #_operation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.4. </font><font style="vertical-align: inherit;">手术</font></font></a></li>
<li><a href=" #_usage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.5. </font><font style="vertical-align: inherit;">用法</font></font></a></li>
</ul>
</li>
<li><a href=" #_immutables"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.4. </font><font style="vertical-align: inherit;">不可变的</font></font></a></li>
<li><a href=" #_freebuilder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.5. </font><font style="vertical-align: inherit;">自由建造者</font></font></a></li>
<li><a href=" #_jodatime"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.6. </font><font style="vertical-align: inherit;">乔达时间</font></font></a></li>
<li><a href=" #_jpa"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.7. </font><font style="vertical-align: inherit;">日本特许经营协会</font></font></a></li>
<li><a href=" #_kotlin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8. </font><font style="vertical-align: inherit;">科特林</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_resultset_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8.1. </font><font style="vertical-align: inherit;">结果集映射</font></font></a></li>
<li><a href=" #_sqlobject"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8.2. </font><font style="vertical-align: inherit;">对象</font></font></a></li>
</ul>
</li>
<li><a href=" #_lombok"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.9. </font><font style="vertical-align: inherit;">龙目岛</font></font></a></li>
<li><a href=" #_oracle_12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.10. </font><font style="vertical-align: inherit;">甲骨文 12</font></font></a></li>
<li><a href=" #_postgresql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11. </font><font style="vertical-align: inherit;">PostgreSQL</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_hstore"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.1. </font><font style="vertical-align: inherit;">商店</font></font></a></li>
<li><a href=" #_getgeneratedkeys_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.2. </font><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></li>
<li><a href=" #_large_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.3. </font><font style="vertical-align: inherit;">大型物体</font></font></a></li>
</ul>
</li>
<li><a href=" #_spring5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12. </font><font style="vertical-align: inherit;">春天5</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_installing_plugins"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12.1. </font><font style="vertical-align: inherit;">安装插件</font></font></a></li>
<li><a href=" #_global_attributes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12.2. </font><font style="vertical-align: inherit;">全局属性</font></font></a></li>
</ul>
</li>
<li><a href=" #_sqlite"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.13. </font><font style="vertical-align: inherit;">SQLite</font></font></a></li>
<li><a href=" #_stringtemplate_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.14. </font><font style="vertical-align: inherit;">字符串模板 4</font></font></a></li>
<li><a href=" #_vavr"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.15. </font><font style="vertical-align: inherit;">瓦弗尔</font></font></a></li>
</ul>
</li>
<li><a href=" #_cookbook"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. 食谱</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_simple_dependency_injection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.1. </font><font style="vertical-align: inherit;">简单的依赖注入</font></font></a></li>
<li><a href=" #_like_clauses_with_parameters"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.2. </font><font style="vertical-align: inherit;">带参数的 LIKE 子句</font></font></a></li>
</ul>
</li>
<li><a href=" #_advanced_topics"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. 进阶课题</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_high_availability"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.1. </font><font style="vertical-align: inherit;">高可用性</font></font></a></li>
<li><a href=" #_compiling_with_parameter_names"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2. </font><font style="vertical-align: inherit;">使用参数名称编译</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_maven_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.1. </font><font style="vertical-align: inherit;">Maven 设置</font></font></a></li>
<li><a href=" #_intellij_idea_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.2. </font><font style="vertical-align: inherit;">IntelliJ IDEA 设置</font></font></a></li>
<li><a href=" #_eclipse_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.3. </font><font style="vertical-align: inherit;">日食设置</font></font></a></li>
</ul>
</li>
<li><a href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3. </font><font style="vertical-align: inherit;">使用泛型类型</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_generictype"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3.1. </font><font style="vertical-align: inherit;">通用类型</font></font></a></li>
<li><a href=" #_generictypes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3.2. </font><font style="vertical-align: inherit;">泛型类型</font></font></a></li>
</ul>
</li>
<li><a href=" #_namedargumentfinder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.4. </font><font style="vertical-align: inherit;">命名参数查找器</font></font></a></li>
<li><a href=" #_jdbiconfig"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.5. </font><font style="vertical-align: inherit;">配置文件</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_creating_a_custom_jdbiconfig_type"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.5.1. </font><font style="vertical-align: inherit;">创建自定义 JdbiConfig 类型</font></font></a></li>
</ul>
</li>
<li><a href=" #_jdbiplugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.6. </font><font style="vertical-align: inherit;">插件</font></font></a></li>
<li><a href=" #_statementcontext"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.7. </font><font style="vertical-align: inherit;">语句上下文</font></font></a></li>
<li><a href=" #_user_defined_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8. </font><font style="vertical-align: inherit;">用户定义的注释</font></font></a>
<ul class="sectlevel3">
<li><a href=" #_statement_customizing_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8.1. </font><font style="vertical-align: inherit;">语句自定义注解</font></font></a></li>
<li><a href=" #_configuration_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8.2. </font><font style="vertical-align: inherit;">配置注解</font></font></a></li>
<li><a href=" #_method_decorating_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8.3. </font><font style="vertical-align: inherit;">方法装饰注解</font></font></a></li>
</ul>
</li>
<li><a href=" #_templateengine"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.9. </font><font style="vertical-align: inherit;">模板引擎</font></font></a></li>
<li><a href=" #_sqlparser"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.10. </font><font style="vertical-align: inherit;">解析器</font></font></a></li>
<li><a href=" #_sqllogger"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.11. </font><font style="vertical-align: inherit;">日志记录器</font></font></a></li>
<li><a href=" #_resultproducer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.12. </font><font style="vertical-align: inherit;">结果生产者</font></font></a></li>
<li><a href=" #_generator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.13. </font><font style="vertical-align: inherit;">发电机</font></font></a></li>
</ul>
</li>
<li><a href=" #_appendix"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. 附录</font></font></a>
<ul class="sectlevel2">
<li><a href=" #_best_practices"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1. </font><font style="vertical-align: inherit;">最佳实践</font></font></a></li>
<li><a href=" #_api_reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.2. </font><font style="vertical-align: inherit;">API 参考</font></font></a></li>
<li><a href=" #_related_projects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.3. </font><font style="vertical-align: inherit;">相关项目</font></font></a></li>
<li><a href=" #_contributing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.4. </font><font style="vertical-align: inherit;">贡献</font></font></a></li>
<li><a href=" #_upgrading_from_v2_to_v3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.5. </font><font style="vertical-align: inherit;">从 v2 升级到 v3</font></font></a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./Jdbi 3 开发者指南_files/logo.svg" alt="Jdbi 标志">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_jdbi"><a class="anchor" href=" #_introduction_to_jdbi"></a><a class="link" href=" #_introduction_to_jdbi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一、Jdbi介绍</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了对 Java 中关系数据的方便、惯用的访问。</font><font style="vertical-align: inherit;">Jdbi 3 是第三个主要版本，它引入了对 Java 8 的增强支持、对设计和实现的无数改进以及对模块化插件的增强支持。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还不升级？</font><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/jdbi2/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v2的文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍然是可用的。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 建立在 JDBC 之上。</font><font style="vertical-align: inherit;">如果您的数据库有 JDBC 驱动程序，您可以将 Jdbi 与它一起使用。</font><font style="vertical-align: inherit;">Jdbi 改进了 JDBC 的粗糙接口，提供了更自然的 Java 数据库接口，易于绑定到您的域数据类型。</font><font style="vertical-align: inherit;">与 ORM 不同，我们的目标不是提供完整的对象关系映射框架 - 而不是隐藏的复杂性，我们提供构建块，允许您根据应用程序构建关系和对象之间的映射。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 的 API 有两种风格：</font></font></p>
</div>
<div class="sect2">
<h3 id="_fluent_api"><a class="anchor" href=" #_fluent_api"></a><a class="link" href=" #_fluent_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">流利的API</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Core API 提供了一个流畅的命令式接口。</font><font style="vertical-align: inherit;">使用 Builder 样式对象将 SQL 连接到丰富的 Java 数据类型。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:h2:mem:test</span><span class="delimiter">"</span></span>); <span class="comment">// (H2 in-memory database)</span><font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = jdbi.withHandle(handle -&gt; {<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE user (id INTEGER PRIMARY KEY, name VARCHAR)</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
    <span class="comment">// Inline positional parameters</span>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (?, ?)</span><span class="delimiter">"</span></span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
    <span class="comment">// Positional parameters</span>
    handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (?, ?)</span><span class="delimiter">"</span></span>)<font></font>
            .bind(<span class="integer">0</span>, <span class="integer">1</span>) <span class="comment">// 0-based parameter indexes</span>
            .bind(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>)<font></font>
            .execute();<font></font>
<font></font>
    <span class="comment">// Named parameters</span>
    handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
            .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">2</span>)<font></font>
            .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Clarice</span><span class="delimiter">"</span></span>)<font></font>
            .execute();<font></font>
<font></font>
    <span class="comment">// Named parameters from bean properties</span>
    handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
            .bindBean(<span class="keyword">new</span> User(<span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">David</span><span class="delimiter">"</span></span>))<font></font>
            .execute();<font></font>
<font></font>
    <span class="comment">// Easy mapping to any type</span>
    <span class="keyword">return</span> handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user ORDER BY name</span><span class="delimiter">"</span></span>)<font></font>
            .mapToBean(User.class)<font></font>
            .list();<font></font>
});<font></font>
<font></font>
assertThat(users).containsExactly(<font></font>
        <span class="keyword">new</span> User(<span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">Clarice</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">David</span><span class="delimiter">"</span></span>));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_declarative_api"><a class="anchor" href=" #_declarative_api"></a><a class="link" href=" #_declarative_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">声明式 API</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象扩展位于 Core 之上，并提供声明式接口。</font><font style="vertical-align: inherit;">通过声明一个带注释的 Java 告诉 Jdbi 要执行什么 SQL 和你喜欢的结果的形状</font></font><code>interface</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它会提供实现。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Define your own declarative interface</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE user (id INTEGER PRIMARY KEY, name VARCHAR)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> createTable();<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (?, ?)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> insertPositional(<span class="type">int</span> id, <span class="predefined-type">String</span> name);<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (:id, :name)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> insertNamed(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="type">int</span> id, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> name);<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES (:id, :name)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> insertBean(<span class="annotation">@BindBean</span> User user);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user ORDER BY name</span><span class="delimiter">"</span></span>)
    <span class="annotation">@RegisterBeanMapper</span>(User.class)
    <span class="predefined-type">List</span>&lt;User&gt; listUsers();<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:h2:mem:test</span><span class="delimiter">"</span></span>);<font></font>
jdbi.installPlugin(<span class="keyword">new</span> SqlObjectPlugin());<font></font>
<font></font>
<span class="comment">// Jdbi implements your interface based on annotations</span>
<span class="predefined-type">List</span>&lt;User&gt; userNames = jdbi.withExtension(UserDao.class, dao -&gt; {<font></font>
    dao.createTable();<font></font>
<font></font>
    dao.insertPositional(<span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>);<font></font>
    dao.insertPositional(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>);<font></font>
    dao.insertNamed(<span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">Clarice</span><span class="delimiter">"</span></span>);<font></font>
    dao.insertBean(<span class="keyword">new</span> User(<span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">David</span><span class="delimiter">"</span></span>));<font></font>
<font></font>
    <span class="keyword">return</span> dao.listUsers();<font></font>
});<font></font>
<font></font>
assertThat(userNames).containsExactly(<font></font>
        <span class="keyword">new</span> User(<span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">Clarice</span><span class="delimiter">"</span></span>),
        <span class="keyword">new</span> User(<span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">David</span><span class="delimiter">"</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 具有灵活的插件架构，可以轻松折叠以支持您喜欢的库（Guava、JodaTime、Spring、Vavr）或数据库供应商（H2、Oracle、Postgres）。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 不是 ORM。</font><font style="vertical-align: inherit;">没有会话缓存、更改跟踪、“在视图中打开会话”或哄骗库来理解您的架构。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相反，Jdbi 提供了 SQL 和简单表格数据结构之间的直接映射。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你带上你自己的 SQL，Jdbi 只运行你告诉它的命令——这是上帝想要的方式。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
已经在使用 Jdbi v2？</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_upgrading_from_v2_to_v3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从 v2 升级到 v3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href=" #_getting_started"></a><a class="link" href=" #_getting_started"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. 入门</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 很容易包含在您的 Java 项目中 - 使用
</font></font><a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache 2.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许可证、很少的外部依赖项和通过</font></font><a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.jdbi%22%20AND%20v%3A%223.21.1-SNAPSHOT%22" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maven Central</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分发的 JAR
 </font><font style="vertical-align: inherit;">，您只需在 POM 中包含相关工件：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>jdbi3-bom<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
      <span class="tag">&lt;version&gt;</span>3.21.1-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
      <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，在您的</font></font><code>&lt;dependencies&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中，为您要使用的每个 Jdbi 模块声明一个依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>jdbi3-core<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了几个其他模块，它们通过附加功能增强了核心 API。</font></font></p>
</div>
<div class="sect2">
<h3 id="_java_compatibility"><a class="anchor" href=" #_java_compatibility"></a><a class="link" href=" #_java_compatibility"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1. </font><font style="vertical-align: inherit;">Java 兼容性</font></font></a></h3>
<div class="paragraph">
<p><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在所有 Java 版本 8 或更高版本上运行。</font><font style="vertical-align: inherit;">构建需要 11 或更高版本。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Java 8 支持被视为已弃用，目前将尽最大努力维护，但很快就会消失！</font><font style="vertical-align: inherit;">为了在 8 上运行，您可能需要将您的</font></font><code>caffeine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本</font><font style="vertical-align: inherit;">依赖管理
</font><font style="vertical-align: inherit;">回 2.x。</font><font style="vertical-align: inherit;">3.x 需要在较新的 JDK 上运行，但不会在 8.x 上运行。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_modules"><a class="anchor" href=" #_modules"></a><a class="link" href=" #_modules"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2. </font><font style="vertical-align: inherit;">模块</font></font></a></h3>
<div class="dlist glossary">
<dl>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-sqlobject</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象扩展。</font><font style="vertical-align: inherit;">大多数 Jdbi 用户使用它。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-番石榴</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 Guava 的 collection 和 Optional 类型。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-jodatime2</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 JodaTime v2 的 DateTime 类型。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-jpa</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对 JPA 注释的支持最少。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动映射 kotlin 数据类。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin-sqlobject</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">增强 SQL Object 扩展以支持 Kotlin 默认方法和方法默认参数。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-oracle12</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 Oracle 返回 DML 语句。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-postgres</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 Postgres 驱动程序支持的大多数数据类型。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-spring5</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供一个工厂 bean 来设置 Jdbi 单例。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-stringtemplate4</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 StringTemplate4 模板引擎，而不是 JDBI 的内置引擎。</font></font></p>
</dd>
<dt><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-vavr</font></font></dt>
<dd>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 Vavr 元组、集合和值参数</font></font></p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_forethoughts"><a class="anchor" href=" #_forethoughts"></a><a class="link" href=" #_forethoughts"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3. </font><font style="vertical-align: inherit;">远见</font></font></a></h3>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你可能会想增加我们的注解</font></font><code>org.jdbi.v3.meta.Beta</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>org.jdbi.v3.meta.Alpha</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对IDE的“不稳定API使用”黑名单。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的</font></font><code>org.jdbi.*.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包不被视为公共 API；</font><font style="vertical-align: inherit;">它们的内容可能会在没有警告的情况下发生根本性的变化。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_api"><a class="anchor" href=" #_core_api"></a><a class="link" href=" #_core_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. 核心API</font></font></a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_jdbi"><a class="anchor" href=" #_jdbi"></a><a class="link" href=" #_jdbi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1. </font><font style="vertical-align: inherit;">杰比</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Jdbi.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类是主入口点到库中。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例都包装一个 JDBC
 </font></font><a href="https://docs.oracle.com/javase/8/docs/api/javax/sql/DataSource.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataSource</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它也是数据库会话的配置存储库。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有几种方法可以创建</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例。</font><font style="vertical-align: inherit;">您可以使用 JDBC URL：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// H2 in-memory database</span>
Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:h2:mem:test</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你有一个</font></font><code>DataSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，你可以直接使用它：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">DataSource</span> ds = ...<font></font>
Jdbi jdbi = Jdbi.create(ds);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 实例是线程安全的，不拥有任何数据库资源。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，应用程序会创建单个共享</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例，并在其中设置任何通用配置。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身不提供连接池或其他</font></font><a href=" #_high_availability"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高可用性</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能，但可以与其他提供此功能的软件结合使用。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在更有限的范围内（例如 HTTP 请求或事件回调），您</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将从您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中</font><font style="vertical-align: inherit;">请求一个</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_handle"><a class="anchor" href=" #_handle"></a><a class="link" href=" #_handle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2. </font><font style="vertical-align: inherit;">处理</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">句柄代表一个活动的
</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库连接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Handle.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">句柄</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于针对数据库准备和运行 SQL 语句，以及管理数据库事务。</font><font style="vertical-align: inherit;">它提供对流畅语句 API 的访问，这些 API 可以绑定参数、执行语句，然后将任何结果映射到 Java 对象中。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建时</font><font style="vertical-align: inherit;">继承配置</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因为</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持有一个开放的连接，必须注意确保每个句柄在您完成后都关闭。</font><font style="vertical-align: inherit;">未能关闭 Handles 最终将使您的数据库因打开的连接而不堪重负，或者耗尽您的连接池。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有几种方法可以</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在运行时</font><font style="vertical-align: inherit;">获取</font><font style="vertical-align: inherit;">实例。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您的操作会返回一些结果，请使用
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Jdbi.html#withHandle-org.jdbi.v3.core.HandleCallback-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi.withHandle()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names = jdbi.withHandle(handle -&gt;<font></font>
    handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from contacts</span><span class="delimiter">"</span></span>)<font></font>
          .mapTo(<span class="predefined-type">String</span>.class)<font></font>
          .list());<font></font>
assertThat(names).contains(<span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您的操作不需要返回结果，请使用</font></font><code>Jdbi.useHandle(HandleConsumer)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.useHandle(handle -&gt; {<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">create table contacts (id int primary key, name varchar(100))</span><span class="delimiter">"</span></span>);<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (?, ?)</span><span class="delimiter">"</span></span>, <span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>);<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (?, ?)</span><span class="delimiter">"</span></span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>);<font></font>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">双方</font></font><code>withHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>useHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开一个临时处理，调用你的回调，并立即释放在手柄回调的回报。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可能会注意到 Jdbi 中一些地方的“消费者”与“回调”命名模式。</font><font style="vertical-align: inherit;">回调返回一个值，并与</font></font><code>with-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">耦合</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">消费者不返回值，并且与</font></font><code>use-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">耦合</font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，如果您想自己管理句柄的生命周期，请使用</font></font><code>jdbi.open()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (Handle handle = jdbi.open()) {<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (?, ?)</span><span class="delimiter">"</span></span>, <span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">Chuck</span><span class="delimiter">"</span></span>);<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用 时</font></font><code>jdbi.open()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，应始终使用 try-with-resources 或 try-finally 块以确保释放数据库连接。</font><font style="vertical-align: inherit;">未能释放句柄将泄漏连接。</font><font style="vertical-align: inherit;">我们建议</font><font style="vertical-align: inherit;">尽可能</font><font style="vertical-align: inherit;">使用</font></font><code>withHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或</font></font><code>useHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">over </font></font><code>open</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_arguments"><a class="anchor" href=" #_arguments"></a><a class="link" href=" #_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3. </font><font style="vertical-align: inherit;">参数</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是 Jdbi 对 JDBC 语句参数（</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>select * from Foo where bar = ?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的表示。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 JDBC 上</font><font style="vertical-align: inherit;">设置参数</font></font><code>PreparedStatement</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您需要</font></font><code>ps.setString(1, "Baz")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">随着Jdbi，当您绑定的字符串</font></font><code>"Baz"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它会通过所有已注册的搜索</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentFactory</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情况下，直到它找到一个愿意字符串转换成</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">争论</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该参数负责完全按照原样设置占位符的字符串</font></font><code>setString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数可以执行比简单 JDBC 支持的更高级的绑定：BigDecimal 可以绑定为 SQL 十进制，java.time.Year 可以绑定为 SQL int，或者复杂对象可以序列化为字节数组并绑定为 SQL blob。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jdbi 参数的使用仅限于 JDBC 准备好的语句参数。</font><font style="vertical-align: inherit;">值得注意的是，参数通常不能用于更改查询的结构（例如表名或列名，</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>INSERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等），也不能将它们插入到字符串文字中。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_templating"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href=" #_templateengine"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板</font></font></a><font style="vertical-align: inherit;"><a href=" #_templating"><font style="vertical-align: inherit;">引擎</font></a><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_positional_arguments"><a class="anchor" href=" #_positional_arguments"></a><a class="link" href=" #_positional_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.1. </font><font style="vertical-align: inherit;">位置参数</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当 SQL 语句使用</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">令牌时，Jdbi 可以将值绑定到相应索引处的参数（从 0 开始）：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (?, ?)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="integer">0</span>, <span class="integer">3</span>)<font></font>
      .bind(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Chuck</span><span class="delimiter">"</span></span>)<font></font>
      .execute();<font></font>
<font></font>
<span class="predefined-type">String</span> name = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from contacts where id = ?</span><span class="delimiter">"</span></span>)<font></font>
                    .bind(<span class="integer">0</span>, <span class="integer">3</span>)<font></font>
                    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
                    .one();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_named_arguments"><a class="anchor" href=" #_named_arguments"></a><a class="link" href=" #_named_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.2. </font><font style="vertical-align: inherit;">命名参数</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当 SQL 语句使用冒号前缀标记时</font></font><code>:name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Jdbi 可以按名称绑定参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">3</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Chuck</span><span class="delimiter">"</span></span>)<font></font>
      .execute();<font></font>
<font></font>
<span class="predefined-type">String</span> name = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from contacts where id = :id</span><span class="delimiter">"</span></span>)<font></font>
                    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">3</span>)<font></font>
                    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
                    .one();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此</font></font><code>:foo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法是可以更改的默认行为；</font><font style="vertical-align: inherit;">看</font></font><code>ColonPrefixSqlParser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课。</font><font style="vertical-align: inherit;">Jdbi 或者提供对</font></font><code>#foo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即</font><font style="vertical-align: inherit;">用</font><font style="vertical-align: inherit;">语法的</font><font style="vertical-align: inherit;">支持</font><font style="vertical-align: inherit;">，您也可以创建自己的语法。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不允许混合命名和位置参数，因为它会很快变得混乱。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_supported_argument_types"><a class="anchor" href=" #_supported_argument_types"></a><a class="link" href=" #_supported_argument_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.3. </font><font style="vertical-align: inherit;">支持的参数类型</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即用，Jdbi 支持以下类型作为 SQL 语句参数：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原语：</font></font><code>boolean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>byte</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>short</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和
</font></font><code>double</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.lang: </font></font><code>Boolean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Byte</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Short</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Character</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
 </font></font><code>Float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Double</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><code>Enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（默认存储为枚举值的名称）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.math： </font></font><code>BigDecimal</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.net: </font></font><code>Inet4Address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Inet6Address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>URI</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.sql: </font></font><code>Blob</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Clob</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>Timestamp</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.time: </font></font><code>Instant</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
 </font></font><code>OffsetDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ZonedDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>ZoneId</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.util: </font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（围绕任何其他支持的类型），和</font></font><code>UUID</code></p>
</li>
<li>
<p><code>java.util.Collection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和 Java 数组（存储为 SQL 数组）。</font><font style="vertical-align: inherit;">根据数组元素的类型，可能需要一些额外的设置。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以配置 Jdbi 以支持其他参数类型。</font><font style="vertical-align: inherit;">稍后再谈。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_binding_arguments"><a class="anchor" href=" #_binding_arguments"></a><a class="link" href=" #_binding_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.4. </font><font style="vertical-align: inherit;">绑定参数</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过几种不同的方式绑定 SQL 语句的参数。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以绑定单个参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从 a 的条目一次绑定多个参数</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; contact = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();<font></font>
contact.put(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">2</span>)<font></font>
contact.put(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bindMap(contact)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从 a</font></font><code>List&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或 vararg</font><font style="vertical-align: inherit;">一次绑定多个值</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; keys = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;()<font></font>
keys.add(<span class="string"><span class="delimiter">"</span><span class="content">user_name</span><span class="delimiter">"</span></span>);<font></font>
keys.add(<span class="string"><span class="delimiter">"</span><span class="content">street</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT value FROM items WHERE kind in (&lt;listOfKinds&gt;)</span><span class="delimiter">"</span></span>)<font></font>
      .bindList(<span class="string"><span class="delimiter">"</span><span class="content">listOfKinds</span><span class="delimiter">"</span></span>, keys)<font></font>
      .mapTo(<span class="predefined-type">String</span>.class)<font></font>
      .list();<font></font>
<font></font>
<span class="comment">// Or, using the 'vararg' definition</span>
handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT value FROM items WHERE kind in (&lt;varargListOfKinds&gt;)</span><span class="delimiter">"</span></span>)<font></font>
      .bindList(<span class="string"><span class="delimiter">"</span><span class="content">varargListOfKinds</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">user_name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">docs</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">street</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">library</span><span class="delimiter">"</span></span>)<font></font>
      .mapTo(<span class="predefined-type">String</span>.class)<font></font>
      .list();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"></font><code>bindList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管您的值已绑定，但</font><font style="vertical-align: inherit;">
使用</font><font style="vertical-align: inherit;">需要</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">属性而不是绑定来编写 SQL。</font><font style="vertical-align: inherit;">该属性是一个占位符，它将安全地呈现为以逗号分隔的绑定占位符列表。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从 Java Bean 的属性绑定多个参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Contact contact = <span class="keyword">new</span> Contact();<font></font>
contact.setId(<span class="integer">3</span>);<font></font>
contact.setName(<span class="string"><span class="delimiter">"</span><span class="content">Cindy</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bindBean(contact)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以绑定对象的公共字段：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Object</span> contact = <span class="keyword">new</span> <span class="predefined-type">Object</span>() {
    <span class="directive">public</span> <span class="type">int</span> id = <span class="integer">0</span>;
    <span class="directive">public</span> <span class="predefined-type">String</span> name = <span class="string"><span class="delimiter">"</span><span class="content">Cindy</span><span class="delimiter">"</span></span>;<font></font>
};<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bindFields(contact)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者您可以绑定对象的公共无参数方法：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Object</span> contact = <span class="keyword">new</span> <span class="predefined-type">Object</span>() {
    <span class="directive">public</span> <span class="type">int</span> theId() {
        <span class="keyword">return</span> <span class="integer">0</span>;<font></font>
    }<font></font>
<font></font>
    <span class="directive">public</span> <span class="predefined-type">String</span> theName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">Cindy</span><span class="delimiter">"</span></span>;<font></font>
    }<font></font>
};<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:theId, :theName)</span><span class="delimiter">"</span></span>)<font></font>
      .bindMethods(contact)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，您可以使用前缀限定每个绑定的 bean/对象。</font><font style="vertical-align: inherit;">在两个或多个绑定 bean 具有相似属性名称的情况下，这有助于消除歧义：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Folder folder = <span class="keyword">new</span> Folder(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Important Documents</span><span class="delimiter">"</span></span>);
<span class="predefined-type">Document</span> document =
    <span class="keyword">new</span> <span class="predefined-type">Document</span>(<span class="integer">100</span>, <span class="string"><span class="delimiter">"</span><span class="content">memo.txt</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Business business business. Numbers.</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into documents (id, folder_id, name, contents) </span><span class="delimiter">"</span></span> +
                    <span class="string"><span class="delimiter">"</span><span class="content">values (:d.id, :f.id, :d.name, :d.contents)</span><span class="delimiter">"</span></span>)<font></font>
      .bindBean(<span class="string"><span class="delimiter">"</span><span class="content">f</span><span class="delimiter">"</span></span>, folder)<font></font>
      .bindMethods(<span class="string"><span class="delimiter">"</span><span class="content">f</span><span class="delimiter">"</span></span>, folder)<font></font>
      .bindFields(<span class="string"><span class="delimiter">"</span><span class="content">d</span><span class="delimiter">"</span></span>, document)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content">
<code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>bindFields()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 并且</font></font><code>bindMethods()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于绑定嵌套属性，例如</font></font><code>:user.address.street</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<code>bindMap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不绑定嵌套属性——映射键应该与绑定的参数名称完全匹配。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作者建议查看</font></font><a href=" #_immutables"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Immutables</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持，以获得一种轻松绑定和映射值类型的高级方法。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_custom_arguments"><a class="anchor" href=" #_custom_arguments"></a><a class="link" href=" #_custom_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.5. </font><font style="vertical-align: inherit;">自定义参数</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时，您的数据模型将使用 Jdbi 本身不支持的数据类型（请参阅</font></font><a href=" #_supported_argument_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持的参数类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幸运的是，通过实现一些简单的接口，Jdbi 可以配置为将自定义数据类型绑定为参数。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
核心 JDBC 功能通常得到所有数据库供应商的良好支持。</font><font style="vertical-align: inherit;">但是，数组支持或几何类型等更高级的用法往往很快就会成为特定于供应商的。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="_argument"><a class="anchor" href=" #_argument"></a><a class="link" href=" #_argument"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">争论</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/argument/Argument.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口包装的单个值成绑定。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">static</span> <span class="type">class</span> <span class="class">UUIDArgument</span> <span class="directive">implements</span> Argument {
    <span class="directive">private</span> <span class="predefined-type">UUID</span> uuid;<font></font>
<font></font>
    UUIDArgument(<span class="predefined-type">UUID</span> uuid) {
        <span class="local-variable">this</span>.uuid = uuid;<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> apply(<span class="type">int</span> position, <span class="predefined-type">PreparedStatement</span> statement, StatementContext ctx)
    <span class="directive">throws</span> <span class="exception">SQLException</span> {<font></font>
        statement.setString(position, uuid.toString()); <i class="conum" data-value="1"></i><b>(1)</b><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> uuidArgument() {
    <span class="predefined-type">UUID</span> u = <span class="predefined-type">UUID</span>.randomUUID();<font></font>
    assertThat(handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT CAST(:uuid AS VARCHAR)</span><span class="delimiter">"</span></span>)<font></font>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">uuid</span><span class="delimiter">"</span></span>, <span class="keyword">new</span> UUIDArgument(u))<font></font>
        .mapTo(<span class="predefined-type">String</span>.class)<font></font>
        .one()).isEqualTo(u.toString());<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于 Argument 通常直接调用 JDBC，因此在应用时会给出从
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 开始的索引</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（正如 JDBC 所期望的）。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里我们使用一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Argument</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来直接绑定一个 UUID。</font><font style="vertical-align: inherit;">在这种特殊情况下，最明显的方法是将 UUID 作为字符串发送到数据库。</font><font style="vertical-align: inherit;">如果您的 JDBC 驱动程序直接支持自定义类型或高效的二进制传输，您可以在此处轻松利用它们。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_argumentfactory"><a class="anchor" href=" #_argumentfactory"></a><a class="link" href=" #_argumentfactory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数工厂</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/argument/ArgumentFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接口提供</font></font><a href=" #_argument"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情况下，它知道任何数据类型。</font><font style="vertical-align: inherit;">通过实现和注册参数工厂，可以绑定自定义数据类型，而无需将它们显式包装在</font></font><code>Argument</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象中。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了一个</font></font><code>AbstractArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简化</font></font><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合约</font><font style="vertical-align: inherit;">实现的类</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">static</span> <span class="type">class</span> <span class="class">UUIDArgumentFactory</span> <span class="directive">extends</span> AbstractArgumentFactory&lt;<span class="predefined-type">UUID</span>&gt; {<font></font>
    UUIDArgumentFactory() {<font></font>
        <span class="local-variable">super</span>(<span class="predefined-type">Types</span>.VARCHAR); <i class="conum" data-value="1"></i><b>(1)</b><font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">protected</span> Argument build(<span class="predefined-type">UUID</span> value, ConfigRegistry config) {
        <span class="keyword">return</span> (position, statement, ctx) -&gt; statement.setString(position, value.toString()); <i class="conum" data-value="2"></i><b>(2)</b><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> uuidArgumentFactory() {
    <span class="predefined-type">UUID</span> u = <span class="predefined-type">UUID</span>.randomUUID();<font></font>
    handle.registerArgument(<span class="keyword">new</span> UUIDArgumentFactory());<font></font>
    assertThat(handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT CAST(:uuid AS VARCHAR)</span><span class="delimiter">"</span></span>)<font></font>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">uuid</span><span class="delimiter">"</span></span>, u)<font></font>
        .mapTo(<span class="predefined-type">String</span>.class)<font></font>
        .one()).isEqualTo(u.toString());<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定 UUID 时要使用</font><font style="vertical-align: inherit;">的 JDBC </font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Types.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 类型常量</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Jdbi 需要这个来绑定</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">见
</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html#setNull-int-int-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreparedStatement.setNull(int,int)</font></font></a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于</font></font><code>Argument</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个函数式接口，它可以实现为一个简单的 lambda 表达式。</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_prepared_arguments"><a class="anchor" href=" #_prepared_arguments"></a><a class="link" href=" #_prepared_arguments"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好的参数</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传统的参数工厂根据绑定的类型和实际值来决定绑定。</font><font style="vertical-align: inherit;">这是非常灵活的，但是当绑定一个大的时候，</font></font><code>PreparedBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它会导致严重的性能损失，因为必须为每批添加的参数咨询整个参数工厂链。</font><font style="vertical-align: inherit;">为了解决这个问题，实现</font></font><code>ArgumentFactory.Preparable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which 承诺处理给定的所有值</font></font><code>Type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">大多数内置参数工厂现在都实现了 Preparable 接口。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_arguments_registry"><a class="anchor" href=" #_arguments_registry"></a><a class="link" href=" #_arguments_registry"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数注册表</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您注册一个 时</font></font><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，注册将存储在</font><font style="vertical-align: inherit;">Jdbi 持有</font><font style="vertical-align: inherit;">的
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/argument/Arguments.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arguments</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中。
</font></font><code>Arguments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个配置类，它存储所有注册的参数工厂（包括内置参数的工厂）。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在幕后，当您将参数绑定到语句时，Jdbi 会咨询
</font></font><code>Arguments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置对象并搜索</font></font><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">知道如何将绑定对象转换为</font></font><code>Argument</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">稍后，当执行该语句时，将</font></font><code>Argument</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在绑定期间定位的</font><font style="vertical-align: inherit;">每个语句</font><font style="vertical-align: inherit;">应用于 JDBC
 </font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreparedStatement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有时，两个或多个参数工厂将支持相同数据类型的参数。</font><font style="vertical-align: inherit;">当这种情况发生时，最后注册的工厂获胜。</font><font style="vertical-align: inherit;">可准备参数工厂总是优先于基本参数工厂。</font><font style="vertical-align: inherit;">这意味着您可以覆盖任何数据类型的绑定方式，包括开箱即用支持的数据类型。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_queries"><a class="anchor" href=" #_queries"></a><a class="link" href=" #_queries"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.4. </font><font style="vertical-align: inherit;">查询</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/Query.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果，轴承</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是从数据库返回的结果集的SQL语句。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt;&gt; users =<font></font>
    handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
        .mapToMap()<font></font>
        .list();<font></font>
<font></font>
assertThat(users).containsExactly(<font></font>
        map(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>),<font></font>
        map(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要从查询中获取单行，可以使用几种可能的方法，具体取决于结果集中可能存在的行数。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>one()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您希望结果恰好包含一行时</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回
</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只有在返回的行映射到</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果结果有零行或多行，则抛出异常。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> name = handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select name from users where id = ?</span><span class="delimiter">"</span></span>, <span class="integer">3</span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>findOne()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您希望结果包含零或一行时</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回
</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有行，或映射到一排</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果结果有多行，则抛出异常。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Optional&lt;<span class="predefined-type">String</span>&gt; name = handle.select(...)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .findOne();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>first()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您希望结果至少包含一行时</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">。</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果第一行映射到 ，则</font><font style="vertical-align: inherit;">返回
</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果结果有零行，则抛出异常。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> name = handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select name from users where id = ?</span><span class="delimiter">"</span></span>, <span class="integer">3</span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .first();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>findFirst()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当结果可能包含任意数量的行时</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回
</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有行或第一列映射到</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Optional&lt;<span class="predefined-type">String</span>&gt; name = handle.select(...)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .findFirst();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在列表中返回多个结果行：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; name = handle.createQuery(
        <span class="string"><span class="delimiter">"</span><span class="content">select title from films where genre = :genre order by title</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">genre</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Action</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于其他集合，请</font></font><code>collect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收集器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一起使用
</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; name = handle.createQuery(
        <span class="string"><span class="delimiter">"</span><span class="content">select title from films where genre = :genre order by title</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">genre</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Action</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .collect(Collectors.toSet());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以流式传输结果：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(
        <span class="string"><span class="delimiter">"</span><span class="content">select title from films where genre = :genre order by title</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .useStream(stream -&gt; {<font></font>
      <span class="comment">// do stuff with stream</span>
    });</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到目前为止，所有示例都显示了</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果类型。</font><font style="vertical-align: inherit;">当然，您可以映射到许多其他数据类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LocalDate releaseDate = handle.createQuery(
        <span class="string"><span class="delimiter">"</span><span class="content">select release_date from films where name = :name</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Star Wars: A New Hope</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(LocalDate.class)<font></font>
    .one();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mappers"><a class="anchor" href=" #_mappers"></a><a class="link" href=" #_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5. </font><font style="vertical-align: inherit;">映射器</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 使用映射器将结果数据转换为 Java 对象。</font><font style="vertical-align: inherit;">有两种类型的映射器：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href=" #_row_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Row Mappers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，映射一整行结果集数据。</font></font></p>
</li>
<li>
<p><a href=" #_column_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器，映射结果集行的单列。</font></font></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_row_mappers"><a class="anchor" href=" #_row_mappers"></a><a class="link" href=" #_row_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.1. </font><font style="vertical-align: inherit;">行映射器</font></font></a></h4>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/RowMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个函数式接口，它将 JDBC </font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的当前行
</font><font style="vertical-align: inherit;">映射到映射类型。</font><font style="vertical-align: inherit;">为结果集中的每一行调用一次行映射器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于</font></font><code>RowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是函数式接口，因此可以使用 lambda 表达式将它们内联提供给查询：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;User&gt; users = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
        .map((rs, ctx) -&gt; <span class="keyword">new</span> User(rs.getInt(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>), rs.getString(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>)))<font></font>
        .list();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在上面的例子中使用了三种不同的类型。</font></font><code>Query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，由 返回</font></font><code>Handle.createQuery()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，实现</font></font><code>ResultBearing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口。</font><font style="vertical-align: inherit;">该</font></font><code>ResultBearing.map()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法采用 a</font></font><code>RowMapper&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回 a
 </font></font><code>ResultIterable&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最后，</font></font><code>ResultBearing.list()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将结果集中的每一行收集到一个</font></font><code>List&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行映射器可以定义为类，允许重用：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">UserMapper</span> <span class="directive">implements</span> <span class="predefined-type">RowMapper</span>&lt;User&gt; {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> User map(<span class="predefined-type">ResultSet</span> rs, StatementContext ctx) <span class="directive">throws</span> <span class="exception">SQLException</span> {
        <span class="keyword">return</span> <span class="keyword">new</span> User(rs.getInt(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>), rs.getString(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>));<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;User&gt; users = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
    .map(<span class="keyword">new</span> UserMapper())<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这</font></font><code>RowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于上面的 lambda 映射器，但更明确。</font></font></p>
</div>
<div class="sect4">
<h5 id="_rowmappers_registry"><a class="anchor" href=" #_rowmappers_registry"></a><a class="link" href=" #_rowmappers_registry"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowMappers 注册表</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以为特定类型注册行映射器。</font><font style="vertical-align: inherit;">这简化了使用，只需要您指定要映射到的类型。</font><font style="vertical-align: inherit;">Jdbi 会自动从注册表中查找映射器并使用它。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.registerRowMapper(User.class,<font></font>
    (rs, ctx) -&gt; <span class="keyword">new</span> User(rs.getInt(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>), rs.getString(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>));<font></font>
<font></font>
<span class="keyword">try</span> (Handle handle = jdbi.open()) {
  <span class="predefined-type">List</span>&lt;User&gt; users = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(User.class)<font></font>
        .list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它实现了一个映射器</font></font><code>RowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有显式映射类型（如
</font></font><code>UserMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前一节中的类）可以不指定映射类型被注册：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(<span class="keyword">new</span> UserMapper());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用此方法时，Jdbi 检查映射器的泛型类签名以自动发现映射类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以为任何给定类型注册多个映射器。</font><font style="vertical-align: inherit;">发生这种情况时，给定类型的最后注册的映射器优先。</font><font style="vertical-align: inherit;">这允许优化，比如为某种类型注册一个“默认”映射器，同时允许在适当的时候用不同的映射器覆盖默认映射器。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_rowmapperfactory"><a class="anchor" href=" #_rowmapperfactory"></a><a class="link" href=" #_rowmapperfactory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行映射器工厂</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/RowMapperFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowMapperFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以产生任意类型的列映射器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在以下情况下，实现工厂可能比常规行映射器更可取：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器实现是通用的，可以应用于多个映射类型。</font><font style="vertical-align: inherit;">例如，Jdbi 提供了一个通用的</font></font><a href=" #_beanmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它将列映射到任何 bean 类的 bean 属性。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射类型具有通用签名，和/或映射器可以由其他注册的映射器组成。</font><font style="vertical-align: inherit;">例如，Jdbi 提供了
</font></font><a href=" #_map_entry_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map.Entry&lt;K,V&gt; 映射器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，前提是映射器已为类型</font></font><code>K</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">注册</font></font><code>V</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您想将多个映射器捆绑到一个类中。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们举一个示例</font></font><code>Pair&lt;L, R&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">Pair</span>&lt;L, R&gt; {
  <span class="directive">public</span> <span class="directive">final</span> L left;
  <span class="directive">public</span> <span class="directive">final</span> R right;<font></font>
<font></font>
  <span class="directive">public</span> Pair(L left, R right) {
    <span class="local-variable">this</span>.left = left;
    <span class="local-variable">this</span>.right = right;<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，让我们实现一个行映射器工厂。</font><font style="vertical-align: inherit;">工厂应该</font></font><code>RowMapper&lt;Pair&lt;L, R&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为任何</font></font><code>Pair&lt;L, R&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font><font style="vertical-align: inherit;">生成 a
 </font><font style="vertical-align: inherit;">，其中</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型从第一列映射到第二列 -</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设有为</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">注册的列映射器</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们一步一步来：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PairMapperFactory</span> <span class="directive">implements</span> RowMapperFactory {
  <span class="directive">public</span> Optional&lt;<span class="predefined-type">RowMapper</span>&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法接受映射类型和配置注册表。</font></font><code>Optional.of(someMapper)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它知道如何映射该类型，则</font><font style="vertical-align: inherit;">它可能会返回</font><font style="vertical-align: inherit;">，
</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">否则</font><font style="vertical-align: inherit;">可能会返回
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先我们检查映射类型是否为 a </font></font><code>Pair</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (!Pair.class.equals(GenericTypes.getErasedType(type))) {
  <span class="keyword">return</span> Optional.empty();<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>GenericTypes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用程序类中讨论</font></font><a href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作与泛型类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，我们提取</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从映射类型的通用参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Type</span> leftType = GenericTypes.resolveType(Pair.class.getTypeParameters()[<span class="integer">0</span>], type);
<span class="predefined-type">Type</span> rightType = GenericTypes.resolveType(Pair.class.getTypeParameters()[<span class="integer">1</span>], type);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在第一行，</font></font><code>Pair.class.getTypeParameters()[0]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出类型变量
</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">同样在第二行，</font></font><code>Pair.class.getTypeParameters()[1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出类型变量</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们用于</font><font style="vertical-align: inherit;">在映射类型的上下文中</font></font><code>resolveType()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型变量的类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在我们有了</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font><font style="vertical-align: inherit;">的类型</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们可以</font></font><code>ColumnMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过配置注册表</font><font style="vertical-align: inherit;">从</font><font style="vertical-align: inherit;">配置类中</font><font style="vertical-align: inherit;">查找这些类型的列映射器</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ColumnMappers columnMappers = config.get(ColumnMappers.class);<font></font>
<font></font>
ColumnMapper&lt;?&gt; leftMapper = columnMappers.findFor(leftType)<font></font>
   .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
       <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for Pair left parameter </span><span class="delimiter">"</span></span> + leftType));<font></font>
ColumnMapper&lt;?&gt; rightMapper = columnMappers.findFor(rightType)<font></font>
   .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
       <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for Pair right parameter </span><span class="delimiter">"</span></span> + rightType));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置注册表是配置类的定位器。</font><font style="vertical-align: inherit;">因此，当我们调用 时
</font></font><code>config.get(ColumnMappers.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们会返回一个</font></font><code>ColumnMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有当前列映射器配置</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">实例。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来我们调用</font></font><code>ColumnMappers.findFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取左右类型的列映射器。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你可能已经注意到，虽然这个方法可以返回</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但如果我们找不到左侧或右侧的映射器，我们就会抛出异常。</font><font style="vertical-align: inherit;">我们发现这是一个最佳实践：</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果工厂对映射类型一无所知（</font></font><code>Pair</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本例中为 ），则返回。</font><font style="vertical-align: inherit;">如果它知道映射的类型但缺少一些使其工作的配置（例如映射器未注册</font></font><code>L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数），则抛出带有信息性消息的异常更有帮助，因此用户可以诊断</font><font style="vertical-align: inherit;">映射器未按预期工作的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原因</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，我们构造一个pair mapper，并返回它：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">RowMapper</span>&lt;?&gt; pairMapper = (rs, ctx) -&gt;
    <span class="keyword">new</span> Pair(leftMapper.map(rs, <span class="integer">1</span>, ctx), <span class="comment">// In JDBC, column numbers start at 1</span>
             rightMapper.map(rs, <span class="integer">2</span>, ctx)); <span class="comment">// ..for MOTHERF***ING REASONS</span><font></font>
<font></font>
<span class="keyword">return</span> Optional.of(pairMapper);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是工厂类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PairMapperFactory</span> <span class="directive">implements</span> RowMapperFactory {
  <span class="directive">public</span> Optional&lt;<span class="predefined-type">RowMapper</span>&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {
    <span class="keyword">if</span> (!Pair.class.equals(GenericTypes.getErasedType(type))) {
      <span class="keyword">return</span> Optional.empty();<font></font>
    }<font></font>
<font></font>
    <span class="predefined-type">Type</span> leftType = GenericTypes.resolveType(Pair.class.getTypeParameters()[<span class="integer">0</span>], type);
    <span class="predefined-type">Type</span> rightType = GenericTypes.resolveType(Pair.class.getTypeParameters()[<span class="integer">1</span>], type);<font></font>
<font></font>
    ColumnMappers columnMappers = config.get(ColumnMappers.class);<font></font>
<font></font>
    ColumnMapper&lt;?&gt; leftMapper = columnMappers.findFor(leftType)<font></font>
       .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
           <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for Pair left parameter </span><span class="delimiter">"</span></span> + leftType));<font></font>
    ColumnMapper&lt;?&gt; rightMapper = columnMappers.findFor(rightType)<font></font>
       .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
           <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for Pair right parameter </span><span class="delimiter">"</span></span> + rightType));<font></font>
<font></font>
    <span class="predefined-type">RowMapper</span>&lt;?&gt; pairMapper = (rs, ctx) -&gt;
        <span class="keyword">new</span> Pair(leftMapper.map(rs, <span class="integer">1</span>, ctx),<font></font>
                 rightMapper.map(rs, <span class="integer">2</span>, ctx));<font></font>
<font></font>
    <span class="keyword">return</span> Optional.of(pairMapper);<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行映射器工厂可以类似于常规行映射器进行注册：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.registerRowMapper(<span class="keyword">new</span> PairMapperFactory());<font></font>
<font></font>
<span class="keyword">try</span> (Handle handle = jdbi.open()) {
  <span class="predefined-type">List</span>&lt;Pair&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt; configPairs = handle<font></font>
          .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT key, value FROM config</span><span class="delimiter">"</span></span>)<font></font>
          .mapTo(<span class="keyword">new</span> GenericType&lt;Pair&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
          .list();<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>GenericType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用程序类中讨论</font></font><a href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作与泛型类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_column_mappers"><a class="anchor" href=" #_column_mappers"></a><a class="link" href=" #_column_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.2. </font><font style="vertical-align: inherit;">列映射器</font></font></a></h4>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/ColumnMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColumnMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个功能接口，它将一列从 JDBC </font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的当前行
</font><font style="vertical-align: inherit;">映射到映射类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于</font></font><code>ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是函数式接口，因此可以使用 lambda 表达式将它们内联提供给查询：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Money&gt; amounts = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select amount from transactions where account_id = ?</span><span class="delimiter">"</span></span>, accountId)<font></font>
    .map((rs, col, ctx) -&gt; Money.parse(rs.getString(col))) <i class="conum" data-value="1"></i><b>(1)</b>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每当使用列映射器映射行时，仅映射每行的第一列。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列映射器可以定义为允许重用的类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MoneyMapper</span> <span class="directive">implements</span> ColumnMapper&lt;Money&gt; {
  <span class="directive">public</span> Money map(<span class="predefined-type">ResultSet</span> r, <span class="type">int</span> columnNumber, StatementContext ctx) <span class="directive">throws</span> <span class="exception">SQLException</span> {
    <span class="keyword">return</span> Money.parse(r.getString(columnNumber));<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Money&gt; amounts = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select amount from transactions where account_id = ?</span><span class="delimiter">"</span></span>, accountId)<font></font>
    .map(<span class="keyword">new</span> MoneyMapper())<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这</font></font><code>ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于上面的 lambda 映射器，但更明确。</font></font></p>
</div>
<div class="sect4">
<h5 id="_columnmappers_registry"><a class="anchor" href=" #_columnmappers_registry"></a><a class="link" href=" #_columnmappers_registry"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColumnMappers 注册表</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以为特定类型注册列映射器。</font><font style="vertical-align: inherit;">这简化了使用，只需要您指定要映射到的类型。</font><font style="vertical-align: inherit;">Jdbi 会自动从注册表中查找映射器并使用它。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.registerColumnMapper(Money.class,<font></font>
    (rs, col, ctx) -&gt; Money.parse(rs.getString(col)));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;Money&gt; amounts = jdbi.withHandle(handle -&gt;<font></font>
    handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select amount from transactions where account_id = ?</span><span class="delimiter">"</span></span>, accountId)<font></font>
          .mapTo(Money.class)<font></font>
          .list());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它实现了一个映射器</font></font><code>ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有显式映射类型（如</font></font><code>MoneyMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前一节中的类）可以不指定映射类型被注册：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerColumnMapper(<span class="keyword">new</span> MoneyMapper());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用此方法时，Jdbi 检查映射器的泛型类签名以自动发现映射类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以为任何给定类型注册多个映射器。</font><font style="vertical-align: inherit;">发生这种情况时，给定类型的最后注册的映射器优先。</font><font style="vertical-align: inherit;">这允许优化，比如为某种类型注册一个“默认”映射器，同时允许在适当的时候用不同的映射器覆盖默认映射器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即用，列映射器注册为以下类型：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原语：</font></font><code>boolean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>byte</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>short</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和
</font></font><code>double</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.lang: </font></font><code>Boolean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Byte</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Short</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Character</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
 </font></font><code>Float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Double</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><code>Enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（默认存储为枚举值的名称）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.math： </font></font><code>BigDecimal</code></p>
</li>
<li>
<p><code>byte[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 数组（例如用于 BLOB 或 VARBINARY 列）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.net: </font></font><code>InetAddress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>URI</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.sql: </font></font><code>Timestamp</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.time: </font></font><code>Instant</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LocalTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
 </font></font><code>OffsetDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ZonedDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>ZoneId</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.util： </font></font><code>UUID</code></p>
</li>
<li>
<p><code>java.util.Collection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和 Java 数组（用于数组列）。</font><font style="vertical-align: inherit;">根据数组元素的类型，可能需要一些额外的设置——请参阅
</font></font><a href=" #_sql_arrays"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 数组</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
枚举值的绑定和映射方法可以通过</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/enums/Enums.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enums</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置以及</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/enums/EnumByName.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EnumByName</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/enums/EnumByOrdinal.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EnumByOrdinal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释进行控制。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_columnmapperfactory"><a class="anchor" href=" #_columnmapperfactory"></a><a class="link" href=" #_columnmapperfactory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列映射工厂</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甲</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/ColumnMapperFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColumnMapperFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以产生任意类型的列映射器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在以下情况下，实现工厂可能比常规列映射器更可取：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器类是通用的，可以应用于多个映射类型。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被映射的类型是通用的，和/或映射器可以由其他注册的映射器组成。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您想将多个映射器捆绑到一个类中。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们创建一个映射器工厂</font></font><code>Optional&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为示例。</font><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">为 注册了列映射器，则</font><font style="vertical-align: inherit;">工厂应</font></font><code>ColumnMapper&lt;Optional&lt;T&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为 any</font><font style="vertical-align: inherit;">生成</font><font style="vertical-align: inherit;">。</font></font><code>T</code><font style="vertical-align: inherit;"></font><code>T</code><font style="vertical-align: inherit;"></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们一步一步来：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">OptionalColumnMapperFactory</span> <span class="directive">implements</span> ColumnMapperFactory {
  <span class="directive">public</span> Optional&lt;ColumnMapper&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法接受映射类型和配置注册表。</font></font><code>Optional.of(someMapper)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它知道如何映射该类型，则</font><font style="vertical-align: inherit;">它可能会返回</font><font style="vertical-align: inherit;">，
</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">否则</font><font style="vertical-align: inherit;">可能会返回
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，我们检查映射类型是否为</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (!Optional.class.equals(GenericTypes.getErasedType(type))) {
  <span class="keyword">return</span> Optional.empty();<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>GenericTypes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用程序类中讨论</font></font><a href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作与泛型类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从映射类型中</font><font style="vertical-align: inherit;">提取</font><font style="vertical-align: inherit;">泛型参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Type</span> t = GenericTypes.resolveType(Optional.class.getTypeParameters()[<span class="integer">0</span>], type);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该表达式</font></font><code>Optional.class.getTypeParameters()[0]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出了类型变量
</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们用来</font><font style="vertical-align: inherit;">在映射类型的上下文中</font></font><code>resolveType()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在我们有了 的类型</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们可以</font></font><code>ColumnMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过配置注册表</font><font style="vertical-align: inherit;">从</font><font style="vertical-align: inherit;">配置类中</font><font style="vertical-align: inherit;">查找该类型的列映射器</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ColumnMapper&lt;?&gt; tMapper = config.get(ColumnMappers.class)<font></font>
    .findFor(embeddedType)<font></font>
    .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
        <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for parameter </span><span class="delimiter">"</span></span> + embeddedType + <span class="string"><span class="delimiter">"</span><span class="content"> of type </span><span class="delimiter">"</span></span> + type));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置注册表是配置类的定位器。</font><font style="vertical-align: inherit;">因此，当我们调用 时
</font></font><code>config.get(ColumnMappers.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们会返回一个</font></font><code>ColumnMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有当前列映射器配置</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">实例。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来我们调用</font></font><code>ColumnMappers.findFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取嵌入类型的列映射器。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你可能已经注意到，虽然这个方法可以返回</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但如果我们找不到嵌入类型的映射器，我们就会抛出异常。</font><font style="vertical-align: inherit;">我们发现这是一个最佳实践：</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果工厂对映射类型一无所知（</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本例中为 ），则返回。</font><font style="vertical-align: inherit;">如果它知道映射的类型但缺少一些使其工作的配置（例如没有为 tye</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">注册映射器</font><font style="vertical-align: inherit;">），则抛出带有信息性消息的异常更有帮助，因此用户可以诊断</font><font style="vertical-align: inherit;">映射器未按预期工作的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原因</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，我们为可选项构造列映射器，并返回它：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ColumnMapper&lt;?&gt; optionalMapper = (rs, col, ctx) -&gt;<font></font>
    Optional.ofNullable(tMapper.map(rs, col, ctx));<font></font>
<font></font>
<span class="keyword">return</span> Optional.of(optionalMapper);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是工厂类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">OptionalColumnMapperFactory</span> <span class="directive">implements</span> ColumnMapperFactory {
  <span class="directive">public</span> Optional&lt;ColumnMapper&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {
    <span class="keyword">if</span> (!Optional.class.equals(GenericTypes.getErasedType(type))) {
      <span class="keyword">return</span> Optional.empty();<font></font>
    }<font></font>
<font></font>
    <span class="predefined-type">Type</span> t = GenericTypes.resolveType(Optional.class.getTypeParameters()[<span class="integer">0</span>], type);<font></font>
<font></font>
    ColumnMapper&lt;?&gt; tMapper = config.get(ColumnMappers.class)<font></font>
        .findFor(t)<font></font>
        .orElseThrow(() -&gt; <span class="keyword">new</span> NoSuchMapperException(
            <span class="string"><span class="delimiter">"</span><span class="content">No column mapper registered for parameter </span><span class="delimiter">"</span></span> + t + <span class="string"><span class="delimiter">"</span><span class="content"> of type </span><span class="delimiter">"</span></span> + type));<font></font>
<font></font>
    ColumnMapper&lt;?&gt; optionalMapper = (rs, col, ctx) -&gt;<font></font>
        Optional.ofNullable(tMapper.map(rs, col, ctx));<font></font>
<font></font>
    <span class="keyword">return</span> Optional.of(optionalMapper);<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列映射器工厂可以类似于常规列映射器进行注册：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.registerColumnMapper(<span class="keyword">new</span> OptionalColumnMapperFactory());<font></font>
<font></font>
<span class="keyword">try</span> (Handle handle = jdbi.open()) {
  <span class="predefined-type">List</span>&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt; middleNames = handle<font></font>
          .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select middle_name from contacts</span><span class="delimiter">"</span></span>)<font></font>
          .mapTo(<span class="keyword">new</span> GenericType&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
          .list();<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>GenericType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用程序类中讨论</font></font><a href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作与泛型类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_primitive_mapping"><a class="anchor" href=" #_primitive_mapping"></a><a class="link" href=" #_primitive_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.3. </font><font style="vertical-align: inherit;">原始映射</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有 Java 基本类型都有到它们相应的 JDBC 类型的默认映射。</font><font style="vertical-align: inherit;">一般情况下，Jdbi 在遇到包装器类型时会自动进行适当的装箱和拆箱。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射到原始类型的</font><font style="vertical-align: inherit;">SQL</font><font style="vertical-align: inherit;">将采用 Java 默认值。</font><font style="vertical-align: inherit;">这可以通过配置禁用
</font></font><code>jdbi.getConfig(ColumnMappers.class).setCoalesceNullPrimitivesToDefaults(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_immutables_mapping"><a class="anchor" href=" #_immutables_mapping"></a><a class="link" href=" #_immutables_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.4. </font><font style="vertical-align: inherit;">不可变映射</font></font></a></h4>
<div class="paragraph">
<p><code>Immutables</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值对象可能会被映射，请参阅</font></font><a href=" #_immutables"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不可变</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分了解详细信息。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_freebuilder_mapping"><a class="anchor" href=" #_freebuilder_mapping"></a><a class="link" href=" #_freebuilder_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.5. </font><font style="vertical-align: inherit;">自由建造者映射</font></font></a></h4>
<div class="paragraph">
<p><code>Freebuilder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值对象可能会被映射，请参阅</font></font><a href=" #_freebuilder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freebuilder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分了解详细信息。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_reflection_mappers"><a class="anchor" href=" #_reflection_mappers"></a><a class="link" href=" #_reflection_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5.6. </font><font style="vertical-align: inherit;">反射映射器</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了一些开箱即用的基于反射的映射器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反射映射器将列名称视为 bean 属性名称 (BeanMapper)、构造函数参数名称 (ConstructorMapper) 或字段名称 (FieldMapper)。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反射映射器可以识别snake_case，并且会自动将这些列与camelCase 字段/参数/属性名称匹配。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要指示 Jdbi 忽略其他可映射的方法，请将其注释为</font></font><code>@Unmappable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="_constructormapper"><a class="anchor" href=" #_constructormapper"></a><a class="link" href=" #_constructormapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造器映射器</font></font></a></h5>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供了一个简单的构造函数映射器，它使用反射按名称将列分配给构造函数参数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ConstructorProperties</span>({<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>})
<span class="directive">public</span> User(<span class="type">int</span> id, <span class="predefined-type">String</span> name) {
  <span class="local-variable">this</span>.id = id;
  <span class="local-variable">this</span>.name = name;<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@ConstructorProperties</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解告诉Jdbi每个构造函数参数的属性名称，因此它可以找出哪些列对应于每一个构造函数的参数。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lombok 的</font></font><code>@AllArgsConstructor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释会</font></font><code>@ConstructorProperties</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为您</font><font style="vertical-align: inherit;">生成
</font><font style="vertical-align: inherit;">注释。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font></font><code>-parameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java 编译器标志消除了对</font></font><code>@ConstructorProperties</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">的需要——
</font><font style="vertical-align: inherit;">参见</font></font><a href=" #_compiling_with_parameter_names"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用参数名称编译</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> User(<span class="type">int</span> id, <span class="predefined-type">String</span> name) {
    <span class="local-variable">this</span>.id = id;
    <span class="local-variable">this</span>.name = name;<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下</font></font><code>factory()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法</font><font style="vertical-align: inherit;">为映射类注册构造函数映射器</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(ConstructorMapper.factory(User.class));
<span class="predefined-type">Set</span>&lt;User&gt; userSet = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .collect(Collectors.toSet());<font></font>
<font></font>
assertThat(userSet).hasSize(<span class="integer">4</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数参数名称“id”、“name”与数据库列名称匹配，因此根本不需要自定义映射器代码。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数映射器可以为每个映射的构造函数参数配置一个列名前缀。</font><font style="vertical-align: inherit;">这有助于消除映射连接的歧义，例如，当两个映射类具有相同的属性名称（如</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(ConstructorMapper.factory(Contact.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(ConstructorMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(JoinRowMapper.forTypes(Contact.class, Phone.class);<font></font>
<span class="predefined-type">List</span>&lt;JoinRow&gt; contactPhones = handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">c.id cid, c.name cname, </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">p.id pid, p.name pname, p.number pnumber </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">from contacts c left join phones p on c.id = p.contact_id</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(JoinRow.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，映射类将具有单个构造函数。</font><font style="vertical-align: inherit;">如果它有多个构造函数，Jdbi 将根据以下规则选择一个：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，使用带有 注释的构造函数</font></font><code>@JdbiConstructor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果有的话。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，使用带有 注释的构造函数</font></font><code>@ConstructorProperties</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果有的话。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">否则，抛出 Jdbi 不知道使用哪个构造函数的异常。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于与属性名称不匹配的旧列名称，请使用
</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释提供准确的列名称。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> User(<span class="annotation">@ColumnName</span>(<span class="string"><span class="delimiter">"</span><span class="content">user_id</span><span class="delimiter">"</span></span>) <span class="type">int</span> id, <span class="predefined-type">String</span> name) {
  <span class="local-variable">this</span>.id = id;
  <span class="local-variable">this</span>.name = name;<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释仅在将 SQL 数据映射到 Java 对象时适用。</font><font style="vertical-align: inherit;">当绑定对象属性（例如 with </font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，绑定属性名 ( </font></font><code>:id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 而不是列名 ( </font></font><code>:user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌套的构造函数注入类型可以使用</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">进行映射</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">public</span> User(<span class="type">int</span> id,
              <span class="predefined-type">String</span> name,
              <span class="annotation">@Nested</span> Address address) {<font></font>
    ...<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
  <span class="directive">public</span> Address(<span class="predefined-type">String</span> street,
                 <span class="predefined-type">String</span> city,
                 <span class="predefined-type">String</span> state,
                 <span class="predefined-type">String</span> zip) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(ConstructorMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, street, city, state, zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解有一个可选</font></font><code>value()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，可用于将列名前缀应用于每个嵌套的构造函数参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> User(<span class="type">int</span> id,
            <span class="predefined-type">String</span> name,
            <span class="annotation">@Nested</span>(<span class="string"><span class="delimiter">"</span><span class="content">addr</span><span class="delimiter">"</span></span>) Address address) {<font></font>
  ...<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(ConstructorMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, addr_street, addr_city, addr_state, addr_zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，ConstructorMapper 期望结果集包含映射每个构造函数参数的列，如果任何参数无法映射，则会抛出异常。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释的参数</font></font><code>@Nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以从结果集中省略，其中
</font></font><code>ConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将传递</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给该参数的构造函数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">public</span> User(<span class="type">int</span> id,
              <span class="predefined-type">String</span> name,
              <span class="annotation">@Nullable</span> <span class="predefined-type">String</span> passwordHash,
              <span class="annotation">@Nullable</span> <span class="annotation">@Nested</span> Address address) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此示例中，</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列必须出现在结果集中，但</font></font><code>passwordHash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的。</font><font style="vertical-align: inherit;">如果它们存在，它们将被映射。</font><font style="vertical-align: inherit;">除此以外，</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"></font><code>@Nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用任何包中的</font><font style="vertical-align: inherit;">
任何</font><font style="vertical-align: inherit;">注释。
</font></font><code>javax.annotation.Nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是个不错的选择。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_beanmapper"><a class="anchor" href=" #_beanmapper"></a><a class="link" href=" #_beanmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">豆映射器</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们还提供映射 bean 的基本支持：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserBean</span> {
    <span class="directive">private</span> <span class="type">int</span> id;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;<font></font>
<font></font>
    <span class="directive">public</span> <span class="type">int</span> getId() {
        <span class="keyword">return</span> id;<font></font>
    }<font></font>
    <span class="directive">public</span> <span class="type">void</span> setId(<span class="type">int</span> id) {
        <span class="local-variable">this</span>.id = id;<font></font>
    }<font></font>
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;<font></font>
    }<font></font>
    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下</font></font><code>factory()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">为您的映射类注册一个 bean 映射器</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(BeanMapper.factory(UserBean.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;UserBean&gt; users = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select id, name from user</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(UserBean.class)<font></font>
        .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，调用</font></font><code>mapToBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是注册 bean 映射器：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;UserBean&gt; users = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select id, name from user</span><span class="delimiter">"</span></span>)<font></font>
        .mapToBean(UserBean.class)<font></font>
        .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bean 映射器可以为每个映射属性配置一个列名前缀。</font><font style="vertical-align: inherit;">这有助于消除映射连接的歧义，例如，当两个映射类具有相同的属性名称（如</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(BeanMapper.factory(ContactBean.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(BeanMapper.factory(PhoneBean.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(JoinRowMapper.forTypes(ContactBean.class, PhoneBean.class));<font></font>
<span class="predefined-type">List</span>&lt;JoinRow&gt; contactPhones = handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select </span><span class="delimiter">"</span></span>
        + <span class="string"><span class="delimiter">"</span><span class="content">c.id cid, c.name cname, </span><span class="delimiter">"</span></span>
        + <span class="string"><span class="delimiter">"</span><span class="content">p.id pid, p.name pname, p.number pnumber </span><span class="delimiter">"</span></span>
        + <span class="string"><span class="delimiter">"</span><span class="content">from contacts c left join phones p on c.id = p.contact_id</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(JoinRow.class)<font></font>
        .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于与属性名称不匹配的旧列名称，请使用
</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释提供准确的列名称。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">private</span> <span class="type">int</span> id;<font></font>
<font></font>
  <span class="annotation">@ColumnName</span>(<span class="string"><span class="delimiter">"</span><span class="content">user_id</span><span class="delimiter">"</span></span>)
  <span class="directive">public</span> <span class="type">int</span> getId() { <span class="keyword">return</span> id; }<font></font>
<font></font>
  <span class="directive">public</span> <span class="type">void</span> setId(<span class="type">int</span> id) { <span class="local-variable">this</span>.id = id; }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以放在任一吸气剂或setter方法。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释仅在将 SQL 数据映射到 Java 对象时适用。</font><font style="vertical-align: inherit;">当绑定对象属性（例如 with </font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，绑定属性名 ( </font></font><code>:id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 而不是列名 ( </font></font><code>:user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">映射嵌套的 Java Bean 类型</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">private</span> <span class="type">int</span> id;
  <span class="directive">private</span> <span class="predefined-type">String</span> name;
  <span class="directive">private</span> Address address;<font></font>
<font></font>
  ... (getters and setters)<font></font>
<font></font>
  <span class="annotation">@Nested</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="directive">public</span> Address getAddress() { ... }<font></font>
<font></font>
  <span class="directive">public</span> <span class="type">void</span> setAddress(Address address) { ... }<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
  <span class="directive">private</span> <span class="predefined-type">String</span> street;
  <span class="directive">private</span> <span class="predefined-type">String</span> city;
  <span class="directive">private</span> <span class="predefined-type">String</span> state;
  <span class="directive">private</span> <span class="predefined-type">String</span> zip;<font></font>
<font></font>
  ... (getters and setters)<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以放在任一吸气剂或setter方法。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(BeanMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, street, city, state, zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解有一个可选</font></font><code>value()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，可用于将列名前缀应用于每个嵌套的 bean 属性：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Nested</span>(<span class="string"><span class="delimiter">"</span><span class="content">addr</span><span class="delimiter">"</span></span>)
<span class="directive">public</span> Address getAddress() { ... }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(BeanMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, addr_street, addr_city, addr_state, addr_zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content">
<code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果结果集没有与嵌套对象的任何属性匹配的列，则属性保持不变（即 null）。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_fieldmapper"><a class="anchor" href=" #_fieldmapper"></a><a class="link" href=" #_fieldmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段映射器</font></font></a></h5>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/reflect/FieldMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FieldMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用反射将数据库列直接映射到对象字段（包括私有字段）。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">public</span> <span class="type">int</span> id;<font></font>
<font></font>
  <span class="directive">public</span> <span class="predefined-type">String</span> name;<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下</font></font><code>factory()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">为映射类注册字段映射器</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(FieldMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;UserBean&gt; users = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select id, name from user</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(User.class)<font></font>
        .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段映射器可以为每个映射字段配置一个列名前缀。</font><font style="vertical-align: inherit;">这有助于消除映射连接的歧义，例如，当两个映射类具有相同的属性名称（如</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(FieldMapper.factory(Contact.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(FieldMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>));<font></font>
handle.registerRowMapper(JoinRowMapper.forTypes(Contact.class, Phone.class);<font></font>
<span class="predefined-type">List</span>&lt;JoinRow&gt; contactPhones = handle.select(<span class="string"><span class="delimiter">"</span><span class="content">select </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">c.id cid, c.name cname, </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">p.id pid, p.name pname, p.number pnumber </span><span class="delimiter">"</span></span> +
        <span class="string"><span class="delimiter">"</span><span class="content">from contacts c left join phones p on c.id = p.contact_id</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(JoinRow.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于与字段名称不匹配的旧列名称，请使用
</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释提供准确的列名称：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="annotation">@ColumnName</span>(<span class="string"><span class="delimiter">"</span><span class="content">user_id</span><span class="delimiter">"</span></span>)
  <span class="directive">public</span> <span class="type">int</span> id;<font></font>
<font></font>
  <span class="directive">public</span> <span class="predefined-type">String</span> name;<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释仅在将 SQL 数据映射到 Java 对象时适用。</font><font style="vertical-align: inherit;">当绑定对象属性（例如 with </font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，绑定属性名 ( </font></font><code>:id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 而不是列名 ( </font></font><code>:user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌套的字段映射类型可以使用</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">进行映射</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">public</span> <span class="type">int</span> id;
  <span class="directive">public</span> <span class="predefined-type">String</span> name;<font></font>
<font></font>
  <span class="annotation">@Nested</span>
  <span class="directive">public</span> Address address;<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
  <span class="directive">public</span> <span class="predefined-type">String</span> street;
  <span class="directive">public</span> <span class="predefined-type">String</span> city;
  <span class="directive">public</span> <span class="predefined-type">String</span> state;
  <span class="directive">public</span> <span class="predefined-type">String</span> zip;<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(FieldMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, street, city, state, zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释有一个可选的</font></font><code>value()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，该属性可以被用于一列名的前缀应用于每个嵌套字段：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
  <span class="directive">public</span> <span class="type">int</span> id;
  <span class="directive">public</span> <span class="predefined-type">String</span> name;<font></font>
<font></font>
  <span class="annotation">@Nested</span>(<span class="string"><span class="delimiter">"</span><span class="content">addr</span><span class="delimiter">"</span></span>)
  <span class="directive">public</span> Address address;<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerRowMapper(FieldMapper.factory(User.class));<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;User&gt; users = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select id, name, addr_street, addr_city, addr_state, addr_zip from users</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(User.class)<font></font>
    .list();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content">
<code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果结果集没有与嵌套对象的任何字段匹配的列，则字段保持不变（即空）。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_map_entry_mapping"><a class="anchor" href=" #_map_entry_mapping"></a><a class="link" href=" #_map_entry_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map.Entry 映射</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即用，Jdbi 注册了一个</font></font><code>RowMapper&lt;Map.Entry&lt;K,V&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">由于结果集中的每一行都是 a </font></font><code>Map.Entry&lt;K,V&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所以整个结果集可以很容易地收集到 a </font></font><code>Map&lt;K,V&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或 Guava 的</font></font><code>Multimap&lt;K,V&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必须为键和值类型注册映射器。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过指定通用映射签名，可以将连接行收集到映射结果中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> sql = <span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, p.id p_id, p.phone p_phone </span><span class="delimiter">"</span></span><font></font>
<font></font>
    + <span class="string"><span class="delimiter">"</span><span class="content">from user u left join phone p on u.id = p.user_id</span><span class="delimiter">"</span></span>;
<span class="predefined-type">Map</span>&lt;User, Phone&gt; map = h.createQuery(sql)<font></font>
        .registerRowMapper(ConstructorMapper.factory(User.class, <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>))<font></font>
        .registerRowMapper(ConstructorMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>))<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Map</span>&lt;User, Phone&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在前面的示例中，</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器使用“u”列名称前缀，而</font></font><code>Phone</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器使用“p”。</font><font style="vertical-align: inherit;">由于每个映射器仅读取具有预期前缀的</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">，因此相应的</font><font style="vertical-align: inherit;">列是明确的。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过设置键列名来获得唯一索引（例如通过 ID 列）：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, User&gt; map = h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from user</span><span class="delimiter">"</span></span>)<font></font>
        .setMapKeyColumn(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>)<font></font>
        .registerRowMapper(ConstructorMapper.factory(User.class))<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, User&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置键和值列名称以将两列查询收集到映射结果中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; map = h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select key, value from config</span><span class="delimiter">"</span></span>)<font></font>
        .setMapKeyColumn(<span class="string"><span class="delimiter">"</span><span class="content">key</span><span class="delimiter">"</span></span>)<font></font>
        .setMapValueColumn(<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>)<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上所有示例都假设是一对一的键/值关系。</font><font style="vertical-align: inherit;">如果存在一对多关系呢？</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Guava 提供了一种</font></font><code>Multimap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型，它支持每个键映射多个值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，按照</font></font><a href=" #_google_guava"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Guava</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中的说明安装
</font></font><code>GuavaPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到 Jdbi。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，只需要求 a</font></font><code>Multimap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是 a </font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> sql = <span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, p.id p_id, p.phone p_phone </span><span class="delimiter">"</span></span>
    + <span class="string"><span class="delimiter">"</span><span class="content">from user u left join phone p on u.id = p.user_id</span><span class="delimiter">"</span></span>;<font></font>
Multimap&lt;User, Phone&gt; map = h.createQuery(sql)<font></font>
        .registerRowMapper(ConstructorMapper.factory(User.class, <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>))<font></font>
        .registerRowMapper(ConstructorMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>))<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;Multimap&lt;User, Phone&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>collectInto()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法值得解释。</font><font style="vertical-align: inherit;">当你调用它时，幕后会发生几件事情：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查阅</font></font><code>JdbiCollectors</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册表以获取</font><font style="vertical-align: inherit;">支持给定容器类型</font><font style="vertical-align: inherit;">的
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/collector/CollectorFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CollectorFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，要求</font></font><code>CollectorFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从容器类型签名中提取元素类型。</font><font style="vertical-align: inherit;">在上面的例子中，元素类型
</font></font><code>Multimap&lt;User,Phone&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code>Map.Entry&lt;User,Phone&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从映射注册表中获取该元素类型的映射器。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得一个</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收藏家</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从容器类型</font></font><code>CollectorFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，返回</font></font><code>map(elementMapper).collect(collector)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果对收集器工厂、元素类型或元素映射器的查找失败，则会引发异常。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以增强 Jdbi 以支持任意容器类型。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息，</font><font style="vertical-align: inherit;">请参阅
</font></font><a href=" #JdbiCollectors"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[JdbiCollectors]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_codecs"><a class="anchor" href=" #_codecs"></a><a class="link" href=" #_codecs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6. </font><font style="vertical-align: inherit;">编解码器</font></font></a></h3>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Codec API 仍然不稳定，可能会发生变化。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编解码器是为类型注册参数和列映射器的替代品。</font><font style="vertical-align: inherit;">它负责将类型化的值序列化为数据库列并从数据库列创建类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编解码器收集在编解码器工厂中，该工厂可以使用 registerCodecFactory 便捷方法进行注册。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// register a single codec</span><font></font>
jdbi.registerCodecFactory(CodecFactory.forSingleCodec(type, codec));<font></font>
<font></font>
<span class="comment">// register a few codecs</span><font></font>
jdbi.registerCodecFactory(CodecFactory.builder()<font></font>
  <span class="comment">// register a codec by qualified type</span><font></font>
  .addCodec(QualifiedType.of(Foo.class), codec1)<font></font>
  <span class="comment">// register a codec by direct java type</span><font></font>
  .addCodec(Foo.class, codec2)<font></font>
  <span class="comment">// register a codec by generic type</span>
  .addCodec(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Set</span>&lt;Foo&gt;&gt;() {}. codec3)<font></font>
  .build());<font></font>
<font></font>
<span class="comment">// register many codecs</span>
<span class="predefined-type">Map</span>&lt;QualifiedType&lt;?&gt;, Codec&lt;?&gt;&gt; codecs = ...<font></font>
jdbi.registerCodecFactory(<span class="keyword">new</span> CodecFactory(codecs));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编解码器示例：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Counter</span> {<font></font>
<font></font>
    <span class="directive">private</span> <span class="type">int</span> count = <span class="integer">0</span>;<font></font>
<font></font>
    <span class="directive">public</span> Counter() {}<font></font>
<font></font>
    <span class="directive">public</span> <span class="type">int</span> nextValue() {
        <span class="keyword">return</span> count++;<font></font>
    }<font></font>
<font></font>
    <span class="directive">private</span> Counter setValue(<span class="type">int</span> value) {
        <span class="local-variable">this</span>.count = value;
        <span class="keyword">return</span> <span class="local-variable">this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="directive">private</span> <span class="type">int</span> getValue() {
        <span class="keyword">return</span> count;<font></font>
    }<font></font>
<font></font>
    <span class="comment">/**
     * Codec to persist a counter to the database and restore it back.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">CounterCodec</span> <span class="directive">implements</span> Codec&lt;Counter&gt; {<font></font>
<font></font>
        <span class="annotation">@Override</span>
        <span class="directive">public</span> ColumnMapper&lt;Counter&gt; getColumnMapper() {
            <span class="keyword">return</span> (r, idx, ctx) -&gt; <span class="keyword">new</span> Counter().setValue(r.getInt(idx));<font></font>
        }<font></font>
<font></font>
        <span class="annotation">@Override</span>
        <span class="directive">public</span> Function&lt;Counter, Argument&gt; getArgumentFunction() {
            <span class="keyword">return</span> counter -&gt; (idx, stmt, ctx) -&gt; stmt.setInt(idx, counter.getValue());<font></font>
        }<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JDBI 核心 API：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// register the codec with JDBI</span>
jdbi.registerCodecFactory(CodecFactory.forSingleCodec(COUNTER_TYPE, <span class="keyword">new</span> CounterCodec()));<font></font>
<font></font>
<font></font>
<span class="comment">// store object</span>
<span class="type">int</span> result = jdbi.withHandle(h -&gt; h.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO counters (id, value) VALUES (:id, :value)</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, counterId)<font></font>
    .bindByType(<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>, counter, COUNTER_TYPE)<font></font>
    .execute());<font></font>
<font></font>
<font></font>
<span class="comment">// load object</span>
Counter restoredCounter = jdbi.withHandle(h -&gt; h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT value from counters where id = :id</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, counterId)<font></font>
    .mapTo(COUNTER_TYPE).first());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL Object API 透明地使用编解码器：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// SQL object dao</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CounterDao</span> {
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO counters (id, value) VALUES (:id, :value)</span><span class="delimiter">"</span></span>)
    <span class="type">int</span> storeCounter(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> id, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>) Counter counter);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT value from counters where id = :id</span><span class="delimiter">"</span></span>)<font></font>
    Counter loadCounter(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> id);<font></font>
}<font></font>
<font></font>
<font></font>
    <span class="comment">// register the codec with JDBI</span>
    jdbi.registerCodecFactory(CodecFactory.forSingleCodec(COUNTER_TYPE, <span class="keyword">new</span> CounterCodec()));<font></font>
<font></font>
<font></font>
    <span class="comment">// store object</span>
    <span class="type">int</span> result = jdbi.withExtension(CounterDao.class, dao -&gt; dao.storeCounter(counterId, counter));<font></font>
<font></font>
<font></font>
    <span class="comment">// load object</span>
    Counter restoredCounter = jdbi.withExtension(CounterDao.class, dao -&gt; dao.loadCounter(counterId));</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_resolving_types"><a class="anchor" href=" #_resolving_types"></a><a class="link" href=" #_resolving_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6.1. </font><font style="vertical-align: inherit;">解析类型</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用</font></font><code>TypeResolvingCodecFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/guava/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guava</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块的 ，可以使用为具体类的子类或接口类型注册的编解码器。</font><font style="vertical-align: inherit;">这是必要的，例如将</font></font><a href="https://github.com/google/auto/blob/master/value/userguide/index.md" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动值</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成的类</font><font style="vertical-align: inherit;">映射</font><font style="vertical-align: inherit;">到数据库列。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在下面的例子中，只有一个用于</font></font><code>Value&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册</font><font style="vertical-align: inherit;">的编解码器</font><font style="vertical-align: inherit;">，但代码使用了 bean 和具体实现的类（</font></font><code>StringBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含一个</font></font><code>StringValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>StringValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font></font><code>Value&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口）。</font></font><code>TypeResolvingCodecFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果找不到完美匹配</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">将检查类型以查找接口或超类的编解码器。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// SQL object dao using concrete types</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">DataDao</span> {<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO data (id, value) VALUES (:bean.id, :bean.value)</span><span class="delimiter">"</span></span>)
    <span class="type">int</span> storeData(<span class="annotation">@BindBean</span>(<span class="string"><span class="delimiter">"</span><span class="content">bean</span><span class="delimiter">"</span></span>) StringBean bean);<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO data (id, value) VALUES (:id, :value)</span><span class="delimiter">"</span></span>)
    <span class="type">int</span> storeData(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> id, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>) StringValue data);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT value from data where id = :id</span><span class="delimiter">"</span></span>)<font></font>
    StringValue loadData(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> id);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="comment">// generic type representation</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> QualifiedType&lt;Value&lt;<span class="predefined-type">String</span>&gt;&gt; DATA_TYPE = QualifiedType.of(<span class="keyword">new</span> GenericType&lt;Value&lt;<span class="predefined-type">String</span>&gt;&gt;() {});<font></font>
<font></font>
<font></font>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">DataCodec</span> <span class="directive">implements</span> Codec&lt;Value&lt;<span class="predefined-type">String</span>&gt;&gt; {<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ColumnMapper&lt;Value&lt;<span class="predefined-type">String</span>&gt;&gt; getColumnMapper() {
        <span class="keyword">return</span> (r, idx, ctx) -&gt; {
            <span class="keyword">return</span> <span class="keyword">new</span> StringValue(r.getString(idx));<font></font>
        };<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> Function&lt;Value&lt;<span class="predefined-type">String</span>&gt;, Argument&gt; getArgumentFunction() {
        <span class="keyword">return</span> data -&gt; (idx, stmt, ctx) -&gt; {<font></font>
            stmt.setString(idx, data.getValue());<font></font>
        };<font></font>
    }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="comment">// value interface</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Value</span>&lt;T&gt; {<font></font>
<font></font>
    T getValue();<font></font>
}<font></font>
<font></font>
<font></font>
<span class="comment">// bean using concrete types, not interface types.</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">StringBean</span> <span class="directive">implements</span> Bean&lt;Value&lt;<span class="predefined-type">String</span>&gt;&gt; {<font></font>
<font></font>
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> id;<font></font>
<font></font>
    <span class="directive">private</span> <span class="directive">final</span> StringValue value;<font></font>
<font></font>
    <span class="directive">public</span> StringBean(<span class="predefined-type">String</span> id, StringValue value) {
        <span class="local-variable">this</span>.id = id;
        <span class="local-variable">this</span>.value = value;<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getId() {
        <span class="keyword">return</span> id;<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> StringValue getValue() {
        <span class="keyword">return</span> value;<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_templating"><a class="anchor" href=" #_templating"></a><a class="link" href=" #_templating"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.7. </font><font style="vertical-align: inherit;">模板制作</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如上所述，绑定查询参数非常适合向数据库引擎发送一组静态参数。</font><font style="vertical-align: inherit;">绑定可确保将参数化查询字符串 ( </font></font><code>…​ where foo = ?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 传输到数据库，而不允许恶意参数值注入 SQL。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定参数并不总是足够的。</font><font style="vertical-align: inherit;">有时，查询在执行之前需要进行复杂的或结构化的更改，而参数就是不切实际的。</font><font style="vertical-align: inherit;">模板化（使用 a </font></font><code>TemplateEngine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）允许您使用一般的字符串操作来更改查询的内容。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板的典型用途是可选或重复段（条件和循环）、复杂变量（例如 IN 子句的逗号分隔列表）以及不可绑定 SQL 元素（例如表名）的变量替换。</font><font style="vertical-align: inherit;">与</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数绑定</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">由 TemplateEngines 执行</font><font style="vertical-align: inherit;">的</font><em><font style="vertical-align: inherit;">属性</font></em></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呈现</font></font></em><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">不是</font></strong><font style="vertical-align: inherit;">SQL 感知的。</font><font style="vertical-align: inherit;">由于它们执行通用字符串操作，如果您不小心使用它们，TemplateEngines 可以很容易地产生严重损坏或有细微缺陷的查询。</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font></p>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content">
<a href="https://www.xkcd.com/327/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询模板是一种常见的攻击媒介！</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  在可能的情况下，与静态 SQL 相比，始终更喜欢绑定参数而不是动态 SQL。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from &lt;TABLE&gt; where name = :n</span><span class="delimiter">"</span></span>)<font></font>
<font></font>
    <span class="comment">// -&gt; "select * from Person where name = :n"</span>
    .define(<span class="string"><span class="delimiter">"</span><span class="content">TABLE</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Person</span><span class="delimiter">"</span></span>)<font></font>
<font></font>
    <span class="comment">// -&gt; "select * from Person where name = 'MyName'"</span>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">n</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">MyName</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用 TemplateEngine 对查询执行粗略的字符串操作。</font><font style="vertical-align: inherit;">查询参数应该由 Arguments 处理。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TemplateEngines 和 SqlParsers 依次操作：初始 String 将由 TemplateEngine 使用属性呈现，然后由 SqlParser 与 Argument 绑定解析。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果 TemplateEngine 输出的文本与 SqlParser 的参数格式匹配，则解析器将尝试将一个 Argument 绑定到它。</font><font style="vertical-align: inherit;">这对于例如具有名称本身也是变量的命名参数很有用，但也会导致令人困惑的错误：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> paramName = <span class="string"><span class="delimiter">"</span><span class="content">arg</span><span class="delimiter">"</span></span>;<font></font>
<font></font>
handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from Foo where bar = :&lt;attr&gt;</span><span class="delimiter">"</span></span>)<font></font>
    .define(<span class="string"><span class="delimiter">"</span><span class="content">attr</span><span class="delimiter">"</span></span>, paramName)<font></font>
    ...<font></font>
    .bind(paramName, <span class="string"><span class="delimiter">"</span><span class="content">baz</span><span class="delimiter">"</span></span>); <span class="comment">// &lt;- does not need to know the parameter's name ("arg")!</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from emotion where emoticon = &lt;sticker&gt;</span><span class="delimiter">"</span></span>)<font></font>
    .define(<span class="string"><span class="delimiter">"</span><span class="content">sticker</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">:-)</span><span class="delimiter">"</span></span>) <span class="comment">// -&gt; "... where emoticon = :-)"</span><font></font>
    .mapToMap()<font></font>
    <span class="comment">// exception: no binding/argument named "-)" present</span>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定和定义通常是分开的。</font><font style="vertical-align: inherit;">您可以使用</font></font><code>stmt.defineNamedBindings()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>@DefineNamedBindings</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定制器</font><font style="vertical-align: inherit;">以有限的方式链接它们</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于每个绑定参数（包括 bean 属性），这将定义一个布尔值，表示</font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定是否存在</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以使用它来制作条件更新和查询子句。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">MyBean</span> {
    <span class="type">long</span> id();
    <span class="predefined-type">String</span> getA();
    <span class="predefined-type">String</span> getB();<font></font>
    Instant getModified();<font></font>
}<font></font>
<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">update mybeans set &lt;if(a)&gt;a = :a,&lt;endif&gt; &lt;if(b)&gt;b = :b,&lt;endif&gt; modified=now() where id=:id</span><span class="delimiter">"</span></span>)<font></font>
    .bindBean(mybean)<font></font>
    .defineNamedBindings()<font></font>
    .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另请参阅有关</font></font><a href=" #_templateengine"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TemplateEngine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的部分</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="sect3">
<h4 id="_classpathsqllocator"><a class="anchor" href=" #_classpathsqllocator"></a><a class="link" href=" #_classpathsqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.7.1. </font><font style="vertical-align: inherit;">类路径SqlLocator</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能会发现将 SQL 模板存储在类路径上的单个文件中而不是 Java 代码中的字符串中很有帮助。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code>ClasspathSqlLocator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java类型和方法名转换成classpath中的位置，然后读取，解析，并缓存加载的语句。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// reads classpath resource com/foo/BarDao/query.sql</span>
ClasspathSqlLocator.create().locate(com.foo.BarDao.class, <span class="string"><span class="delimiter">"</span><span class="content">query</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
<span class="comment">// same resource as above</span>
ClasspathSqlLocator.create().locate(<span class="string"><span class="delimiter">"</span><span class="content">com.foo.BarDao.query</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，加载文件中的任何注释都保持不变。</font><font style="vertical-align: inherit;">可以通过</font></font><code>ClasspathSqlLocator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下</font></font><code>removingComments()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">实例化 来去除注释</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// reads classpath resource com/foo/BarDao/query.sql, stripping all comments</span>
ClasspathSqlLocator.removingComments().locate(com.foo.BarDao.class, <span class="string"><span class="delimiter">"</span><span class="content">query</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
<span class="comment">// same resource as above</span>
ClasspathSqlLocator.removingComments().locate(<span class="string"><span class="delimiter">"</span><span class="content">com.foo.BarDao.query</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持多种评论样式：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C 风格（</font></font><code>/* …​ */</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>//</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到行尾）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 样式（</font></font><code>--</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到行尾）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell 样式（</font></font><code>#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到行尾；除非紧跟在</font></font><code>&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">后面</font><font style="vertical-align: inherit;">；这是 Postgres</font></font><code>#&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>#&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符</font><font style="vertical-align: inherit;">所必需的</font><font style="vertical-align: inherit;">）。</font></font></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sql_arrays"><a class="anchor" href=" #_sql_arrays"></a><a class="link" href=" #_sql_arrays"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8. </font><font style="vertical-align: inherit;">SQL 数组</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 可以绑定/映射 Java 数组到/从 SQL 数组：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into groups (id, user_ids) values (:id, :userIds)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">userIds</span><span class="delimiter">"</span></span>, <span class="keyword">new</span> <span class="type">int</span><span class="type">[]</span> { <span class="integer">10</span>, <span class="integer">5</span>, <span class="integer">70</span> })<font></font>
      .execute();<font></font>
<font></font>
<span class="type">int</span><span class="type">[]</span> userIds = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select user_ids from groups where id = :id</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .mapTo(<span class="type">int</span><span class="type">[]</span>.class)<font></font>
      .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您也可以使用 Collections 代替数组，但如果您使用的是 fluent API，则需要提供元素类型，因为它已被删除：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into groups (id, user_ids) values (:id, :userIds)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .bindArray(<span class="string"><span class="delimiter">"</span><span class="content">userIds</span><span class="delimiter">"</span></span>, <span class="type">int</span>.class, <span class="predefined-type">Arrays</span>.asList(<span class="integer">10</span>, <span class="integer">5</span>, <span class="integer">70</span>))<font></font>
      .execute();<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; userIds = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select user_ids from groups where id = :id</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .mapTo(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt;&gt;() {})<font></font>
      .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于使用</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlObject API 映射数组结果：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">GroupsDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select user_ids from groups where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@SingleValue</span>
  <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; getUserIds(<span class="type">int</span> groupId);<font></font>
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_registering_array_types"><a class="anchor" href=" #_registering_array_types"></a><a class="link" href=" #_registering_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.1. </font><font style="vertical-align: inherit;">注册数组类型</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您想要绑定支持的任何 Java 数组元素类型都需要在 Jdbi 的</font></font><code>SqlArrayTypes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册表中注册。</font><font style="vertical-align: inherit;">可以使用以下方式注册 JDBC 驱动程序直接支持的数组类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.registerArrayType(<span class="type">int</span>.class, <span class="string"><span class="delimiter">"</span><span class="content">integer</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里，</font></font><code>"integer"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是 JDBC 驱动程序本身支持的 SQL 类型名称。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
插件喜欢</font></font><code>PostgresPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>H2DatabasePlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动为其各自的数据库注册最常见的数组元素类型。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Postgres 支持枚举数组类型，因此您可以注册一个数组类型，以便
</font><font style="vertical-align: inherit;">在数据库中</font></font><code>enum Colors { red, blue }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>jdbi.registerArrayType(Colors.class, "colors")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where</font></font><code>"colors"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是用户定义的枚举类型名称。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_binding_custom_array_types"><a class="anchor" href=" #_binding_custom_array_types"></a><a class="link" href=" #_binding_custom_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.2. </font><font style="vertical-align: inherit;">绑定自定义数组类型</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以提供自己的实现</font></font><code>SqlArrayType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将自定义 Java 元素类型转换为 JDBC 驱动程序支持的类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">UserArrayType</span> <span class="directive">implements</span> SqlArrayType&lt;User&gt; {<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getTypeName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">integer</span><span class="delimiter">"</span></span>;<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> convertArrayElement(User user) {
        <span class="keyword">return</span> user.getId();<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您现在可以将 的实例绑定</font></font><code>User[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到数据类型的参数</font></font><code>integer[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">User user1 = <span class="keyword">new</span> User(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span>)<font></font>
User user2 = <span class="keyword">new</span> User(<span class="integer">42</span>, <span class="string"><span class="delimiter">"</span><span class="content">alice</span><span class="delimiter">"</span></span>)<font></font>
<font></font>
handle.registerArrayType(<span class="keyword">new</span> UserArrayType());<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into groups (id, user_ids) values (:id, :users)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">users</span><span class="delimiter">"</span></span>, <span class="keyword">new</span> User<span class="type">[]</span> { user1, user2 })<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与</font></font><a href=" #_arguments_registry"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arguments Registry</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一样</font><font style="vertical-align: inherit;">，如果</font></font><code>SqlArrayType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为同一数据类型注册了</font><font style="vertical-align: inherit;">多个</font><font style="vertical-align: inherit;">s，则最后注册的获胜。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_mapping_array_types"><a class="anchor" href=" #_mapping_array_types"></a><a class="link" href=" #_mapping_array_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.3. </font><font style="vertical-align: inherit;">映射数组类型</font></font></a></h4>
<div class="paragraph">
<p><code>SqlArrayType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只允许您将 Java 数组/集合参数绑定到它们的 SQL 对应项。</font><font style="vertical-align: inherit;">要将 SQL 数组列映射回 Java 类型，您可以注册一个常规的</font></font><code>ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserIdColumnMapper</span> <span class="directive">implements</span> ColumnMapper&lt;UserId&gt; {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> UserId map(<span class="predefined-type">ResultSet</span> rs, <span class="type">int</span> col, StatementContext ctx) <span class="directive">throws</span> <span class="exception">SQLException</span> {
        <span class="keyword">return</span> <span class="keyword">new</span> UserId(rs.getInt(col));<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.registerColumnMapper(<span class="keyword">new</span> UserIdColumnMapper());
<span class="predefined-type">List</span>&lt;UserId&gt; userIds = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select user_ids from groups where id = :id</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .mapTo(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;UserId&gt;&gt;() {})<font></font>
      .one();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数组列可以映射到在</font></font><code>JdbiCollectors</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册表中</font><font style="vertical-align: inherit;">注册的任何容器类型
</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如</font></font><code>VARCHAR[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>ImmutableList&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果安装了番石榴插件，则</font><font style="vertical-align: inherit;">a</font><font style="vertical-align: inherit;">可以映射到 an
 </font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_results"><a class="anchor" href=" #_results"></a><a class="link" href=" #_results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9. </font><font style="vertical-align: inherit;">结果</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行数据库查询后，您需要解释结果。</font><font style="vertical-align: inherit;">JDBC 提供了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSet</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类，它可以简单地映射到 Java 原语和内置类，但 API 使用起来通常很麻烦。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供可配置的映射，包括为行和列注册自定义映射器的能力。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甲</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的RowMapper</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个的行转换</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成结果对象。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColumnMapper</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单个列的值转换为Java对象。</font><font style="vertical-align: inherit;">它可以被用来作为一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的RowMapper</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果只有一个本列中，或者它可以被用来构建更复杂</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的RowMapper</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器是根据查询的声明结果类型选择的。</font></font></p>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遍历 ResultSet 中的行，并在一个容器（如</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optional</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iterator ）中</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向您呈现映射的结果</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="directive">final</span> <span class="type">int</span> id;
    <span class="directive">final</span> <span class="predefined-type">String</span> name;<font></font>
<font></font>
    <span class="directive">public</span> User(<span class="type">int</span> id, <span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.id = id;
        <span class="local-variable">this</span>.name = name;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="annotation">@Before</span>
<span class="directive">public</span> <span class="type">void</span> setUp() {<font></font>
    handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE user (id INTEGER PRIMARY KEY AUTO_INCREMENT, name VARCHAR)</span><span class="delimiter">"</span></span>);
    <span class="keyword">for</span> (<span class="predefined-type">String</span> name : <span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Data</span><span class="delimiter">"</span></span>)) {<font></font>
        handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(name) VALUES (?)</span><span class="delimiter">"</span></span>, name);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> findBob() {<font></font>
    User u = findUserById(<span class="integer">2</span>).orElseThrow(() -&gt; <span class="keyword">new</span> <span class="exception">AssertionError</span>(<span class="string"><span class="delimiter">"</span><span class="content">No user found</span><span class="delimiter">"</span></span>));<font></font>
    assertThat(u.id).isEqualTo(<span class="integer">2</span>);<font></font>
    assertThat(u.name).isEqualTo(<span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>);<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> Optional&lt;User&gt; findUserById(<span class="type">long</span> id) {
    <span class="predefined-type">RowMapper</span>&lt;User&gt; userMapper =<font></font>
            (rs, ctx) -&gt; <span class="keyword">new</span> User(rs.getInt(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>), rs.getString(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>));
    <span class="keyword">return</span> handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user WHERE id=:id</span><span class="delimiter">"</span></span>)<font></font>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, id)<font></font>
        .map(userMapper)<font></font>
        .findFirst();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当 Jdbi 消耗所有行来生成结果时，像一个</font></font><code>List&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或单个结果，</font></font><code>ResultSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在返回结果之前将关闭</font><font style="vertical-align: inherit;">底层</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，例如使用 a</font></font><code>Stream&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>Iterable&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果，您</font></font><code>close()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将对结果对象</font><font style="vertical-align: inherit;">负责</font><font style="vertical-align: inherit;">，这会关闭</font></font><code>ResultSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">更喜欢像</font></font><code>use</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>with</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">这样的自动资源管理</font><font style="vertical-align: inherit;">，或使用</font></font><code>try-with-resources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">通常，结束事务或关闭 Handle( </font></font><code>Connection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 将释放所有关联的结果集。</font><font style="vertical-align: inherit;">尝试迭代关闭的结果集是一个错误。</font></font></p>
</div>
<div class="sect3">
<h4 id="_resultbearing"><a class="anchor" href=" #_resultbearing"></a><a class="link" href=" #_resultbearing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.1. </font><font style="vertical-align: inherit;">结果轴承</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口表示结果集的数据库操作中，还没有被映射到任何特定结果类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">去做：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询实现 ResultBearing</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update.executeAndReturnGeneratedKeys() 返回 ResultBearing</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreparedBatch.executeAndReturnGeneratedKeys() 返回 ResultBearing</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以映射 ResultBearing 对象，它返回映射类型的 ResultIterable。</font></font></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mapTo(Type | Class | GenericType) 如果映射器已注册类型</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地图（RowMapper | ColumnMapper）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于 bean 类型的 mapToBean()</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mapToMap() 返回 Map&lt;String,Object&gt; 将小写列名映射到值</font></font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减少行数</font></font></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行视图</font></font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减少结果集</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectInto 例如使用 GenericType 令牌。</font><font style="vertical-align: inherit;">在一个操作中隐含一个 mapTo() 和一个 collect() 。</font><font style="vertical-align: inherit;">例如 collectInto(new GenericType&lt;List&lt;User&gt;&gt;(){}) 与 mapTo(User.class).collect(toList()) 相同</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供开箱即用支持的容器类型列表</font></font></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_resultiterable"><a class="anchor" href=" #_resultiterable"></a><a class="link" href=" #_resultiterable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.2. </font><font style="vertical-align: inherit;">结果可迭代</font></font></a></h4>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultIterable.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultIterable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示已映射到特定类型的结果集，例如
</font></font><code>ResultIterable&lt;User&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">去做：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultIterable.forEach</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultIterable.iterator()</font></font></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须显式关闭，以释放数据库资源。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 try-with-resources 确保数据库资源得到清理。</font><font style="vertical-align: inherit;">*</font></font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_find_a_single_result"><a class="anchor" href=" #_find_a_single_result"></a><a class="link" href=" #_find_a_single_result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找单个结果</font></font></a></h5>
<div class="paragraph">
<p><code>ResultIterable.one()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中唯一的行。</font><font style="vertical-align: inherit;">如果遇到零行或多行，它将抛出</font></font><code>IllegalStateException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><code>ResultIterable.findOne()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><code>Optional&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集中唯一的行，或者</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有返回任何行。</font></font></p>
</div>
<div class="paragraph">
<p><code>ResultIterable.first()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中的第一行。</font><font style="vertical-align: inherit;">如果遇到零行，</font></font><code>IllegalStateException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则抛出。</font></font></p>
</div>
<div class="paragraph">
<p><code>ResultIterable.findFirst()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><code>Optional&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一行的一个，如果有的话。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_stream"><a class="anchor" href=" #_stream"></a><a class="link" href=" #_stream"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">溪流</font></font></a></h5>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">流</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集成允许您使用 RowMapper 将 ResultSet 适配到新的 Java 8 Streams 框架中。</font><font style="vertical-align: inherit;">只要您的数据库支持流式结果（例如，只要您在事务中并设置提取大小，PostgreSQL 就会这样做），流将根据需要从数据库中延迟提取行。</font></font></p>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#stream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stream&lt;T&gt;</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后您应该处理流并产生结果。</font><font style="vertical-align: inherit;">必须关闭此流以释放持有的任何数据库资源，因此我们建议使用</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">useStream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">withStream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">try-with-resources</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块以确保没有资源泄漏。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user ORDER BY id ASC</span><span class="delimiter">"</span></span>)<font></font>
      .map(<span class="keyword">new</span> UserMapper())<font></font>
      .useStream(stream -&gt; {<font></font>
          Optional&lt;<span class="predefined-type">String</span>&gt; first = stream<font></font>
              .filter(u -&gt; u.id &gt; <span class="integer">2</span>)<font></font>
              .map(u -&gt; u.name)<font></font>
              .findFirst();<font></font>
          assertThat(first).contains(<span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>);<font></font>
      });</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#withStream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#useStream</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为您处理关闭流。</font><font style="vertical-align: inherit;">您分别提供一个</font><font style="vertical-align: inherit;">产生结果</font><font style="vertical-align: inherit;">的
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StreamCallback</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或一个</font><font style="vertical-align: inherit;">不</font><font style="vertical-align: inherit;">产生结果的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StreamConsumer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_list"><a class="anchor" href=" #_list"></a><a class="link" href=" #_list"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表</font></font></a></h5>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#list</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发出一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List&lt;T&gt;</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这必然会在内存中缓冲所有结果。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;User&gt; users =<font></font>
    handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT id, name FROM user</span><span class="delimiter">"</span></span>)<font></font>
        .map(<span class="keyword">new</span> UserMapper())<font></font>
        .list();</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_collectors"><a class="anchor" href=" #_collectors"></a><a class="link" href=" #_collectors"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收藏家</font></font></a></h5>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#collect</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Collector&lt;T, ? </font><font style="vertical-align: inherit;">, R&gt;</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建结果集合
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R&lt;T&gt;</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.util.stream.Collectors</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类有一些有趣的
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收藏家</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现下手。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以编写自己的自定义收集器。</font><font style="vertical-align: inherit;">例如，要将找到的行累积到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map 中</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">h.execute(<span class="string"><span class="delimiter">"</span><span class="content">insert into something (id, name) values (1, 'Alice'), (2, 'Bob'), (3, 'Chuckles')</span><span class="delimiter">"</span></span>);
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, Something&gt; users = h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select id, name from something</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(Something.class)<font></font>
    .collect(Collector.of(<span class="predefined-type">HashMap</span>::<span class="keyword">new</span>, (accum, item) -&gt; {<font></font>
        accum.put(item.getId(), item);   <span class="comment">// Each entry is added into an accumulator map</span><font></font>
    }, (l, r) -&gt; {<font></font>
        l.putAll(r);                     <span class="comment">// While jdbi does not process rows in parallel,</span>
        <span class="keyword">return</span> l;                        <span class="comment">// the Collector contract encourages writing combiners.</span>
    }, Characteristics.IDENTITY_FINISH));</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_reduction"><a class="anchor" href=" #_reduction"></a><a class="link" href=" #_reduction"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减少</font></font></a></h5>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#reduce</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供了一个简化的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stream#reduce</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">给定一个身份起始值和一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BiFunction&lt;U, T, U&gt;</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它将反复组合</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直到只剩下一个，然后返回它。</font></font></p>
</div>
</div>
<div class="sect4">
<h5 id="_resultsetscanner"><a class="anchor" href=" #_resultsetscanner"></a><a class="link" href=" #_resultsetscanner"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集扫描器</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSetScanner</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口接受懒惰地提供的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
，并产生结果Jdbi从语句的执行返回。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上大部分操作都是根据</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSetScanner 实现的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Scanner 拥有 ResultSet 的所有权并且可以推进或寻找它。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值最终是语句执行的最终结果。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数用户应该更喜欢使用上面描述的更高级别的结果收集器，但总得有人来做这些肮脏的工作。</font></font></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_joins"><a class="anchor" href=" #_joins"></a><a class="link" href=" #_joins"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9.3. </font><font style="vertical-align: inherit;">加入</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将多个表连接在一起是一项非常常见的数据库任务。</font><font style="vertical-align: inherit;">这也是关系模型和 Java 的对象模型之间的不匹配开始抬头的地方。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里，我们提出了几种从更复杂的行中检索结果的策略。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以联系人列表应用程序为例。</font><font style="vertical-align: inherit;">联系人列表包含任意数量的联系人。</font><font style="vertical-align: inherit;">联系人有姓名和任意数量的电话号码。</font><font style="vertical-align: inherit;">电话号码有类型（例如家庭、工作）和电话号码：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">Contact</span> {
  <span class="predefined-type">Long</span> id;
  <span class="predefined-type">String</span> name;
  <span class="predefined-type">List</span>&lt;Phone&gt; phones = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();<font></font>
<font></font>
  <span class="type">void</span> addPhone(Phone phone) {<font></font>
    phones.add(phone);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="type">class</span> <span class="class">Phone</span> {
  <span class="predefined-type">Long</span> id;
  <span class="predefined-type">String</span> type;
  <span class="predefined-type">String</span> phone;<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为简洁起见，我们省略了 getter、setter 和访问修饰符。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于我们将重用相同的查询，我们现在将它们定义为常量：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">static final String SELECT_ALL = "select contacts.id c_id, name c_name, "<font></font>
    + "phones.id p_id, type p_type, phones.phone p_phone "<font></font>
    + "from contacts left join phones on contacts.id = phones.contact_id "<font></font>
    + "order by c_name, p_type ";<font></font>
<font></font>
static final String SELECT_ONE = SELECT_ALL + "where phones.id = :id";</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，我们提供了别名（例如</font></font><code>c_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>p_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）来区分不同表中具有相同名称 ( </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 的</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了一些不同的 API 来处理连接数据。</font></font></p>
</div>
<div class="sect4">
<h5 id="_resultbearing_reducerows"><a class="anchor" href=" #_resultbearing_reducerows"></a><a class="link" href=" #_resultbearing_reducerows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceRows()</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html#reduceRows-U-java.util.function.BiFunction-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ResultBearing.reduceRows（U，双功能）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法接受一个累加器种子值和lambda函数。</font><font style="vertical-align: inherit;">对于结果集的每一行，Jdbi调用与当前累加器值和拉姆达
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/RowView.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowView</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集的当前行结束。</font><font style="vertical-align: inherit;">每行返回的值成为为下一行传入的输入累加器。</font><font style="vertical-align: inherit;">处理完最后一行后，
</font></font><code>reducedRows()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回从 lambda 返回的最后一个值。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Contact&gt; contacts = handle.createQuery(SELECT_ALL)<font></font>
    .registerRowMapper(BeanMapper.factory(Contact.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>))<font></font>
    .registerRowMapper(BeanMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>)) <i class="conum" data-value="1"></i><b>(1)</b>
    .reduceRows(<span class="keyword">new</span> <span class="predefined-type">LinkedHashMap</span>&lt;<span class="predefined-type">Long</span>, Contact&gt;(), <i class="conum" data-value="2"></i><b>(2)</b><font></font>
                (map, rowView) -&gt; {<font></font>
      Contact contact = map.computeIfAbsent( <i class="conum" data-value="3"></i><b>(3)</b>
          rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">c_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Long</span>.class),<font></font>
          id -&gt; rowView.getRow(Contact.class));<font></font>
<font></font>
      <span class="keyword">if</span> (rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">p_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Long</span>.class) != <span class="predefined-constant">null</span>) { <i class="conum" data-value="4"></i><b>(4)</b><font></font>
        contact.addPhone(rowView.getRow(Phone.class));<font></font>
      }<font></font>
<font></font>
      <span class="keyword">return</span> map; <i class="conum" data-value="5"></i><b>(5)</b><font></font>
    })<font></font>
    .values() <i class="conum" data-value="6"></i><b>(6)</b><font></font>
    .stream()<font></font>
    .collect(toList()); <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code>Contact</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">注册行映射器</font></font><code>Phone</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请注意使用的</font></font><code>"c"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>"p"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参数——这些是列名前缀。</font><font style="vertical-align: inherit;">通过与前缀注册映射器，该</font></font><code>Contact</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器将只映射</font></font><code>c_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>c_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
列，而</font></font><code>Phone</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器将只映射</font></font><code>p_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>p_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
</font></font><code>p_phone</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用空的</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/util/LinkedHashMap.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkedHashMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作为累加器种子，由联系人 ID 映射。</font></font><code>LinkedHashMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在选择多个主记录时是一个很好的累加器，因为它具有快速存储和查找，同时保留插入顺序（这有助于遵守
</font></font><code>ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款）。</font><font style="vertical-align: inherit;">如果排序不重要，a</font></font><code>HashMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也足够了。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"></font><code>Contact</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们已经有了，则从累加器</font><font style="vertical-align: inherit;">加载</font><font style="vertical-align: inherit;">；</font><font style="vertical-align: inherit;">否则，通过</font></font><code>RowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><code>p_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列不为空，则从当前行加载电话号码并将其添加到当前联系人。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回输入地图（现在有一个额外的联系人和/或电话）作为下一行的累加器。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此时，所有行都已读入内存，我们不需要联系人 ID 密钥。</font><font style="vertical-align: inherit;">所以我们打电话</font></font><code>Map.values()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来获取一个</font></font><code>Collection&lt;Contact&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将联系人收集到一个</font></font><code>List&lt;Contact&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html#reduceRows-org.jdbi.v3.core.result.RowReducer-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceRows(RowReducer)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
变体接受</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/RowReducer.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowReducer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回减少元素的流。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于简单的主从连接，
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html#reduceRows-java.util.function.BiConsumer-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceRows(BiConsumer&lt;Map&lt;K,V&gt;,RowView&gt;)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法可以轻松地将这些连接简化为主元素流。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改上面的例子：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Contact&gt; contacts = handle.createQuery(SELECT_ALL)<font></font>
    .registerRowMapper(BeanMapper.factory(Contact.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>))<font></font>
    .registerRowMapper(BeanMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>))<font></font>
    .reduceRows((<span class="predefined-type">Map</span>&lt;<span class="predefined-type">Long</span>, Contact&gt; map, RowView rowView) -&gt; { <i class="conum" data-value="1"></i><b>(1)</b><font></font>
      Contact contact = map.computeIfAbsent(<font></font>
          rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">c_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Long</span>.class),<font></font>
          id -&gt; rowView.getRow(Contact.class));<font></font>
<font></font>
      <span class="keyword">if</span> (rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">p_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Long</span>.class) != <span class="predefined-constant">null</span>) {<font></font>
        contact.addPhone(rowView.getRow(Phone.class));<font></font>
      }<font></font>
      <i class="conum" data-value="2"></i><b>(2)</b><font></font>
    })<font></font>
    .collect(toList()); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lambda 接收将存储结果对象的映射，以及一个
</font></font><code>RowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">映射是 a </font></font><code>LinkedHashMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此结果流将按照插入的顺序生成结果对象。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不需要</font></font><code>return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明。</font></font><code>map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每一行都重复使用</font><font style="vertical-align: inherit;">相同的</font><font style="vertical-align: inherit;">内容。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个</font></font><code>reduceRows()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用产生 a </font></font><code>Stream&lt;Contact&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(即 from
 </font></font><code>map.values().stream()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。在这个例子中，我们将元素收集到一个列表中，但我们可以</font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font><font style="vertical-align: inherit;">调用任何</font><font style="vertical-align: inherit;">方法。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能想知道</font></font><code>getRow()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>getColumn()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font></font><code>rowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">当您调用 时</font></font><code>rowView.getRow(SomeType.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>RowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找已注册的行映射器</font></font><code>SomeType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并使用它来将当前行映射到一个
</font></font><code>SomeType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，当您调用 时</font></font><code>rowView.getColumn("my_value", MyValueType.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
</font></font><code>RowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找已注册的列映射器</font></font><code>MyValueType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并使用它来</font></font><code>my_value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将当前行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">映射</font><font style="vertical-align: inherit;">到一个</font></font><code>MyValueType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在让我们做同样的事情，但对于单个联系人：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Optional&lt;Contact&gt; contact = handle.createQuery(SELECT_ONE)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, contactId)<font></font>
    .registerRowMapper(BeanMapper.factory(Contact.class, <span class="string"><span class="delimiter">"</span><span class="content">c</span><span class="delimiter">"</span></span>))<font></font>
    .registerRowMapper(BeanMapper.factory(Phone.class, <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>))<font></font>
    .reduceRows(LinkedHashMapRowReducer.&lt;<span class="predefined-type">Long</span>, Contact&gt; of((map, rowView) -&gt; {<font></font>
      Contact contact = map.orElseGet(() -&gt; rowView.getRow(Contact.class));<font></font>
<font></font>
      <span class="keyword">if</span> (rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">p_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Long</span>.class) != <span class="predefined-constant">null</span>) {<font></font>
        contact.addPhone(rowView.getRow(Phone.class));<font></font>
      }<font></font>
    })<font></font>
    .findFirst();</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_resultbearing_reduceresultset"><a class="anchor" href=" #_resultbearing_reduceresultset"></a><a class="link" href=" #_resultbearing_reduceresultset"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceResultSet()</font></font></a></h5>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultBearing.html#reduceResultSet-U-org.jdbi.v3.core.result.ResultSetAccumulator-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceResultSet()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是一个类似于 的低级 API </font></font><code>reduceRows()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，除了它提供对 JDBC 的直接访问，</font></font><code>ResultSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是</font></font><code>RowView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每一行提供一个。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与 相比</font></font><code>reduceRows()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">此方法可以提供更优越的性能</font><font style="vertical-align: inherit;">，但代价是冗长：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Contact&gt; contacts = handle.createQuery(SELECT_ALL)<font></font>
    .reduceResultSet(<span class="keyword">new</span> <span class="predefined-type">LinkedHashMap</span>&lt;<span class="predefined-type">Long</span>, Contact&gt;(),<font></font>
                     (acc, resultSet, ctx) -&gt; {<font></font>
      <span class="type">long</span> contactId = resultSet.getLong(<span class="string"><span class="delimiter">"</span><span class="content">c_id</span><span class="delimiter">"</span></span>);<font></font>
      Contact contact;<font></font>
      <span class="keyword">if</span> (acc.containsKey(contactId)) {<font></font>
        contact = acc.get(contactId);<font></font>
      } <span class="keyword">else</span> {<font></font>
        contact = <span class="keyword">new</span> Contact();<font></font>
        acc.put(contactId,contact);<font></font>
        contact.setId(contactId);<font></font>
        contact.setName(resultSet.getString(<span class="string"><span class="delimiter">"</span><span class="content">c_name</span><span class="delimiter">"</span></span>);<font></font>
      }<font></font>
<font></font>
      <span class="type">long</span> phoneId = resultSet.getLong(<span class="string"><span class="delimiter">"</span><span class="content">p_id</span><span class="delimiter">"</span></span>);
      <span class="keyword">if</span> (!resultSet.wasNull()) {<font></font>
        Phone phone = <span class="keyword">new</span> Phone();<font></font>
        phone.setId(phoneId);<font></font>
        phone.setType(resultSet.getString(<span class="string"><span class="delimiter">"</span><span class="content">p_type</span><span class="delimiter">"</span></span>);<font></font>
        phone.setPhone(resultSet.getString(<span class="string"><span class="delimiter">"</span><span class="content">p_phone</span><span class="delimiter">"</span></span>);<font></font>
        contact.addPhone(phone);<font></font>
      }<font></font>
<font></font>
      <span class="keyword">return</span> acc;<font></font>
    })<font></font>
    .values()<font></font>
    .stream()<font></font>
    .collect(toList());</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_joinrowmapper"><a class="anchor" href=" #_joinrowmapper"></a><a class="link" href=" #_joinrowmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加入行映射器</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JoinRowMapper 使用一组类型从每一行中提取。</font><font style="vertical-align: inherit;">它使用映射注册表来确定如何映射每个给定类型，并向您提供一个 JoinRow，其中包含所有结果值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们考虑两个简单的类型，用户和文章，有一个名为 Author 的连接表。</font><font style="vertical-align: inherit;">Guava 提供了一个 Multimap 类，它对于表示这样的连接表非常方便。</font><font style="vertical-align: inherit;">假设我们已经注册了映射器：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">h.registerRowMapper(ConstructorMapper.factory(User.class));<font></font>
h.registerRowMapper(ConstructorMapper.factory(Article.class));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，我们可以使用数据库中的映射轻松填充 Multimap：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Multimap&lt;User, Article&gt; joined = HashMultimap.create();<font></font>
h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user NATURAL JOIN author NATURAL JOIN article</span><span class="delimiter">"</span></span>)<font></font>
    .map(JoinRowMapper.forTypes(User.class, Article.class))<font></font>
    .forEach(jr -&gt; joined.put(jr.get(User.class), jr.get(Article.class)));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
虽然这种方法易于读写，但对于某些数据模式可能效率低下。</font><font style="vertical-align: inherit;">在决定是使用高级映射还是使用手写映射器进行更直接的低级访问时，请考虑性能要求。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以将它与 SqlObject 一起使用：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserArticleDao</span> {
    <span class="annotation">@RegisterJoinRowMapper</span>({User.class, Article.class})
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM user NATURAL JOIN author NATURAL JOIN article</span><span class="delimiter">"</span></span>)<font></font>
    Stream&lt;JoinRow&gt; getAuthorship();<font></font>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Multimap&lt;User, Article&gt; joined = HashMultimap.create();<font></font>
<font></font>
handle.attach(UserArticleDao.class)<font></font>
        .getAuthorship()<font></font>
        .forEach(jr -&gt; joined.put(jr.get(User.class), jr.get(Article.class)));<font></font>
<font></font>
assertThat(joined).isEqualTo(JoinRowMapperTest.getExpected());</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updates"><a class="anchor" href=" #_updates"></a><a class="link" href=" #_updates"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.10. </font><font style="vertical-align: inherit;">更新</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新是返回整数行修改的操作，例如数据库</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DELETE</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以使用</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'s</font></font><code>int execute(String sql, Object…​ args)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法</font><font style="vertical-align: inherit;">执行简单的更新，</font><font style="vertical-align: inherit;">该方法绑定了简单的位置参数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">count = handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES(?, ?)</span><span class="delimiter">"</span></span>, <span class="integer">4</span>, <span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>);<font></font>
assertThat(count).isEqualTo(<span class="integer">1</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要进一步自定义，请使用</font></font><code>createUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> count = handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES(:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">3</span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>)<font></font>
    .execute();<font></font>
assertThat(count).isEqualTo(<span class="integer">1</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新可能会返回</font></font><a href=" #_generated_keys"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成的密钥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是结果计数。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_batches"><a class="anchor" href=" #_batches"></a><a class="link" href=" #_batches"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.11. </font><font style="vertical-align: inherit;">批次</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甲</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发送许多命令以散装服务器。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开批处理后，重复 add 语句，并调用</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Batch batch = handle.createBatch();<font></font>
<font></font>
batch.add(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO fruit VALUES(0, 'apple')</span><span class="delimiter">"</span></span>);<font></font>
batch.add(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO fruit VALUES(1, 'banana')</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
<span class="type">int</span><span class="type">[]</span> rowsModified = batch.execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句被批量发送到数据库，但每个语句是单独执行的。</font><font style="vertical-align: inherit;">没有参数。</font><font style="vertical-align: inherit;">每个语句都返回一个修改计数，就像更新一样，然后这些计数在</font></font><code>int[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数组中</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在一般情况下，所有元素都是</font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_prepared_batches"><a class="anchor" href=" #_prepared_batches"></a><a class="link" href=" #_prepared_batches"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.12. </font><font style="vertical-align: inherit;">准备批次</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreparedBatch</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发送一个语句将服务器与许多参数设置。</font><font style="vertical-align: inherit;">该语句被重复执行，对</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到其中的</font><font style="vertical-align: inherit;">每批参数执行一次</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果再次是</font></font><code>int[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改后的行数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PreparedBatch batch = handle.prepareBatch(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user(id, name) VALUES(:id, :name)</span><span class="delimiter">"</span></span>);
<span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">100</span>; i &lt; <span class="integer">5000</span>; i++) {<font></font>
    batch.bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, i).bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">User:</span><span class="delimiter">"</span></span> + i).add();<font></font>
}<font></font>
<span class="type">int</span><span class="type">[]</span> counts = batch.execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlObject 还支持批量插入：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testSqlObjectBatch() {<font></font>
    BasketOfFruit basket = handle.attach(BasketOfFruit.class);<font></font>
<font></font>
    <span class="type">int</span><span class="type">[]</span> rowsModified = basket.fillBasket(<span class="predefined-type">Arrays</span>.asList(
            <span class="keyword">new</span> Fruit(<span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">apple</span><span class="delimiter">"</span></span>),
            <span class="keyword">new</span> Fruit(<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">banana</span><span class="delimiter">"</span></span>)));<font></font>
<font></font>
    assertThat(rowsModified).containsExactly(<span class="integer">1</span>, <span class="integer">1</span>);<font></font>
    assertThat(basket.countFruit()).isEqualTo(<span class="integer">2</span>);<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BasketOfFruit</span> {
    <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO fruit VALUES(:id, :name)</span><span class="delimiter">"</span></span>)
    <span class="type">int</span><span class="type">[]</span> fillBasket(<span class="annotation">@BindBean</span> <span class="predefined-type">Collection</span>&lt;Fruit&gt; fruits);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT count(1) FROM fruit</span><span class="delimiter">"</span></span>)
    <span class="type">int</span> countFruit();<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
批处理显着提高了重复单条语句执行的效率，但许多数据库也不能很好地处理非常大的批处理。</font><font style="vertical-align: inherit;">使用您的数据库配置进行测试，但通常应将极大的数据集分割并提交——否则可能会使您的数据库瘫痪。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_exception_rewriting"><a class="anchor" href=" #_exception_rewriting"></a><a class="link" href=" #_exception_rewriting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.12.1. </font><font style="vertical-align: inherit;">异常重写</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JDBC SQLException 类非常古老，并且早于更现代的异常工具，如 Throwable 的抑制异常。</font><font style="vertical-align: inherit;">当一个批次失败时，可能会报告多个失败，这无法用当天的基本异常类型来表示。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所以 SQLException 有一个定制的
</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html#getNextException--" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getNextException</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
链来表示批处理失败的原因。</font><font style="vertical-align: inherit;">不幸的是，默认情况下，大多数日志库不会打印出这些异常，而是将它们的处理推入您的代码中。</font><font style="vertical-align: inherit;">忘记处理这种情况并最终得到的日志除了</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">java.sql.BatchUpdateException: Batch entry 1 insert into something (id, name) values (0, '') was aborted. Call getNextException to see the cause.</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将尝试将此类 nextExceptions 重写为“抑制异常”（Java 8 中的新功能），以便您的日志更有帮助：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">java.sql.BatchUpdateException: Batch entry 1 insert into something (id, name) values (0, 'Keith') was aborted. Call getNextException to see the cause.<font></font>
Suppressed: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "something_pkey"<font></font>
  Detail: Key (id)=(0) already exists.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generated_keys"><a class="anchor" href=" #_generated_keys"></a><a class="link" href=" #_generated_keys"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.13. </font><font style="vertical-align: inherit;">生成的密钥</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update 或 PreparedBatch 可以自动生成密钥。</font><font style="vertical-align: inherit;">这些键与正常结果分开处理。</font><font style="vertical-align: inherit;">根据您的数据库和配置，整个插入行可能可用。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，支持此功能的数据库之间存在很多差异，因此请彻底测试此功能与您的数据库的交互。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 PostgreSQL 中，整行都可用，因此您可以立即将插入的名称映射回完整的 User 对象！</font><font style="vertical-align: inherit;">这避免了插入完成后单独查询的开销。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑下表：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="directive">final</span> <span class="type">int</span> id;
    <span class="directive">final</span> <span class="predefined-type">String</span> name;<font></font>
<font></font>
    <span class="directive">public</span> User(<span class="type">int</span> id, <span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.id = id;
        <span class="local-variable">this</span>.name = name;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="annotation">@Before</span>
<span class="directive">public</span> <span class="type">void</span> setUp() {<font></font>
    db.useHandle(h -&gt; h.execute(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE users (id SERIAL PRIMARY KEY, name VARCHAR)</span><span class="delimiter">"</span></span>));<font></font>
    db.registerRowMapper(ConstructorMapper.factory(User.class));<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以以流畅的方式获取生成的密钥：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> fluentInsertKeys() {<font></font>
    db.useHandle(handle -&gt; {<font></font>
        User data = handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO users (name) VALUES(?)</span><span class="delimiter">"</span></span>)<font></font>
                .bind(<span class="integer">0</span>, <span class="string"><span class="delimiter">"</span><span class="content">Data</span><span class="delimiter">"</span></span>)<font></font>
                .executeAndReturnGeneratedKeys()<font></font>
                .mapTo(User.class)<font></font>
                .one();<font></font>
<font></font>
        assertEquals(<span class="integer">1</span>, data.id); <span class="comment">// This value is generated by the database</span>
        assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Data</span><span class="delimiter">"</span></span>, data.name);<font></font>
    });<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stored_procedure_calls"><a class="anchor" href=" #_stored_procedure_calls"></a><a class="link" href=" #_stored_procedure_calls"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.14. </font><font style="vertical-align: inherit;">存储过程调用</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用数据库存储过程。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们假设一个现有的存储过程作为示例：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">FUNCTION</span> <span class="class">add</span>(a <span class="keyword">IN</span> <span class="predefined-type">INT</span>, b <span class="keyword">IN</span> <span class="predefined-type">INT</span>, <span class="predefined">sum</span> OUT <span class="predefined-type">INT</span>) <span class="keyword">AS</span> <span class="error">$</span><span class="error">$</span>
<span class="class">BEGIN</span>
  <span class="predefined">sum</span> := a + b;
<span class="keyword">END</span>;
<span class="error">$</span><span class="error">$</span> LANGUAGE plpgsql</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下面是调用存储过程的方法：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OutParameters result = handle<font></font>
        .createCall(<span class="string"><span class="delimiter">"</span><span class="content">{:sum = call add(:a, :b)}</span><span class="delimiter">"</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">a</span><span class="delimiter">"</span></span>, <span class="integer">13</span>) <i class="conum" data-value="2"></i><b>(2)</b>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">b</span><span class="delimiter">"</span></span>, <span class="integer">9</span>) <i class="conum" data-value="2"></i><b>(2)</b>
        .registerOutParameter(<span class="string"><span class="delimiter">"</span><span class="content">sum</span><span class="delimiter">"</span></span>, <span class="predefined-type">Types</span>.INTEGER)  <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="4"></i><b>(4)</b>
        .invoke(); <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"></font><code>Handle.createCall()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 SQL 语句</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请注意，JDBC 在调用存储过程时具有特殊的 SQL 格式，我们必须遵循该格式。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将输入参数绑定到过程调用。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册输出参数，即将从存储过程调用返回的值。</font><font style="vertical-align: inherit;">这告诉 JDBC 期望每个输出参数的数据类型。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果 SQL 使用位置参数，则输出参数可以按名称（如示例所示）或从零开始的索引进行注册。</font><font style="vertical-align: inherit;">可以注册多个输出参数，具体取决于存储过程本身的输出。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，调用</font></font><code>invoke()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行程序。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用存储过程会返回一个
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/OutParameters.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OutParameters</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，该对象包含从存储过程调用返回的值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在我们可以从中提取结果</font></font><code>OutParameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> sum = result.getInt(<span class="string"><span class="delimiter">"</span><span class="content">sum</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将打开的游标作为类似结果的对象返回，方法是将其声明为</font></font><code>Types.REF_CURSOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后通过</font></font><code>OutParameters.getRowSet()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">通常这必须在事务中完成，并且必须在关闭语句之前通过使用</font></font><code>Call.invoke(Consumer)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or</font></font><code>Call.invoke(Function)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回调样式</font><font style="vertical-align: inherit;">处理它来消耗结果</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于 JDBC 中的设计限制，可用的参数数据类型</font></font><code>OutParameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅限于 JDBC 直接支持的那些类型。</font><font style="vertical-align: inherit;">这不能通过例如映射器注册来扩展。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_scripts"><a class="anchor" href=" #_scripts"></a><a class="link" href=" #_scripts"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.15. </font><font style="vertical-align: inherit;">脚本</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脚本</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">把字符串到分号结束语句。</font><font style="vertical-align: inherit;">这些语句可以在单个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批处理中</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或单独执行。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span><span class="type">[]</span> results = handle.createScript(
        <span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO user VALUES(3, 'Charlie');</span><span class="delimiter">"</span></span>
        + <span class="string"><span class="delimiter">"</span><span class="content">UPDATE user SET name='Bobby Tables' WHERE id=2;</span><span class="delimiter">"</span></span>)<font></font>
    .execute();<font></font>
<font></font>
assertThat(results).containsExactly(<span class="integer">1</span>, <span class="integer">1</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactions"><a class="anchor" href=" #_transactions"></a><a class="link" href=" #_transactions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.16. </font><font style="vertical-align: inherit;">交易</font></font></a></h3>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全支持 JDBC 事务。</font></font></p>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">句柄</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象提供了两种打开事务的方式 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">——inTransaction</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
允许您返回结果，而</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">useTransaction</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有返回值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两者都允许您选择指定事务隔离级别。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Optional&lt;User&gt; findUserById(<span class="type">long</span> id) {
    <span class="keyword">return</span> handle.inTransaction(h -&gt;<font></font>
            h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM users WHERE id=:id</span><span class="delimiter">"</span></span>)<font></font>
                    .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, id)<font></font>
                    .mapTo(User.class)<font></font>
                    .findFirst());<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里，我们（可能没有必要）</font><font style="vertical-align: inherit;">用事务</font><font style="vertical-align: inherit;">保护一个简单的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，Handle 有许多用于直接事务管理的方法：begin()、savepoint()、rollback()、commit() 等。通常，您不需要使用这些方法。</font><font style="vertical-align: inherit;">如果您没有明确提交手动打开的事务，它将被回滚。</font></font></p>
</div>
<div class="sect3">
<h4 id="_serializable_transactions"><a class="anchor" href=" #_serializable_transactions"></a><a class="link" href=" #_serializable_transactions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.16.1. </font><font style="vertical-align: inherit;">可序列化事务</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于更高级的查询，有时需要可序列化的事务。
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包括一个事务运行器，它能够重试由于序列化失败而中止的事务。</font><font style="vertical-align: inherit;">重要的是您的交易没有副作用，因为它可能会被执行多次。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Automatically rerun transactions</span>
db.setTransactionHandler(<span class="keyword">new</span> SerializableTransactionRunner());<font></font>
<font></font>
<span class="comment">// Set up some values</span>
BiConsumer&lt;Handle, <span class="predefined-type">Integer</span>&gt; insert = (h, i) -&gt; h.execute(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO ints(value) VALUES(?)</span><span class="delimiter">"</span></span>, i);<font></font>
handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE ints (value INTEGER)</span><span class="delimiter">"</span></span>);<font></font>
insert.accept(handle, <span class="integer">10</span>);<font></font>
insert.accept(handle, <span class="integer">20</span>);<font></font>
<font></font>
<span class="comment">// Run the following twice in parallel, and synchronize</span>
<span class="predefined-type">ExecutorService</span> executor = <span class="predefined-type">Executors</span>.newCachedThreadPool();
<span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">2</span>);<font></font>
<font></font>
<span class="predefined-type">Callable</span>&lt;<span class="predefined-type">Integer</span>&gt; sumAndInsert = () -&gt;<font></font>
    db.inTransaction(TransactionIsolationLevel.SERIALIZABLE, h -&gt; {<font></font>
        <span class="comment">// Both read initial state of table</span>
        <span class="type">int</span> sum = h.select(<span class="string"><span class="delimiter">"</span><span class="content">SELECT sum(value) FROM ints</span><span class="delimiter">"</span></span>).mapTo(<span class="type">int</span>.class).one();<font></font>
<font></font>
        <span class="comment">// First time through, make sure neither transaction writes until both have read</span><font></font>
        latch.countDown();<font></font>
        latch.await();<font></font>
<font></font>
        <span class="comment">// Now do the write.</span><font></font>
        insert.accept(h, sum);<font></font>
        <span class="keyword">return</span> sum;<font></font>
    });<font></font>
<font></font>
<span class="comment">// Both of these would calculate 10 + 20 = 30, but that violates serialization!</span>
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">Integer</span>&gt; result1 = executor.submit(sumAndInsert);
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">Integer</span>&gt; result2 = executor.submit(sumAndInsert);<font></font>
<font></font>
<span class="comment">// One of the transactions gets 30, the other will abort and automatically rerun.</span>
<span class="comment">// On the second attempt it will compute 10 + 20 + 30 = 60, seeing the update from its sibling.</span>
<span class="comment">// This assertion fails under any isolation level below SERIALIZABLE!</span>
assertThat(result1.get() + result2.get()).isEqualTo(<span class="integer">30</span> + <span class="integer">60</span>);<font></font>
<font></font>
executor.shutdown();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上面的测试旨在在锁定步骤中运行两个事务。</font><font style="vertical-align: inherit;">每个尝试读取表中所有行的总和，然后插入具有该总和的新行。</font><font style="vertical-align: inherit;">我们用值 10 和 20 为表设置种子。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有可串行化隔离，每个事务读取10和20，然后返回30。最终结果是30 + 30 = 60，这不对应任何事务的串行执行！</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用可序列化隔离，两个事务之一被强制中止并重试。</font><font style="vertical-align: inherit;">在第二次循环中，它计算出 10 + 20 + 30 = 60。从另一个加上 30，我们得到 30 + 60 = 90，断言成功。</font></font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metadata"><a class="anchor" href=" #_metadata"></a><a class="link" href=" #_metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.17. </font><font style="vertical-align: inherit;">元数据</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 允许通过</font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Handle.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;">Handle</font></a></font><code>queryMetadata</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的方法</font><font style="vertical-align: inherit;">访问数据库元数据</font><font style="vertical-align: inherit;">。</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Handle.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用方法引用直接查询简单值：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> url = h.queryMetadata(<span class="predefined-type">DatabaseMetaData</span>::getURL);
<span class="type">boolean</span> supportsTransactions = h.queryMetadata(<span class="predefined-type">DatabaseMetaData</span>::supportsTransactions);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/DatabaseMetaData.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DatabaseMetaData</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的许多方法</font><font style="vertical-align: inherit;">返回一个</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些可以与</font></font><code>queryMetadata</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><a href=" #_resultbearing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">一起使用</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有 JDBI</font></font><a href=" #_row_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器</font><font style="vertical-align: inherit;">和</font></font><a href=" #_column_mappers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器都可用于映射这些结果：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; catalogNames = h.queryMetadata(<span class="predefined-type">DatabaseMetaData</span>::getCatalogs)<font></font>
            .mapTo(<span class="predefined-type">String</span>.class)<font></font>
            .list();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href=" #_configuration"></a><a class="link" href=" #_configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. 配置</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">旨在以最少的配置开箱即用。</font><font style="vertical-align: inherit;">有时您需要更改默认行为，或添加扩展以处理其他数据库类型。</font><font style="vertical-align: inherit;">每一个希望参与配置的核心或扩展都定义了一个配置类，例如</font></font><code>SqlStatements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该类存储了SqlStatement相关的配置。</font><font style="vertical-align: inherit;">然后，在任何</font></font><code>Configurable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上下文（如 a</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中，您都可以以类型安全的方式更改配置：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.getConfig(SqlStatements.class).setUnusedBindingAllowed(<span class="predefined-constant">true</span>);<font></font>
jdbi.getConfig(Arguments.class).register(<span class="keyword">new</span> MyTypeArgumentFactory());<font></font>
jdbi.getConfig(Handles.class).setForceEndTransactions(<span class="predefined-constant">true</span>);<font></font>
<font></font>
<span class="comment">// Or, if you have a bunch of work to do:</span><font></font>
jdbi.configure(RowMappers.class, rm -&gt; {<font></font>
    rm.register(<span class="keyword">new</span> TypeARowMapperFactory();<font></font>
    rm.register(<span class="keyword">new</span> TypeBRowMapperFactory();<font></font>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，您应该在与数据库交互之前完成所有配置更改。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建新上下文时，它会在创建时继承父上下文配置的副本。</font><font style="vertical-align: inherit;">所以 a</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从创建初始化它的配置</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但更改永远不会传播回来。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更高级的实现细节，</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_jdbiconfig"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JdbiConfig</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="sect2">
<h3 id="_qualified_types"><a class="anchor" href=" #_qualified_types"></a><a class="link" href=" #_qualified_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1. </font><font style="vertical-align: inherit;">合格类型</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时，同一个 Java 对象可以对应数据库中的多种数据类型。</font><font style="vertical-align: inherit;">例如，a</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是</font></font><code>varchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">纯文本、</font></font><code>nvarchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本、</font></font><code>json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据等，所有这些都有不同的处理要求。</font></font></p>
</div>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/qualifier/QualifiedType.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QualifiedType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您将此类上下文添加到 Java 类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">QualifiedType.of(<span class="predefined-type">String</span>.class).with(Json.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这</font></font><code>QualifiedType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍然代表</font></font><code>String</code> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但</font><font style="vertical-align: inherit;">用</font><font style="vertical-align: inherit;">注释</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限定</font></font></em><font style="vertical-align: inherit;"></font><code>@Json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以以类似于</font></font><a href=" #_generictype"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的方式使用</font><font style="vertical-align: inherit;">，使组件处理值（主要是</font></font><code>ArgumentFactories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>ColumnMapperFactories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）以不同的方式执行它们的工作，并使值完全由不同的实现处理：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Json</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JsonArgumentFactory</span> <span class="directive">extends</span> AbstractArgumentFactory&lt;<span class="predefined-type">String</span>&gt; {
    <span class="annotation">@Override</span>
    <span class="directive">protected</span> Argument build(<span class="predefined-type">String</span> value, ConfigRegistry config) {
        <span class="comment">// do something specifically for json data</span><font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦注册，这个</font></font><code>@Json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合格的工厂将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只</font></font></strong> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收到</font></font><code>@Json String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">其他工厂</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资格这样将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收到此值：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">QualifiedType&lt;<span class="predefined-type">String</span>&gt; json = QualifiedType.of(<span class="predefined-type">String</span>.class).with(Json.class);<font></font>
query.bindByType(<span class="string"><span class="delimiter">"</span><span class="content">jsonValue</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">{</span><span class="char">\"</span><span class="content">foo</span><span class="char">\"</span><span class="content">:1}</span><span class="delimiter">"</span></span>, json);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jdbi 选择工厂通过</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确匹配</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它们的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限定符</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来处理值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">之后由工厂实现来区</font><font style="vertical-align: inherit;">分值</font><font style="vertical-align: inherit;">的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
限定符实现为</font></font><code>Annotations</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">这允许工厂在源头独立检查限定符的值，例如在他们的</font></font><code>Class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，改变他们自己的行为或</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重新</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限定</font><font style="vertical-align: inherit;">一个值并让它由 Jdbi 的查找链重新评估。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
预选赛被标注并</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意味着放在源类时，他们本质上激活它们的功能。</font><font style="vertical-align: inherit;">每个功能都有自己的使用规则。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参数只能通过</font></font><code>bindByType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">进行绑定</font><font style="vertical-align: inherit;">，而不是常规
</font></font><code>bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>update.execute(Object…​)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">此外，数组不能被限定。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些功能目前使用限定类型：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@NVarchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>@MacAddr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（后者在</font></font><code>jdbi3-postgres</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中</font><font style="vertical-align: inherit;">
分别</font><font style="vertical-align: inherit;">将字符串绑定和映射为</font></font><code>nvarchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>macaddr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是通常的</font></font><code>varchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</li>
<li>
<p><code>jdbi3-postgres</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供</font></font><a href=" #_hstore"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HStore</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><a href=" #jdbi3-json"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON</font></font></a></p>
</li>
<li>
<p><code>BeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>@RegisterBeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>mapTobean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重 getter、setter 和 setter 参数的限定符。</font></font></p>
</li>
<li>
<p><code>ConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>@RegisterConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重构造函数参数的限定符。</font></font></p>
</li>
<li>
<p><code>@BindMethods</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>bindMethods()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重方法的限定符。</font></font></p>
</li>
<li>
<p><code>@BindFields</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>@RegisterFieldMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>FieldMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>bindFields()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重字段上的限定符。</font></font></p>
</li>
<li>
<p><code>SqlObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 尊重方法的限定符（将它们应用于返回类型）和参数。</font></font></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在类型参数上</font></font><code>Consumer&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，限定符应用于</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>@MapTo</code></p>
</li>
<li>
<p><code>@BindJpa</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>JpaMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重 getter 和 setter 的限定符。</font></font></p>
</li>
<li>
<p><code>@BindKotlin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>bindKotlin()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>KotlinMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尊重构造函数参数、getter、setter 和 setter 参数上的限定符。</font></font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sql_objects"><a class="anchor" href=" #_sql_objects"></a><a class="link" href=" #_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. SQL 对象</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象是流利风格的核心 API 的声明式替代品。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要开始使用 SQL Object 插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-sqlobject<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = ...<font></font>
jdbi.installPlugin(<span class="keyword">new</span> SqlObjectPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 SQL Object，您可以声明一个公共接口，为每个数据库操作添加方法，并指定要执行的 SQL 语句。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以通过以下两种方式之一指定每种方法的作用：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 SQL 方法注释对方法进行注释。</font><font style="vertical-align: inherit;">Jdbi 提供了四种开箱即用的注释（更新、查询、存储过程调用和批处理）。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将该方法声明为 Java 8</font></font><code>default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法，并在方法主体中提供您自己的实现。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在运行时，您可以请求接口的实例，Jdbi 会根据您声明的注释和方法合成一个实现。</font></font></p>
</div>
<div class="sect2">
<h3 id="_annotated_methods"><a class="anchor" href=" #_annotated_methods"></a><a class="link" href=" #_annotated_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1. </font><font style="vertical-align: inherit;">注释方法</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 Jdbi 的 SQL 方法注释（</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/statement/SqlBatch.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@SqlBatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/statement/SqlCall.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@SqlCall</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/statement/SqlQuery.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@SqlQuery</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/statement/SqlUpdate.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@SqlUpdate</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）之一注释的方法会根据方法上的注释及其参数自动生成其实现。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法的参数用作语句的参数，并将 SQL 语句结果映射到方法返回类型。</font></font></p>
</div>
<div class="sect3">
<h4 id="_sqlupdate"><a class="anchor" href=" #_sqlupdate"></a><a class="link" href=" #_sqlupdate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.1. </font><font style="vertical-align: inherit;">@SqlUpdate</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释用于修改数据的操作（即插入、更新、删除）。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (?, ?)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> insert(<span class="type">long</span> id, <span class="predefined-type">String</span> name);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法参数</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在各自位置</font><font style="vertical-align: inherit;">绑定到</font><font style="vertical-align: inherit;">SQL 语句中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">标记。</font><font style="vertical-align: inherit;">因此</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定到第一个</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二个。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还可用于 DDL（数据定义语言）操作，如创建或更改表。</font><font style="vertical-align: inherit;">我们建议使用模式迁移工具，如</font></font><a href="https://flywaydb.org/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迁徙路线</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
</font></font><a href="http://www.liquibase.org/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liquibase</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保持你的数据库模式。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，一个</font></font><code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可能会返回一些类型：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: 不返回任何内容（显然）</font></font></p>
</li>
<li>
<p><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回更新计数。</font><font style="vertical-align: inherit;">根据数据库供应商和 JDBC 驱动程序，这可能是更改的行数，也可能是查询匹配的数量（无论是否更改了任何数据）。</font></font></p>
</li>
<li>
<p><code>boolean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: 如果更新计数大于零，则返回 true。</font></font></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_getgeneratedkeys"><a class="anchor" href=" #_getgeneratedkeys"></a><a class="link" href=" #_getgeneratedkeys"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">某些 SQL 语句将导致代表您在数据库中生成数据，例如具有自动生成的主键的表，或从序列中选择的主键。</font><font style="vertical-align: inherit;">我们需要一种方法来从数据库中检索这些生成的值。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据库对生成的密钥的支持各不相同。</font><font style="vertical-align: inherit;">有些支持每个语句只生成一个键列，有些（例如 Postgres）可以返回整行。</font><font style="vertical-align: inherit;">在依赖此行为之前，您应该检查您的数据库供应商的文档。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@GetGeneratedKeys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解告诉Jdbi返回值应该生成从SQL语句的关键，而不是更新计数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (nextval('user_seq'), ?)</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>)
  <span class="type">long</span> insert(<span class="predefined-type">String</span> name);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过这种方式生成和返回多个列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name, created_on) values (nextval('user_seq'), ?, now())</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>({<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">created_on</span><span class="delimiter">"</span></span>})
  <span class="annotation">@RegisterBeanMapper</span>(IdCreateTime.class)<font></font>
  IdCreateTime insert(<span class="predefined-type">String</span> name);<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One True Database 在返回生成的密钥时支持附加功能。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_getgeneratedkeys_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_binding_arguments_2"><a class="anchor" href=" #_binding_arguments_2"></a><a class="link" href=" #_binding_arguments_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.2. </font><font style="vertical-align: inherit;">绑定参数</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在我们继续其他</font></font><code>@Sql___</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释之前，让我们讨论如何将方法参数作为参数绑定到 SQL 语句。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，传递给该方法的参数被绑定为 SQL 语句中的位置参数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (?, ?)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> insert(<span class="type">long</span> id, <span class="predefined-type">String</span> name);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以在</font></font><code>@Bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释中</font><font style="vertical-align: inherit;">使用命名参数</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="type">long</span> id, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> name);</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href=" #_compiling_with_parameter_names"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用参数名称进行编译</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">消除了对</font></font><code>@Bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">的需要</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后 Jdbi 会将每个未注释的参数绑定到参数的名称。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="type">long</span> id, <span class="predefined-type">String</span> name);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定值列表是通过</font></font><code>@BindList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">完成的</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这将以“a,b,c,d,...”形式展开列表。</font><font style="vertical-align: inherit;">请注意，此批注要求您使用该</font></font><code>&lt;binding&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批注，不像</font></font><code>@Bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（使用 :binding）</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users where id in (&lt;userIds&gt;)</span><span class="delimiter">"</span></span>)
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getFromIds(<span class="annotation">@BindList</span>(<span class="string"><span class="delimiter">"</span><span class="content">userIds</span><span class="delimiter">"</span></span>) <span class="predefined-type">List</span>&lt;<span class="predefined-type">Long</span>&gt; userIds)</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从 a 的条目进行绑定</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindMap</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ?&gt; map);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 SQL 对象中（但不是在 Core 中），您可以使用前缀限定绑定映射：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:user.id, :user.name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindMap</span>(<span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span>) <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ?&gt; map);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从 Java Bean 的属性进行绑定：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindBean</span> User user);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从对象的公共字段进行绑定：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindFields</span> User user);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，您可以从对象的公共无参数方法进行绑定：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:functionThatReturnsTheId, :functionThatReturnsTheName)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindMethods</span> User user);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类似</font></font><code>@BindMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@BindMethods</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>@BindFields</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以有一个可选的前缀：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:user.id, :user.name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@BindBean</span>(<span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span>) User user);
<span class="comment">//void insert(@BindFields("user") User user);</span>
<span class="comment">//void insert(@BindMethods("user") User user);</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在核心 API 中</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@BindFields</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 和</font></font><code>@BindMethods</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于绑定嵌套属性，例如</font></font><code>:user.address.street</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<code>@BindMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不绑定嵌套属性——映射键应该与绑定的参数名称完全匹配。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_sqlquery"><a class="anchor" href=" #_sqlquery"></a><a class="link" href=" #_sqlquery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.3. </font><font style="vertical-align: inherit;">@SqlQuery</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@SqlQuery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释进行选择操作。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询方法可能返回单行或多行结果，具体取决于方法返回类型是否类似于集合。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; listNames(); <i class="conum" data-value="1"></i><b>(1)</b><font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users where id = ?</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">String</span> getName(<span class="type">long</span> id);  <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="3"></i><b>(3)</b><font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users where id = ?</span><span class="delimiter">"</span></span>)<font></font>
  Optional&lt;<span class="predefined-type">String</span>&gt; findName(<span class="type">long</span> id); <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当多行方法返回空结果集时，返回空集合。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果单行方法从查询中返回多行，则该方法只返回结果集中的第一行。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果单行方法返回空结果集，</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可能会返回</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">如果查询没有返回任何行（或者如果行中的值为空），</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回而不是空。</font><font style="vertical-align: inherit;">如果查询返回多于一行，SQL 对象将引发异常。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过</font><font style="vertical-align: inherit;">向</font><a href=" #JdbiCollectors"><font style="vertical-align: inherit;">[JdbiCollectors]</font></a><font style="vertical-align: inherit;">配置注册表</font><font style="vertical-align: inherit;">注册一个</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/collector/CollectorFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CollectorFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
</font><font style="vertical-align: inherit;">可以“教”Jdbi 识别新的集合类型
</font><font style="vertical-align: inherit;">。
</font></font><a href=" #JdbiCollectors"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/collector/BuiltInCollectorFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BuiltInCollectorFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以获取开箱即用支持的集合类型的完整列表。</font><font style="vertical-align: inherit;">某些 Jdbi 插件（例如</font></font><code>GuavaPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）注册额外的集合类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询方法也可能返回</font></font><a href=" #_resultiterable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultIterable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/ResultIterator.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultIterator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
</font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users</span><span class="delimiter">"</span></span>)<font></font>
  ResultIterable&lt;<span class="predefined-type">String</span>&gt; getNamesAsIterable();<font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users</span><span class="delimiter">"</span></span>)<font></font>
  ResultIterator&lt;<span class="predefined-type">String</span>&gt; getNamesAsIterator();<font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select name from users</span><span class="delimiter">"</span></span>)<font></font>
  Stream&lt;<span class="predefined-type">String</span>&gt; getNamesAsStream();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从这些方法返回的对象包含数据库资源，当您使用它们时必须显式关闭这些资源。</font><font style="vertical-align: inherit;">我们强烈建议在调用这些方法时使用 try-with-resource 块，以防止资源泄漏：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (ResultIterable&lt;<span class="predefined-type">String</span>&gt; names = dao.getNamesAsIterable()) {<font></font>
  ...<font></font>
}<font></font>
<font></font>
<span class="keyword">try</span> (ResultIterator&lt;<span class="predefined-type">String</span>&gt; names = dao.getNamesAsIterator()) {<font></font>
  ...<font></font>
}<font></font>
<font></font>
<span class="keyword">try</span> (Stream&lt;<span class="predefined-type">String</span>&gt; names = dao.getNamesAsStream()) {<font></font>
  ...<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<code>ResultIterable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>ResultIterator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法不能很好地与按需 SQL 对象配合使用。</font><font style="vertical-align: inherit;">除非以嵌套方式调用方法（请参阅
</font></font><a href=" #_on_demand"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On-Demand</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），否则返回的对象将已关闭。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="_registerrowmapper"><a class="anchor" href=" #_registerrowmapper"></a><a class="link" href=" #_registerrowmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterRowMapper</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterRowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册一个具体的行映射类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterRowMapper</span>(UserMapper.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与此注释一起使用的行映射器必须满足一些要求：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserMapper</span> <span class="directive">implements</span> <span class="predefined-type">RowMapper</span>&lt;User&gt; {  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="directive">public</span> UserMapper() { <i class="conum" data-value="3"></i><b>(3)</b><font></font>
    ...<font></font>
  }<font></font>
<font></font>
  <span class="directive">public</span> T map(<span class="predefined-type">ResultSet</span> rs, StatementContext ctx) <span class="directive">throws</span> <span class="exception">SQLException</span> {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是公开课。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font><code>RowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用显式类型参数（例如
</font></font><code>RowMapper&lt;User&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）而不是类型变量（例如</font></font><code>RowMapper&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）来实现。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须有一个公共的、无参数的构造函数（或一个默认构造函数）。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterRowMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个映射器重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registerrowmapperfactory"><a class="anchor" href=" #_registerrowmapperfactory"></a><a class="link" href=" #_registerrowmapperfactory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterRowMapperFactory</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterRowMapperFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册一个</font></font><code>RowMapperFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterRowMapperFactory</span>(UserMapperFactory.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与此注释一起使用的行映射器工厂必须满足一些要求：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserMapperFactory</span> <span class="directive">implements</span> RowMapperFactory { <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="directive">public</span> UserMapperFactory() { <i class="conum" data-value="2"></i><b>(2)</b><font></font>
    ...<font></font>
  }<font></font>
<font></font>
  <span class="directive">public</span> Optional&lt;<span class="predefined-type">RowMapper</span>&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是公开课。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须有一个公共的、无参数的构造函数（或一个默认构造函数）。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterRowMapperFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个工厂重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registercolumnmapper"><a class="anchor" href=" #_registercolumnmapper"></a><a class="link" href=" #_registercolumnmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterColumnMapper</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册列映射：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select balance from accounts where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterColumnMapper</span>(MoneyMapper.class)<font></font>
  Money getBalance(<span class="type">long</span> id);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与此注释一起使用的列映射器必须满足一些要求：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MoneyMapper</span> <span class="directive">implements</span> ColumnMapper&lt;Money&gt; {  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="directive">public</span> MoneyMapper() { <i class="conum" data-value="3"></i><b>(3)</b><font></font>
    ...<font></font>
  }<font></font>
<font></font>
  <span class="directive">public</span> T map(<span class="predefined-type">ResultSet</span> r, <span class="type">int</span> columnNumber, StatementContext ctx) <span class="directive">throws</span> <span class="exception">SQLException</span> {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是公开课。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font><code>ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用显式类型参数（例如
</font></font><code>ColumnMapper&lt;User&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）而不是类型变量（例如</font></font><code>ColumnMapper&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）来实现。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须有一个公共的、无参数的构造函数（或一个默认构造函数）。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个映射器重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registercolumnmapperfactory"><a class="anchor" href=" #_registercolumnmapperfactory"></a><a class="link" href=" #_registercolumnmapperfactory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterColumnMapperFactory</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterColumnMapperFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册列映射器工厂：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterColumnMapperFactory</span>(MoneyMapperFactory.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与此注释一起使用的行映射器工厂必须满足一些要求：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserMapperFactory</span> <span class="directive">implements</span> RowMapperFactory { <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="directive">public</span> UserMapperFactory() { <i class="conum" data-value="2"></i><b>(2)</b><font></font>
    ...<font></font>
  }<font></font>
<font></font>
  <span class="directive">public</span> Optional&lt;<span class="predefined-type">RowMapper</span>&lt;?&gt;&gt; build(<span class="predefined-type">Type</span> type, ConfigRegistry config) {<font></font>
    ...<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是公开课。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须有一个公共的、无参数的构造函数（或一个默认构造函数）。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterColumnMapperFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个工厂重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registerbeanmapper"><a class="anchor" href=" #_registerbeanmapper"></a><a class="link" href=" #_registerbeanmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterBeanMapper</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterBeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册一个</font></font><a href=" #_beanmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个bean类：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterBeanMapper</span>(User.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该</font></font><code>prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性会导致 bean 映射器仅映射以前缀开头的那些列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, r.id r_id, r.name r_name </span><span class="delimiter">"</span></span> +
      <span class="string"><span class="delimiter">"</span><span class="content">from users u left join roles r on u.role_id = r.id</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterBeanMapper</span>(value = User.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterBeanMapper</span>(value = <span class="predefined-type">Role</span>.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">r</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">Map</span>&lt;User,<span class="predefined-type">Role</span>&gt; getRolesPerUser();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在该示例中，</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器将映射的列</font></font><code>u_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>u_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进入</font></font><code>User.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>User.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性。</font><font style="vertical-align: inherit;">同样</font><font style="vertical-align: inherit;">，分别</font><font style="vertical-align: inherit;">为 for</font></font><code>r_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>r_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">into
</font></font><code>Role.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Role.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterBeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以重复在相同类型或方法注册多个豆映射器（如上面所证实）。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registerconstructormapper"><a class="anchor" href=" #_registerconstructormapper"></a><a class="link" href=" #_registerconstructormapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterConstructorMapper</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><code>@RegisterConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">通过构造函数使用所有属性实例化的类</font><font style="vertical-align: inherit;">注册</font></font><a href=" #_constructormapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConstructorMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterConstructorMapper</span>(User.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该</font></font><code>prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性会导致构造函数映射器仅映射以前缀开头的列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, r.id r_id, r.name r_name </span><span class="delimiter">"</span></span> +
      <span class="string"><span class="delimiter">"</span><span class="content">from users u left join roles r on u.role_id = r.id</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterConstructorMapper</span>(value = User.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterConstructorMapper</span>(value = <span class="predefined-type">Role</span>.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">r</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">Map</span>&lt;User,<span class="predefined-type">Role</span>&gt; getRolesPerUser();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在该示例中，</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器将映射的列</font></font><code>u_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>u_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进入</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述的参数</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造。</font><font style="vertical-align: inherit;">同样</font><font style="vertical-align: inherit;">，分别</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">构造函数的</font><font style="vertical-align: inherit;">for</font></font><code>r_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和</font></font><code>r_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">into</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font><code>Role</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个构造映射器重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_registerfieldmapper"><a class="anchor" href=" #_registerfieldmapper"></a><a class="link" href=" #_registerfieldmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RegisterFieldMapper</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@RegisterFieldMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册一个</font></font><a href=" #_fieldmapper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FieldMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定类。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterFieldMapper</span>(User.class)
  <span class="predefined-type">List</span>&lt;User&gt; list();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该</font></font><code>prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性会导致字段映射器仅映射以前缀开头的那些列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, r.id r_id, r.name r_name </span><span class="delimiter">"</span></span> +
      <span class="string"><span class="delimiter">"</span><span class="content">from users u left join roles r on u.role_id = r.id</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterFieldMapper</span>(value = User.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterFieldMapper</span>(value = <span class="predefined-type">Role</span>.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">r</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">Map</span>&lt;User,<span class="predefined-type">Role</span>&gt; getRolesPerUser();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这个例子中，</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器将映射列</font></font><code>u_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并</font></font><code>u_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进入</font></font><code>User.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>User.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域。</font><font style="vertical-align: inherit;">同样</font><font style="vertical-align: inherit;">，分别</font><font style="vertical-align: inherit;">用于</font></font><code>r_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>r_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进入
</font></font><code>Role.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Role.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所述</font></font><code>@RegisterConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释可以在相同类型或方法注册多个构造映射器重复多次。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_singlevalue"><a class="anchor" href=" #_singlevalue"></a><a class="link" href=" #_singlevalue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@单值</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时，在使用数组等高级 SQL 功能时，容器类型（例如
</font></font><code>int[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>List&lt;Integer&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能含糊不清地表示“单个 SQL int[]”或“一个 ResultSet of int”）。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于数组在规范化模式中不常用，因此 SQL 对象默认假定您将 ResultSet 收集到容器对象中。</font><font style="vertical-align: inherit;">您可以注释返回类型</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以覆盖它。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，假设我们</font></font><code>varchar[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要从单行中</font><font style="vertical-align: inherit;">选择一</font><font style="vertical-align: inherit;">列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select roles from users where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@SingleValue</span>
  <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getUserRoles(<span class="type">long</span> userId)<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，Jdbi 会解释</font></font><code>List&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为映射类型为
</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并将所有结果行收集到一个列表中。</font><font style="vertical-align: inherit;">该</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注释将使得Jdbi治疗</font></font><code>List&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的映射类型来代替。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很诱人</font></font><code>@SingleValue Optional&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但通常不需要。
</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被实现为一个零或一元素的容器。</font><font style="vertical-align: inherit;">添加</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
意味着数据库本身有一个类似</font></font><code>optional&lt;varchar&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_mapkv_results"><a class="anchor" href=" #_mapkv_results"></a><a class="link" href=" #_mapkv_results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射&lt;K,V&gt; 结果</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象方法可能返回</font></font><code>Map&lt;K,V&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型（请参阅</font><font style="vertical-align: inherit;">核心 API 中的</font></font><a href=" #_map_entry_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map.Entry 映射</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">在这种情况下，每一行都映射到一个</font></font><code>Map.Entry&lt;K,V&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且每行的条目都被收集到一个</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必须为键和值类型注册映射器。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需为键和值类型注册映射器，即可将主/详细连接行收集到映射中。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, p.id p_id, p.phone p_phone </span><span class="delimiter">"</span></span>
    + <span class="string"><span class="delimiter">"</span><span class="content">from user u left join phone p on u.id = p.user_id</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterConstructorMapper</span>(value = User.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterConstructorMapper</span>(value = Phone.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>)
<span class="predefined-type">Map</span>&lt;User, Phone&gt; getMap();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在前面的示例中，</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器使用“u”列名称前缀，而</font></font><code>Phone</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射器使用“p”。</font><font style="vertical-align: inherit;">由于每个映射器仅读取具有预期前缀的</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">，因此相应的</font><font style="vertical-align: inherit;">列是明确的。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过设置键列名来获得唯一索引（例如通过 ID 列）：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from user</span><span class="delimiter">"</span></span>)
<span class="annotation">@KeyColumn</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterConstructorMapper</span>(User.class)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, User&gt; getAll();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置键和值列名称以将两列查询收集到映射结果中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select key, value from config</span><span class="delimiter">"</span></span>)
<span class="annotation">@KeyColumn</span>(<span class="string"><span class="delimiter">"</span><span class="content">key</span><span class="delimiter">"</span></span>)
<span class="annotation">@ValueColumn</span>(<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>)
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getAll();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上所有示例都假设是一对一的键/值关系。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果存在一对多关系呢？</font><font style="vertical-align: inherit;">Google Guava 提供了一种</font></font><code>Multimap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类型，它支持每个键映射多个值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，按照</font></font><a href=" #_google_guava"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Guava</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中的说明安装
</font></font><code>GuavaPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，只需指定</font></font><code>Multimap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回类型而不是</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select u.id u_id, u.name u_name, p.id p_id, p.phone p_phone </span><span class="delimiter">"</span></span>
    + <span class="string"><span class="delimiter">"</span><span class="content">from user u left join phone p on u.id = p.user_id</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterConstructorMapper</span>(value = User.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">u</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterConstructorMapper</span>(value = Phone.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>)<font></font>
Multimap&lt;User, Phone&gt; getMultimap();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到目前为止，所有示例都是</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集中的每一行都是单个</font></font><code>Map.Entry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">但是，如果</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们要返回的实际上是单行甚至单列呢？</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 的</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/MapMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MapMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将每一行映射到一个
</font></font><code>Map&lt;String, Object&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中列名映射到列值。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jdbi 的默认设置是将列名转换为 Map 键的小写。</font><font style="vertical-align: inherit;">可以通过</font></font><code>MapMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置类</font><font style="vertical-align: inherit;">更改此行为</font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，SQL 对象将</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回类型视为</font></font><code>Map.Entry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
值</font><font style="vertical-align: inherit;">的集合</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释覆盖它，以便将返回类型视为单个值而不是集合：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users where id = ?</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterRowMapper</span>(MapMapper.class)
<span class="annotation">@SingleValue</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getById(<span class="type">long</span> userId);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从 Jdbi 3.6.0 开始，有
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/mapper/GenericMapMapperFactory.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericMapMapperFactory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它提供相同的功能，但允许值类型以外的值类型</font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
，只要注册了合适的 ColumnMapper 并且所有列都是这种类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select 1.0 as LOW, 2.0 as MEDIUM, 3.0 as HIGH</span><span class="delimiter">"</span></span>)
<span class="annotation">@RegisterRowMapperFactory</span>(GenericMapMapperFactory.class)
<span class="annotation">@SingleValue</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">BigDecimal</span>&gt; getNumericLevels();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你使用 PostgreSQL 的</font></font><code>hstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列吗？</font><font style="vertical-align: inherit;">的</font></font><a href=" #_postgresql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件提供一个
</font></font><code>hstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到</font></font><code>Map&lt;String, String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列映射器。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息，</font><font style="vertical-align: inherit;">请参阅
</font></font><a href=" #_hstore"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hstore</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_userowreducer"><a class="anchor" href=" #_userowreducer"></a><a class="link" href=" #_userowreducer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@UseRowReducer</font></font></a></h5>
<div class="paragraph">
<p><code>@SqlQuery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用连接查询的方法可以将主从连接减少到一个或多个主级对象。</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_resultbearing_reducerows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultBearing.reduceRows()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以了解行</font><a href=" #_resultbearing_reducerows"><font style="vertical-align: inherit;">缩减</font></a><font style="vertical-align: inherit;">器的介绍。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑一个包含文件夹和文档的文件系统比喻。</font><font style="vertical-align: inherit;">在连接中，我们将</font></font><code>f_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>d_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RegisterBeanMapper</span>(value = Folder.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">f</span><span class="delimiter">"</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RegisterBeanMapper</span>(value = <span class="predefined-type">Document</span>.class, prefix = <span class="string"><span class="delimiter">"</span><span class="content">d</span><span class="delimiter">"</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">DocumentDao</span> {
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">f.id f_id, f.name f_name, </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">d.id d_id, d.name d_name, d.contents d_contents </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">from folders f left join documents d </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">on f.id = d.folder_id </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">where f.id = :folderId</span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">order by d.name</span><span class="delimiter">"</span></span>)
    <span class="annotation">@UseRowReducer</span>(FolderDocReducer.class) <i class="conum" data-value="2"></i><b>(2)</b>
    Optional&lt;Folder&gt; getFolder(<span class="type">int</span> folderId); <i class="conum" data-value="3"></i><b>(3)</b><font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">f.id f_id, f.name f_name, </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">d.id d_id, d.name d_name, d.contents d_contents </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">from folders f left join documents d </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">on f.id = d.folder_id </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">order by f.name, d.name</span><span class="delimiter">"</span></span>)
    <span class="annotation">@UseRowReducer</span>(FolderDocReducer.class) <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="predefined-type">List</span>&lt;Folder&gt; listFolders(); <i class="conum" data-value="3"></i><b>(3)</b><font></font>
<font></font>
    <span class="type">class</span> <span class="class">FolderDocReducer</span> <span class="directive">implements</span> LinkedHashMapRowReducer&lt;<span class="predefined-type">Integer</span>, Folder&gt; { <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> accumulate(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">Integer</span>, Folder&gt; map, RowView rowView) {<font></font>
            Folder f = map.computeIfAbsent(rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">f_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Integer</span>.class), <i class="conum" data-value="5"></i><b>(5)</b><font></font>
                                           id -&gt; rowView.getRow(Folder.class));<font></font>
<font></font>
            <span class="keyword">if</span> (rowView.getColumn(<span class="string"><span class="delimiter">"</span><span class="content">d_id</span><span class="delimiter">"</span></span>, <span class="predefined-type">Integer</span>.class) != <span class="predefined-constant">null</span>) { <i class="conum" data-value="6"></i><b>(6)</b>
                f.getDocuments().add(rowView.getRow(<span class="predefined-type">Document</span>.class));<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此示例中，我们使用前缀注册文件夹和文档映射器，以便每个映射器仅查看具有该前缀的列。</font><font style="vertical-align: inherit;">这些映射器由</font></font><code>getRow(Folder.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>getRow(Document.class)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用中</font><font style="vertical-align: inherit;">的行缩减器间接使用
</font><font style="vertical-align: inherit;">。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用 注释方法</font></font><code>@UseRowReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并指定</font></font><code>RowReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实现类。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同的</font></font><code>RowReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现可用于单主记录查询和多主记录查询。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/result/LinkedHashMapRowReducer.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkedHashMapRowReducer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是一个抽象</font></font><code>RowReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现，它使用 a</font></font><code>LinkedHashMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为结果容器，并返回</font></font><code>values()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集合作为结果。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></b></td>
<td><font style="vertical-align: inherit;"></font><code>Folder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过 ID 从地图中</font><font style="vertical-align: inherit;">获取</font><font style="vertical-align: inherit;">此行的 ，如果不在地图中，则创建它。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在映射文档并将其添加到文件夹之前，</font><font style="vertical-align: inherit;">确认该行有一个文档（这</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左联接）。</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sqlbatch"><a class="anchor" href=" #_sqlbatch"></a><a class="link" href=" #_sqlbatch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.4. </font><font style="vertical-align: inherit;">@SqlBatch</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批注进行批量更新操作。</font></font><code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类似于</font></font><a href=" #_prepared_batches"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreparedBatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在核心。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ContactDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name, email) values (?, ?, ?)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> bulkInsert(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; ids,
                  <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt; names,
                  <span class="predefined-type">String</span>... emails);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批处理参数可以是集合、可迭代对象、迭代器、数组（包括可变参数）。</font><font style="vertical-align: inherit;">为简洁起见，我们将这些称为“可迭代对象”。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当调用批处理方法时，SQL 对象遍历该方法的可迭代参数，并使用每个参数中的相应元素执行 SQL 语句。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，声明如下：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">contactDao.bulkInsert(<font></font>
    ImmutableList.of(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>),<font></font>
    ImmutableList.of(<span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">bar</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">baz</span><span class="delimiter">"</span></span>).iterator(),
    <span class="string"><span class="delimiter">"</span><span class="content">a@example.com</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">b@example.com</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">c@fake.com</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将执行：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">insert</span> <span class="class">into</span> contacts (id, name, email) <span class="keyword">values</span> (<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">a@example.com</span><span class="delimiter">'</span></span>);
<span class="class">insert</span> <span class="class">into</span> contacts (id, name, email) <span class="keyword">values</span> (<span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="content">bar</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">b@example.com</span><span class="delimiter">'</span></span>);
<span class="class">insert</span> <span class="class">into</span> contacts (id, name, email) <span class="keyword">values</span> (<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">baz</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">c@fake.com</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常量值也可以用作 SQL 批处理的参数。</font><font style="vertical-align: inherit;">在这种情况下，对于批处理中的每个 SQL 语句，相同的值都绑定到该参数。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (tenant_id, id, name) </span><span class="delimiter">"</span></span> +
      <span class="string"><span class="delimiter">"</span><span class="content">values (:tenantId, :user.id, :user.name)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> bulkInsert(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">tenantId</span><span class="delimiter">"</span></span>) <span class="type">long</span> tenantId, <i class="conum" data-value="1"></i><b>(1)</b>
                  <span class="annotation">@BindBean</span>(<span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span>) User... users);<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用相同的</font></font><code>tenant_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 方法必须至少有一个可迭代参数。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，一个</font></font><code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可能会返回一些类型：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: 不返回任何内容（显然）</font></font></p>
</li>
<li>
<p><code>int[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>long[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回批处理中每次执行的更新计数。</font><font style="vertical-align: inherit;">根据数据库供应商和 JDBC 驱动程序，这可能是语句更改的行数，也可能是查询匹配的行数（无论是否更改了任何数据）。</font></font></p>
</li>
<li>
<p><code>boolean[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: 如果更新计数大于零，则返回 true，批处理中的每次执行一个值。</font></font></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_getgeneratedkeys_2"><a class="anchor" href=" #_getgeneratedkeys_2"></a><a class="link" href=" #_getgeneratedkeys_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与 类似</font></font><code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@GetGeneratedKeys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释告诉 SQL 对象返回值应该是每个 SQL 语句生成的键，而不是更新计数。</font><font style="vertical-align: inherit;">请参阅
</font></font><a href=" #_getgeneratedkeys"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行更深入的讨论。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (nextval('user_seq'), ?)</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>)
  <span class="type">long</span><span class="type">[]</span> bulkInsert(<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个插入的名称返回生成的 ID。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过这种方式生成和返回多个列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name, created_on) values (nextval('user_seq'), ?, now())</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>({<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">created_on</span><span class="delimiter">"</span></span>})
  <span class="annotation">@RegisterBeanMapper</span>(IdCreateTime.class)
  <span class="predefined-type">List</span>&lt;IdCreateTime&gt; bulkInsert(<span class="predefined-type">String</span>... names);<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_singlevalue_2"><a class="anchor" href=" #_singlevalue_2"></a><a class="link" href=" #_singlevalue_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@单值</font></font></a></h5>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在某些情况下，您可能希望将可迭代参数视为常量——使用</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法参数上的注释。</font><font style="vertical-align: inherit;">这会导致 SQL 对象将整个可迭代对象绑定为批处理中每个 SQL 语句的参数值（通常作为 SQL 数组参数）。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name, roles) values (?, ?, ?)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> bulkInsert(<span class="predefined-type">List</span>&lt;<span class="predefined-type">Long</span>&gt; ids,
                  <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names,
                  <span class="annotation">@SingleValue</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; roles);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在上面的示例中，每个新行将</font></font><code>varchar[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code>roles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">获得相同的</font><font style="vertical-align: inherit;">值
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sqlcall"><a class="anchor" href=" #_sqlcall"></a><a class="link" href=" #_sqlcall"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.5. </font><font style="vertical-align: inherit;">@SqlCall</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@SqlCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解调用存储过程。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlCall</span>(<span class="string"><span class="delimiter">"</span><span class="content">{call suspend_account(:id)}</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> suspendAccount(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="type">long</span> accountId);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@SqlCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可以返回</font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者</font></font><code>OutParameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果存储过程有任何输出参数</font><font style="vertical-align: inherit;">也可以返回</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个输出参数都必须在</font></font><code>@OutParameter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解中</font><font style="vertical-align: inherit;">注册</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">OrderDao</span> {
  <span class="annotation">@SqlCall</span>(<span class="string"><span class="delimiter">"</span><span class="content">{call prepare_order_from_cart(:cartId, :orderId, :orderTotal)}</span><span class="delimiter">"</span></span>)
  <span class="annotation">@OutParameter</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">orderId</span><span class="delimiter">"</span></span>,    sqlType = java.sql.Types.BIGINT)
  <span class="annotation">@OutParameter</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">orderTotal</span><span class="delimiter">"</span></span>, sqlType = java.sql.Types.DECIMAL)<font></font>
  OutParameters prepareOrderFromCart(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">cartId</span><span class="delimiter">"</span></span>) <span class="type">long</span> cartId);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以</font><font style="vertical-align: inherit;">从方法返回</font><font style="vertical-align: inherit;">的</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/OutParameters.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OutParameters 中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提取单个输出参数
</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OutParameters outParams = orderDao.prepareOrderFromCart(cartId);
<span class="type">long</span> orderId = outParams.getLong(<span class="string"><span class="delimiter">"</span><span class="content">orderId</span><span class="delimiter">"</span></span>);
<span class="type">double</span> orderTotal = outParams.getDouble(<span class="string"><span class="delimiter">"</span><span class="content">orderTotal</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过传递 a</font></font><code>Consumer&lt;OutParameters&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或 a </font></font><code>Function&lt;OutParameters, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您可以在语句关闭之前处理结果。</font><font style="vertical-align: inherit;">这对于处理游标类型的结果很有用。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_sqlscript"><a class="anchor" href=" #_sqlscript"></a><a class="link" href=" #_sqlscript"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.6. </font><font style="vertical-align: inherit;">@SqlScript</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><code>@SqlScript</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批量执行一个或多个语句。</font><font style="vertical-align: inherit;">您可以定义要使用的模板引擎的属性。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlScript</span>(<span class="string"><span class="delimiter">"</span><span class="content">CREATE TABLE &lt;name&gt; (pk int primary key)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> createTable(<span class="annotation">@Define</span> <span class="predefined-type">String</span> name);<font></font>
<font></font>
<span class="annotation">@SqlScript</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO cool_table VALUES (5), (6), (7)</span><span class="delimiter">"</span></span>)
<span class="annotation">@SqlScript</span>(<span class="string"><span class="delimiter">"</span><span class="content">DELETE FROM cool_table WHERE pk &gt; 5</span><span class="delimiter">"</span></span>)
<span class="type">int</span><span class="type">[]</span> doSomeUpdates(); <span class="comment">// returns [ 3, 2 ]</span><font></font>
<font></font>
<span class="annotation">@UseClasspathSqlLocator</span> <span class="comment">// load external SQL!</span>
<span class="annotation">@SqlScript</span> <span class="comment">// use the method name</span>
<span class="annotation">@SqlScript</span>(<span class="string"><span class="delimiter">"</span><span class="content">secondScript</span><span class="delimiter">"</span></span>) <span class="comment">// or specify it yourself</span>
<span class="type">int</span><span class="type">[]</span> externalScript();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getgeneratedkeys_3"><a class="anchor" href=" #_getgeneratedkeys_3"></a><a class="link" href=" #_getgeneratedkeys_3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.7. </font><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>@GetGeneratedKeys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解可用于</font></font><code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or</font></font><code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法以返回从 SQL 语句生成的键：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> sqlObjectBatchKeys() {<font></font>
    db.useExtension(UserDao.class, dao -&gt; {<font></font>
        <span class="predefined-type">List</span>&lt;User&gt; users = dao.createUsers(<span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>);<font></font>
        assertEquals(<span class="integer">3</span>, users.size());<font></font>
<font></font>
        assertEquals(<span class="integer">1</span>, users.get(<span class="integer">0</span>).id);<font></font>
        assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Alice</span><span class="delimiter">"</span></span>, users.get(<span class="integer">0</span>).name);<font></font>
<font></font>
        assertEquals(<span class="integer">2</span>, users.get(<span class="integer">1</span>).id);<font></font>
        assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Bob</span><span class="delimiter">"</span></span>, users.get(<span class="integer">1</span>).name);<font></font>
<font></font>
        assertEquals(<span class="integer">3</span>, users.get(<span class="integer">2</span>).id);<font></font>
        assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>, users.get(<span class="integer">2</span>).name);<font></font>
    });<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
    <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO users (name) VALUES(?)</span><span class="delimiter">"</span></span>)
    <span class="annotation">@GetGeneratedKeys</span>
    <span class="predefined-type">List</span>&lt;User&gt; createUsers(<span class="predefined-type">String</span>... names);<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sqllocator"><a class="anchor" href=" #_sqllocator"></a><a class="link" href=" #_sqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.8. </font><font style="vertical-align: inherit;">数据库定位器</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当 SQL 语句变得越来越复杂时，在</font></font><code>@Sql___</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法注释</font><font style="vertical-align: inherit;">中将语句作为 Java 字符串提供可能会很麻烦</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了批注，可让您配置外部位置以加载 SQL 语句。</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@UseAnnotationSqlLocator（默认行为；使用@Sql___(… ) 注释值）</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@UseClasspathSqlLocator - 基于 SQL 对象接口类型的包和名称，从类路径上的文件加载 SQL。</font></font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.foo</span>;
<span class="annotation">@UseClasspathSqlLocator</span>
<span class="type">interface</span> <span class="class">BarDao</span> {
    <span class="comment">// loads classpath resource com/foo/BarDao/query.sql</span>
    <span class="annotation">@SqlQuery</span>
    <span class="type">void</span> query();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@UseClasspathSqlLocator</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是使用</font></font><a href=" #_classpathsqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClasspathSqlLocator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现的</font><font style="vertical-align: inherit;">，如上所述。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<a href=" #_classpathsqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClasspathSqlLocator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认加载文件不变。</font></font><code>@UseClasspathSqlLocator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">注释将删除注释！</font><font style="vertical-align: inherit;">这可能会导致意外行为，例如 SQL Server 使用该</font></font><code>#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符来表示临时表。</font><font style="vertical-align: inherit;">这可以通过</font></font><code>stripComments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">annotation 属性</font><font style="vertical-align: inherit;">来控制</font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.foo</span>;
<span class="annotation">@UseClasspathSqlLocator</span>(stripComments=<span class="predefined-constant">false</span>)
<span class="type">interface</span> <span class="class">BarDao</span> {
    <span class="comment">// loads classpath resource com/foo/BarDao/query.sql without stripping comment lines</span>
    <span class="annotation">@SqlQuery</span>
    <span class="type">void</span> query();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你喜欢 StringTemplate，</font></font><a href=" #_stringtemplate_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StringTemplate 4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块还提供了一个 SqlLocator，它可以从类路径上的 StringTemplate 4 文件加载 SQL 模板。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_createsqlobject"><a class="anchor" href=" #_createsqlobject"></a><a class="link" href=" #_createsqlobject"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.9. </font><font style="vertical-align: inherit;">@CreateSqlObject</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用@CreateSqlObject 注释在另一个 SqlObject 中重用 SqlObject。</font><font style="vertical-align: inherit;">例如，您可以构建一个事务方法，该方法执行在其他 SqlObject 中定义的 SQL 更新作为事务的一部分。</font><font style="vertical-align: inherit;">Jdbi 不会打开一个新的句柄来调用子 SqlObject。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Bar</span> {<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into bar (name) values (:name)</span><span class="delimiter">"</span></span>)
    <span class="annotation">@GetGeneratedKeys</span>
    <span class="type">int</span> insert(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> name);<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Foo</span> {<font></font>
<font></font>
    <span class="annotation">@CreateSqlObject</span><font></font>
    Bar createBar();<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into foo (bar_id, name) values (:bar_id, :name)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> insert(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">bar_id</span><span class="delimiter">"</span></span>) <span class="type">int</span> barId, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> name);<font></font>
<font></font>
    <span class="annotation">@Transaction</span>
    <span class="keyword">default</span> <span class="type">void</span> insertBarAndFoo(<span class="predefined-type">String</span> barName, <span class="predefined-type">String</span> fooName) {
        <span class="type">int</span> barId = createBar().insert(barName);<font></font>
        insert(barId, fooName);<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_timestamped"><a class="anchor" href=" #_timestamped"></a><a class="link" href=" #_timestamped"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.10. </font><font style="vertical-align: inherit;">@时间戳</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以注释任何语句以</font><font style="vertical-align: inherit;">在 binding 下</font></font><code>@Timestamped</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定 an </font></font><code>OffsetDateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其值为当前时间</font></font><code>now</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Bar</span> {
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into times(val) values(:now)</span><span class="delimiter">"</span></span>)
    <span class="annotation">@Timestamped</span>
    <span class="type">int</span> insert();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以自定义绑定名称：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Timestamped</span>(<span class="string"><span class="delimiter">"</span><span class="content">timestamp</span><span class="delimiter">"</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/TimestampedConfig.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimestampedConfig</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使您可以控制用于此的时区。</font></font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consumer_methods"><a class="anchor" href=" #_consumer_methods"></a><a class="link" href=" #_consumer_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2. </font><font style="vertical-align: inherit;">消费者方法</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为一种特殊情况，</font></font><code>Consumer&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了其他绑定参数之外</font><font style="vertical-align: inherit;">，您还可以提供一个</font><font style="vertical-align: inherit;">参数。</font><font style="vertical-align: inherit;">提供的使用者对结果集中的每一行执行一次。</font><font style="vertical-align: inherit;">参数 T 的静态类型决定了行类型。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select id, name from users</span><span class="delimiter">"</span></span>)
<span class="type">void</span> forEachUser(Consumer&lt;User&gt; consumer);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_default_methods"><a class="anchor" href=" #_default_methods"></a><a class="link" href=" #_default_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.3. </font><font style="vertical-align: inherit;">默认方法</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时会出现 SQL 方法注释不适合的用例。</font><font style="vertical-align: inherit;">在这些情况下，您可以使用 Java 8</font></font><code>default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法</font><font style="vertical-align: inherit;">“下拉”到核心 API </font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了一个</font></font><code>SqlObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有</font></font><code>getHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">mixin 接口</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使您的 SQL 对象接口扩展</font></font><code>SqlObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mixin，然后在默认方法中提供您自己的实现：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">SplineDao</span> <span class="directive">extends</span> SqlObject {
  <span class="keyword">default</span> <span class="type">void</span> reticulateSplines(Spline spline) {<font></font>
    Handle handle = getHandle();<font></font>
    <span class="comment">// do tricky stuff using the Core API.</span><font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认方法也可用于将多个 SQL 操作分组为单个方法调用：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ContactPhoneDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (nextval('contact_id'), :name)</span><span class="delimiter">"</span></span>)
  <span class="type">long</span> insertContact(<span class="annotation">@BindBean</span> Contact contact);<font></font>
<font></font>
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into phones (contact_id, type, phone) values (:contactId, :type, :phone)</span><span class="delimiter">"</span></span>)
  <span class="type">void</span> insertPhone(<span class="type">long</span> contactId, <span class="annotation">@BindBean</span> <span class="predefined-type">Iterable</span>&lt;Phone&gt; phones);<font></font>
<font></font>
  <span class="keyword">default</span> <span class="type">long</span> insertFullContact(Contact contact) {
    <span class="type">long</span> id = insertContact(contact);<font></font>
    insertPhone(id, contact.getPhones());<font></font>
    <span class="keyword">return</span> id;<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transaction_management"><a class="anchor" href=" #_transaction_management"></a><a class="link" href=" #_transaction_management"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.4. </font><font style="vertical-align: inherit;">交易管理</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以使用 SqlObject 注释声明事务：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> sqlObjectTransaction() {<font></font>
    assertThat(handle.attach(UserDao.class).findUserById(<span class="integer">3</span>).map(u -&gt; u.name)).contains(<span class="string"><span class="delimiter">"</span><span class="content">Charlie</span><span class="delimiter">"</span></span>);<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">SELECT * FROM users WHERE id=:id</span><span class="delimiter">"</span></span>)
    <span class="annotation">@Transaction</span>
    Optional&lt;User&gt; findUserById(<span class="type">int</span> id);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释的</font><font style="vertical-align: inherit;">SQL 方法</font><font style="vertical-align: inherit;">可以选择指定事务隔离级别：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">INSERT INTO USERS (name) VALUES (:name)</span><span class="delimiter">"</span></span>)
<span class="annotation">@Transaction</span>(TransactionIsolationLevel.READ_COMMITTED)
<span class="type">void</span> insertUser(<span class="predefined-type">String</span> name);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果一个</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法调用另一个</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法，它们必须指定相同的隔离级别，或者内部方法不得指定任何内容，在这种情况下，使用外部方法的隔离级别。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Transaction</span>(TransactionIsolationLevel.READ_UNCOMMITTED)
<span class="keyword">default</span> <span class="type">void</span> outerMethodCallsInnerWithSameLevel() {
    <span class="comment">// this works: isolation levels agree</span><font></font>
    innerMethodSameLevel();<font></font>
}<font></font>
<font></font>
<span class="annotation">@Transaction</span>(TransactionIsolationLevel.READ_UNCOMMITTED)
<span class="keyword">default</span> <span class="type">void</span> innerMethodSameLevel() {}<font></font>
<font></font>
<span class="annotation">@Transaction</span>(TransactionIsolationLevel.READ_COMMITTED)
<span class="keyword">default</span> <span class="type">void</span> outerMethodWithLevelCallsInnerMethodWithNoLevel() {
    <span class="comment">// this also works: inner method doesn't specify a level, so the outer method controls.</span><font></font>
    innerMethodWithNoLevel();<font></font>
}<font></font>
<font></font>
<span class="annotation">@Transaction</span>
<span class="keyword">default</span> <span class="type">void</span> innerMethodWithNoLevel() {}<font></font>
<font></font>
<span class="annotation">@Transaction</span>(TransactionIsolationLevel.REPEATABLE_READ)
<span class="keyword">default</span> <span class="type">void</span> outerMethodWithOneLevelCallsInnerMethodWithAnotherLevel() <span class="directive">throws</span> TransactionException {
    <span class="comment">// error! inner method specifies a different isolation level.</span><font></font>
    innerMethodWithADifferentLevel();<font></font>
}<font></font>
<font></font>
<span class="annotation">@Transaction</span>(TransactionIsolationLevel.SERIALIZABLE)
<span class="keyword">default</span> <span class="type">void</span> innerMethodWithADifferentLevel() {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_sql_objects"><a class="anchor" href=" #_using_sql_objects"></a><a class="link" href=" #_using_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5. </font><font style="vertical-align: inherit;">使用 SQL 对象</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义接口后，有几种方法可以获取它的实例：</font></font></p>
</div>
<div class="sect3">
<h4 id="_attached_to_handle"><a class="anchor" href=" #_attached_to_handle"></a><a class="link" href=" #_attached_to_handle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.1. </font><font style="vertical-align: inherit;">附在手柄上</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以获得附加到打开句柄的 SQL 对象。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (Handle handle = jdbi.open()) {<font></font>
  ContactPhoneDao dao = handle.attach(ContactPhoneDao.class);<font></font>
  dao.insertFullContact(contact);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加的 SQL 对象与句柄具有相同的生命周期——当句柄关闭时，SQL 对象将变得不可用。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_temporary_sql_objects"><a class="anchor" href=" #_temporary_sql_objects"></a><a class="link" href=" #_temporary_sql_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.2. </font><font style="vertical-align: inherit;">临时 SQL 对象</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以通过向 Jdbi 对象传递一个回调（通常是 lambda）来从 Jdbi 对象获取临时 SQL 对象。</font><font style="vertical-align: inherit;">将
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Jdbi.html#withExtension-java.lang.Class-org.jdbi.v3.core.extension.ExtensionCallback-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi.withExtension</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用于返回结果</font><font style="vertical-align: inherit;">
的操作</font><font style="vertical-align: inherit;">，或
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/Jdbi.html#useExtension-java.lang.Class-org.jdbi.v3.core.extension.ExtensionConsumer-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">useExtension</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于没有结果的操作。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.useExtension(ContactPhoneDao.class, dao -&gt; dao.insertFullContact(alice));
<span class="type">long</span> bobId = jdbi.withExtension(ContactPhoneDao.class, dao -&gt; dao.insertFullContact(bob));</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">临时 SQL 对象仅在传递给方法的回调中有效。</font><font style="vertical-align: inherit;">当回调返回时，SQL 对象（和关联的临时句柄）将关闭。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_on_demand"><a class="anchor" href=" #_on_demand"></a><a class="link" href=" #_on_demand"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5.3. </font><font style="vertical-align: inherit;">一经请求</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按需实例具有开放式生命周期，因为它们为每个方法调用获取和释放连接。</font><font style="vertical-align: inherit;">它们是线程安全的，可以在应用程序中重复使用。</font><font style="vertical-align: inherit;">当您一次只需要拨打一个电话时，这很方便。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ContactPhoneDao dao = jdbi.onDemand(ContactPhoneDao.class);
<span class="type">long</span> aliceId = dao.insertFullContact(alice);
<span class="type">long</span> bobId = dao.insertFullContact(bob);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按需状态存储在</font></font><code>ThreadLocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储中以模仿词法范围。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每次分配和释放连接都会造成性能损失。</font><font style="vertical-align: inherit;">在上面的示例中，这两个</font></font><code>insertFullContact</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作</font></font><code>Connection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从您的数据库连接池中</font><font style="vertical-align: inherit;">获取不同的</font><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">为避免这种情况，请在使用 DAO 期间保持句柄打开：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">dao.useTransaction(txn -&gt; {<font></font>
    User bob = txn.readContact(bobId);<font></font>
    Order order = txn.getOpenOrder(bobId);<font></font>
    txn.createInvoice(computeInvoice(bob, metadata));<font></font>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口</font></font><code>default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法以及</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/SqlObject.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlObject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/transaction/Transactional.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transactional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等混合体
</font><font style="vertical-align: inherit;">允许您在按需句柄保持打开状态的情况下运行代码。</font><font style="vertical-align: inherit;">同一线程上的可重入调用将收到相同的</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">当最外面的按需调用完成时，句柄将关闭。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
返回游标式类型，如</font></font><code>Stream&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>Iterable&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">点播不能正常工作的最外面。</font><font style="vertical-align: inherit;">由于</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关闭，数据库游标被释放，读取将失败。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_annotations"><a class="anchor" href=" #_additional_annotations"></a><a class="link" href=" #_additional_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.6. </font><font style="vertical-align: inherit;">附加注释</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了数十种开箱即用的注释：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/config/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.sqlobject.config</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为可以在</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">级别</font><font style="vertical-align: inherit;">配置的事物提供注释</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这包括映射器和参数的注册，以及用于配置 SQL 语句呈现和解析。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.sqlobject.customizer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为绑定参数、定义属性和控制语句结果集的获取行为提供注释。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/jpa/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.jpa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提供了</font></font><code>@BindJpa</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释，用于根据 JPA</font></font><code>@Column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">将属性绑定到列</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/locator/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.sqlobject.locator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提供了配置 Jdbi 以从替代源（例如类路径上的文件）加载 SQL 语句的注释。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/statement/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.sqlobject.statement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提供了</font></font><code>@MapTo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解，用于在调用方法时动态指定映射类型。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/stringtemplate4/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.stringtemplate4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提供了配置 Jdbi 以从</font></font><code>.stg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类路径上的</font><font style="vertical-align: inherit;">StringTemplate 4</font><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">加载 SQL</font><font style="vertical-align: inherit;">和/或使用 ST4 模板引擎解析 SQL 模板的</font><font style="vertical-align: inherit;">注释
</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/transaction/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jdbi.v3.sqlobject.transaction</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为 SQL 对象中的事务管理提供注释。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">详细信息，</font><font style="vertical-align: inherit;">请参阅
</font></font><a href=" #_transaction_management"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事务管理</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 旨在支持用户定义的注释。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">创建您自己的</font></font><a href=" #_user_defined_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的指南，</font><font style="vertical-align: inherit;">请参阅
</font><a href=" #_user_defined_annotations"><font style="vertical-align: inherit;">用户定义的注释</font></a><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_annotations_and_inheritance"><a class="anchor" href=" #_annotations_and_inheritance"></a><a class="link" href=" #_annotations_and_inheritance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7. </font><font style="vertical-align: inherit;">注释和继承</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象从它们扩展的接口继承方法和注释：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.app.dao</span>;<font></font>
<font></font>
<span class="annotation">@UseClasspathSqlLocator</span>  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CrudDao</span>&lt;T, ID&gt; {
  <span class="annotation">@SqlUpdate</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="type">void</span> insert(<span class="annotation">@BindBean</span> T entity);<font></font>
<font></font>
  <span class="annotation">@SqlQuery</span> <i class="conum" data-value="3"></i><b>(3)</b><font></font>
  Optional&lt;T&gt; findById(ID id);<font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>
  <span class="predefined-type">List</span>&lt;T&gt; list();<font></font>
<font></font>
  <span class="annotation">@SqlUpdate</span>
  <span class="type">void</span> update(<span class="annotation">@BindBean</span> T entity);<font></font>
<font></font>
  <span class="annotation">@SqlUpdate</span>
  <span class="type">void</span> deleteById(ID id);<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_sqllocator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlLocator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类注释由子类型继承。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法和参数注释由子类型继承，除非子类型覆盖了方法。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.app.contact</span>;<font></font>
<font></font>
<span class="annotation">@RegisterBeanMapper</span>(Contact.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ContactDao</span> <span class="directive">extends</span> CrudDao&lt;Contact, <span class="predefined-type">Long</span>&gt; {}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.app.account</span>;<font></font>
<font></font>
<span class="annotation">@RegisterConstructorMapper</span>(Account.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> <span class="directive">extends</span> CrudDao&lt;Account, <span class="predefined-type">UUID</span>&gt; {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这个例子中，我们使用了</font></font><code>@UseClasspathSqlLocator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解，所以每个方法都将使用从类路径加载的 SQL。</font><font style="vertical-align: inherit;">因此，</font></font><code>ContactDao</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法将使用来自以下方面的 SQL：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/com/app/contact/ContactDao/insert.sql</code></p>
</li>
<li>
<p><code>/com/app/contact/ContactDao/findById.sql</code></p>
</li>
<li>
<p><code>/com/app/contact/ContactDao/list.sql</code></p>
</li>
<li>
<p><code>/com/app/contact/ContactDao/update.sql</code></p>
</li>
<li>
<p><code>/com/app/contact/ContactDao/deleteById.sql</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而</font></font><code>AccountDao</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将从以下位置使用 SQL：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/com/app/account/AccountDao/insert.sql</code></p>
</li>
<li>
<p><code>/com/app/account/AccountDao/findById.sql</code></p>
</li>
<li>
<p><code>/com/app/account/AccountDao/list.sql</code></p>
</li>
<li>
<p><code>/com/app/account/AccountDao/update.sql</code></p>
</li>
<li>
<p><code>/com/app/account/AccountDao/deleteById.sql</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设</font></font><code>Account</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用了</font></font><code>name()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-style 访问器而不是</font></font><code>getName()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">在这种情况下，我们想要</font></font><code>AccountDao</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@BindMethods</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们用正确的注释覆盖这些方法：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.app.account</span>;<font></font>
<font></font>
<span class="annotation">@RegisterConstructorMapper</span>(Account.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> <span class="directive">extends</span> CrudDao&lt;Account, <span class="predefined-type">UUID</span>&gt; {
  <span class="annotation">@Override</span>
  <span class="annotation">@SqlUpdate</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="type">void</span> insert(<span class="annotation">@BindMethods</span> Account entity);<font></font>
<font></font>
  <span class="annotation">@Override</span>
  <span class="annotation">@SqlUpdate</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="type">void</span> update(<span class="annotation">@BindMethods</span> Account entity);<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法注释不会在覆盖时继承，所以我们必须复制我们想要保留的那些。</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="anchor" href=" #_testing"></a><a class="link" href=" #_testing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. 测试</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>jdbi3-testing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工件提供了一个</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/testing/JdbiRule.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JdbiRule</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类，该类为编写与托管数据库实例集成的 JUnit 测试提供帮助。</font><font style="vertical-align: inherit;">这使得编写单元测试变得快速而简单！</font><font style="vertical-align: inherit;">你必须记住包含数据库依赖本身，例如获得一个纯 H2 Java 数据库：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.h2database<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>h2<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.4.197<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果要针对 Postgres 进行测试，则应包括：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.opentable.components<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>otj-pg-embedded<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>0.11.3<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_third_party_integration"><a class="anchor" href=" #_third_party_integration"></a><a class="link" href=" #_third_party_integration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. 第三方集成</font></font></a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_google_guava"><a class="anchor" href=" #_google_guava"></a><a class="link" href=" #_google_guava"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1. </font><font style="vertical-align: inherit;">谷歌番石榴</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件增加了对以下类型的支持：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Optional&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 注册一个参数和映射器。</font><font style="vertical-align: inherit;">支持</font><font style="vertical-align: inherit;">注册映射器/参数工厂的</font></font><code>Optional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任何包装类型</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数 Guava 集合和映射类型 -</font><font style="vertical-align: inherit;">有关受支持类型的完整列表，</font><font style="vertical-align: inherit;">请参阅
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/guava/GuavaCollectors.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GuavaCollectors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-guava<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> GuavaPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装插件后，可以从 SQL 对象方法返回任何受支持的 Guava 集合类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users order by name</span><span class="delimiter">"</span></span>)<font></font>
    ImmutableList&lt;User&gt; list();<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from users where id = :id</span><span class="delimiter">"</span></span>)<font></font>
    com.google.common.base.Optional&lt;User&gt; getById(<span class="type">long</span> id);<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_h2_database"><a class="anchor" href=" #_h2_database"></a><a class="link" href=" #_h2_database"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2. </font><font style="vertical-align: inherit;">H2 数据库</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件配置Jdbi正确处理</font></font><code>integer[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>uuid[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在H2数据库中的数据类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件包含在核心 jar 中（但将来可能会被提取到单独的工件中）。</font><font style="vertical-align: inherit;">通过将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例中来</font><font style="vertical-align: inherit;">使用它</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> H2DatabasePlugin());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jdbi3-json"><a class="anchor" href=" #jdbi3-json"></a><a class="link" href=" #jdbi3-json"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3. </font><font style="vertical-align: inherit;">JSON</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>jdbi3-json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块添加了一个</font></font><code>@Json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型限定符，允许将任意 Java 对象作为 JSON 数据存储在您的数据库中。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不包括实际的 JSON（反）序列化代码。</font><font style="vertical-align: inherit;">为此，您必须安装一个支持插件（见下文）。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
支持插件将为</font></font><code>JsonPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您</font><font style="vertical-align: inherit;">安装</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">你</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要自行安装或包括</font></font><code>jdbi3-json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接依赖。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该功能已使用 Postgres</font></font><code>json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列以及</font></font><code>varchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H2 和 Sqlite 中的列</font><font style="vertical-align: inherit;">进行了测试</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="sect3">
<h4 id="_jackson_2"><a class="anchor" href=" #_jackson_2"></a><a class="link" href=" #_jackson_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.1. </font><font style="vertical-align: inherit;">杰克逊 2</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件通过 Jackson 2 提供 JSON 支持。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-jackson2<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> Jackson2Plugin());
<span class="comment">// optionally configure your ObjectMapper (recommended)</span><font></font>
jdbi.getConfig(Jackson2Config.class).setMapper(myObjectMapper);<font></font>
<font></font>
<span class="comment">// now with simple support for Json Views if you want to filter properties:</span>
jdbi.getConfig(Jackson2Config.class).setView(ApiProperty.class);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gson_2"><a class="anchor" href=" #_gson_2"></a><a class="link" href=" #_gson_2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.2. </font><font style="vertical-align: inherit;">Gson 2</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件通过 Gson 2 提供 JSON 支持。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-gson2<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> Gson2Plugin());
<span class="comment">// optional</span>
jdbi.getConfig(Gson2Config.class).setGson(myGson);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_moshi"><a class="anchor" href=" #_moshi"></a><a class="link" href=" #_moshi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.3. </font><font style="vertical-align: inherit;">莫希</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件通过 Moshi 提供 JSON 支持。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-moshi<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> MoshiPlugin());
<span class="comment">// optional</span>
jdbi.getConfig(MoshiConfig.class).setMoshi(myMoshi);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_operation"><a class="anchor" href=" #_operation"></a><a class="link" href=" #_operation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.4. </font><font style="vertical-align: inherit;">手术</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任何限定为</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/json/Json.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Json 的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定对象</font><font style="vertical-align: inherit;">——除了</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">——将被</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/json/JsonConfig.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册的</font></font></a>
<a href="http://jdbi.org/apidocs/org/jdbi/v3/json/JsonMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JsonMapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转换</font><font style="vertical-align: inherit;">并</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重新</font></font></em><font style="vertical-align: inherit;"><a href="http://jdbi.org/apidocs/org/jdbi/v3/json/JsonMapper.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;">限定</font></a><font style="vertical-align: inherit;">为</font></font><code>@Json String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将调用</font><font style="vertical-align: inherit;">相应的限定符</font><font style="vertical-align: inherit;">来存储 JSON 数据，从而允许为您的数据库实现特殊的 JSON 处理。</font><font style="vertical-align: inherit;">如果没有找到，</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会使用</font><font style="vertical-align: inherit;">一个普通的工厂</font><font style="vertical-align: inherit;">，以将 JSON 作为明文处理。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射的工作方式相同，但相反：限定为 as 的输出类型</font></font><code>@Json T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将从 a
</font></font><code>@Json String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColumnMapper 中获取，然后通过</font></font><code>JsonMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的 PostgresPlugin 提供了合格的工厂，可以绑定/映射</font></font><code>@Json String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to/from</font></font><code>json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>jsonb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-typed 列。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage"><a class="anchor" href=" #_usage"></a><a class="link" href=" #_usage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3.5. </font><font style="vertical-align: inherit;">用法</font></font></a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">create table myjsons (id serial not null, value json not null)</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// any json-serializable type</span>
<span class="type">class</span> <span class="class">MyJson</span> {}<font></font>
<font></font>
<span class="comment">// use @Json qualifier:</span>
<span class="type">interface</span> <span class="class">MyJsonDao</span> {
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into myjsons (json) values(:value)</span><span class="delimiter">"</span></span>)
    <span class="comment">// on parameters</span>
    <span class="type">int</span> insert(<span class="annotation">@Json</span> MyJson value);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select value from myjsons</span><span class="delimiter">"</span></span>)
    <span class="comment">// on result types</span>
    <span class="annotation">@Json</span>
    <span class="predefined-type">List</span>&lt;MyJson&gt; select();<font></font>
}<font></font>
<font></font>
<span class="comment">// also works on bean or property-mapped objects:</span>
<span class="type">class</span> <span class="class">MyBean</span> {
    <span class="directive">private</span> <span class="directive">final</span> MyJson property;
    <span class="annotation">@Json</span>
    <span class="directive">public</span> MyJson getProperty() { <span class="keyword">return</span> ...; }<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 Fluent API，您</font></font><code>QualifiedType&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在通常提供</font></font><code>Class&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">任何地方提供</font></font><code>GenericType&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">QualifiedType&lt;MyJson&gt; qualifiedType = QualifiedType.of(MyJson.class).with(Json.class);<font></font>
<font></font>
h.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into myjsons(json) values(:json)</span><span class="delimiter">"</span></span>)<font></font>
    .bindByType(<span class="string"><span class="delimiter">"</span><span class="content">json</span><span class="delimiter">"</span></span>, <span class="keyword">new</span> MyJson(), qualifiedType)<font></font>
    .execute();<font></font>
<font></font>
MyJson result = h.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select json from myjsons</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(qualifiedType)<font></font>
    .one();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_immutables"><a class="anchor" href=" #_immutables"></a><a class="link" href=" #_immutables"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.4. </font><font style="vertical-align: inherit;">不可变的</font></font></a></h3>
<div class="paragraph">
<p><a href="https://immutables.github.io/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Immutables</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个注解处理器，它根据简单的接口描述生成值类型。</font><font style="vertical-align: inherit;">值类型很自然地映射到</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性绑定和行映射。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不可变支持仍处于试验阶段，尚不支持自定义命名方案。</font><font style="vertical-align: inherit;">我们也支持可配置的</font></font><code>get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>is</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前缀。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需通过安装插件并配置您的</font></font><code>Immutables</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型来</font><font style="vertical-align: inherit;">告诉我们您的</font><font style="vertical-align: inherit;">类型：</font></font></p>
</div>
<div class="paragraph">
<p><code>jdbi.getConfig(JdbiImmutables.class).registerImmutable(MyValueType.class)</code></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置将注册适当的</font></font><code>RowMapper`s as well as configure the new `bindPojo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><code>@BindPojo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）活页夹：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Value</span>.Immutable
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Train</span> {
    <span class="predefined-type">String</span> name();
    <span class="type">int</span> carriages();
    <span class="type">boolean</span> observationCar();<font></font>
}<font></font>
<font></font>
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> simpleTest() {<font></font>
    jdbi.getConfig(JdbiImmutables.class).registerImmutable(Train.class);<font></font>
    <span class="keyword">try</span> (Handle handle = jdbi.open()) {<font></font>
        handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">create table train (name varchar, carriages int, observation_car boolean)</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
        assertThat(<font></font>
            handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into train(name, carriages, observation_car) values (:name, :carriages, :observationCar)</span><span class="delimiter">"</span></span>)<font></font>
                .bindPojo(ImmutableTrain.builder().name(<span class="string"><span class="delimiter">"</span><span class="content">Zephyr</span><span class="delimiter">"</span></span>).carriages(<span class="integer">8</span>).observationCar(<span class="predefined-constant">true</span>).build())<font></font>
                .execute())<font></font>
            .isEqualTo(<span class="integer">1</span>);<font></font>
<font></font>
        assertThat(<font></font>
            handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from train</span><span class="delimiter">"</span></span>)<font></font>
                .mapTo(Train.class)<font></font>
                .one())<font></font>
            .extracting(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">carriages</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">observationCar</span><span class="delimiter">"</span></span>)<font></font>
            .containsExactly(<span class="string"><span class="delimiter">"</span><span class="content">Zephyr</span><span class="delimiter">"</span></span>, <span class="integer">8</span>, <span class="predefined-constant">true</span>);<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_freebuilder"><a class="anchor" href=" #_freebuilder"></a><a class="link" href=" #_freebuilder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.5. </font><font style="vertical-align: inherit;">自由建造者</font></font></a></h3>
<div class="paragraph">
<p><a href="https://https//freebuilder.inferred.org/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freebuilder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个注解处理器，它根据简单的接口或抽象类描述生成值类型。</font><font style="vertical-align: inherit;">Jdbi 支持 Freebuilder 的方式与它支持 Immutables 的方式大致相同。</font></font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Freebuilder 支持仍处于试验阶段，可能不支持所有 Freebuilder 实现的功能。</font><font style="vertical-align: inherit;">我们支持 JavaBean 风格的 getter 和 setter 以及不带前缀的 getter 和 setter。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需通过安装插件和配置您的</font></font><code>Freebuilder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型来</font><font style="vertical-align: inherit;">告诉我们您的 Freebuilder 类型</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="paragraph">
<p><code>jdbi.getConfig(JdbiFreebuilder.class).registerFreebuilder(MyFreeBuilderType.class)</code></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置将注册适当的</font></font><code>RowMapper`s as well as
configure the new `bindPojo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><code>@BindPojo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）活页夹：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@FreeBuilder</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Train</span> {
    <span class="predefined-type">String</span> name();
    <span class="type">int</span> carriages();
    <span class="type">boolean</span> observationCar();<font></font>
<font></font>
    <span class="type">class</span> <span class="class">Builder</span> <span class="directive">extends</span> FreeBuildersTest_Train_Builder {}<font></font>
}<font></font>
<font></font>
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> simpleTest() {<font></font>
    jdbi.getConfig(JdbiFreeBuilders.class).registerFreeBuilder(Train.class);<font></font>
    <span class="keyword">try</span> (Handle handle = jdbi.open()) {<font></font>
        handle.execute(<span class="string"><span class="delimiter">"</span><span class="content">create table train (name varchar, carriages int, observation_car boolean)</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
        Train train = <span class="keyword">new</span> Train.Builder()<font></font>
            .name(<span class="string"><span class="delimiter">"</span><span class="content">Zephyr</span><span class="delimiter">"</span></span>)<font></font>
            .carriages(<span class="integer">8</span>)<font></font>
            .observationCar(<span class="predefined-constant">true</span>)<font></font>
            .build();<font></font>
<font></font>
        assertThat(<font></font>
            handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into train(name, carriages, observation_car) values (:name, :carriages, :observationCar)</span><span class="delimiter">"</span></span>)<font></font>
                .bindPojo(train)<font></font>
                .execute())<font></font>
            .isEqualTo(<span class="integer">1</span>);<font></font>
<font></font>
        assertThat(<font></font>
            handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from train</span><span class="delimiter">"</span></span>)<font></font>
                .mapTo(Train.class)<font></font>
                .one())<font></font>
            .extracting(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">carriages</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">observationCar</span><span class="delimiter">"</span></span>)<font></font>
            .containsExactly(<span class="string"><span class="delimiter">"</span><span class="content">Zephyr</span><span class="delimiter">"</span></span>, <span class="integer">8</span>, <span class="predefined-constant">true</span>);<font></font>
    }<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jodatime"><a class="anchor" href=" #_jodatime"></a><a class="link" href=" #_jodatime"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.6. </font><font style="vertical-align: inherit;">乔达时间</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个插件增加了对使用 joda-time</font></font><code>DateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型的支持。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-jodatime2<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> JodaTimePlugin());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jpa"><a class="anchor" href=" #_jpa"></a><a class="link" href=" #_jpa"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.7. </font><font style="vertical-align: inherit;">日本特许经营协会</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 JPA 插件是诱使您的老板让您尝试 Jdbi 的好方法。</font><font style="vertical-align: inherit;">“没问题老大，已经支持JPA注解了，轻松peasy！”</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此插件为 JPA 实体注释的一小部分添加了映射支持：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实体</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射超类</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柱子</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-jpa<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> JpaPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">老实说..只是撕掉绷带并切换到Jdbi。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_kotlin"><a class="anchor" href=" #_kotlin"></a><a class="link" href=" #_kotlin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8. </font><font style="vertical-align: inherit;">科特林</font></font></a></h3>
<div class="paragraph">
<p><a href="https://kotlinlang.org/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持由</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin-sqlobject</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块提供。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin API 文档：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://jdbi.org/apidocs-kotlin/jdbi3-kotlin/index.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin</font></font></a></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs-kotlin/jdbi3-kotlin-sqlobject/index.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin-sqlobject</font></font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_resultset_mapping"><a class="anchor" href=" #_resultset_mapping"></a><a class="link" href=" #_resultset_mapping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8.1. </font><font style="vertical-align: inherit;">结果集映射</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-科特林</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件添加映射科特林数据类。</font><font style="vertical-align: inherit;">它支持所有字段都存在于构造函数中的数据类以及具有可写属性的类。</font><font style="vertical-align: inherit;">构造函数中不存在的任何字段将在构造函数调用后设置。</font><font style="vertical-align: inherit;">映射器支持可为空类型。</font><font style="vertical-align: inherit;">如果参数类型不可为空且结果集中不存在该值，它还会在构造函数中使用默认参数值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-kotlin<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确保 Kotlin 编译器的</font></font><a href="https://kotlinlang.org/docs/reference/using-maven.html#attributes-specific-for-jvm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JVM 目标版本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至少设置为 1.8：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;kotlin.compiler.jvmTarget&gt;</span>1.8<span class="tag">&lt;/kotlin.compiler.jvmTarget&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">jdbi.installPlugin(KotlinPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin 映射器还支持</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许显式指定属性或参数名称的</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解，</font><font style="vertical-align: inherit;">以及</font><font style="vertical-align: inherit;">允许映射嵌套 Kotlin 对象</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">注解。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kotlin 类的 getter、setter 和 setter 参数的限制器参数、getter、setter 和 setter 参数</font><font style="vertical-align: inherit;">
不是使用</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>@RegisterBeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use </font></font><code>@BindKotlin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>bindKotlin()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 和</font></font><code>KotlinMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为限定符。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><code>@ColumnName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释仅在将 SQL 数据映射到 Java 对象时适用。</font><font style="vertical-align: inherit;">当绑定对象属性（例如 with </font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，绑定属性名 ( </font></font><code>:id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 而不是列名 ( </font></font><code>:user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您通过</font></font><code>Jdbi.installPlugins()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此插件</font><font style="vertical-align: inherit;">加载所有 Jdbi 插件，</font><font style="vertical-align: inherit;">则会自动发现并注册。</font><font style="vertical-align: inherit;">否则，您可以使用
</font></font><code>Jdbi.installPlugin(KotlinPlugin())</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试类的一个例子：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">data class IdAndName(val id: Int, val name: String)<font></font>
data class Thing(@Nested val idAndName: IdAndName,<font></font>
                 val nullable: String?,<font></font>
                 val nullableDefaultedNull: String? = null,<font></font>
                 val nullableDefaultedNotNull: String? = "not null",<font></font>
                 val defaulted: String = "default value")<font></font>
@Test fun testFindById() {<font></font>
    val qry = db.sharedHandle.createQuery("select id, name from something where id = :id")<font></font>
    val things: List&lt;Thing&gt; = qry.bind("id", brian.idAndName.id).mapTo&lt;Thing&gt;().list()<font></font>
    assertEquals(1, things.size)<font></font>
    assertEquals(brian, things[0])<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有两个扩展可以提供帮助：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;reified T : Any&gt;ResultBearing.mapTo()</code></p>
</li>
<li>
<p><code>&lt;T : Any&gt;ResultIterable&lt;T&gt;.useSequence(block: (Sequence&lt;T&gt;) → Unit)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许代码如下：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val qry = handle.createQuery("select id, name from something where id = :id")<font></font>
val things = qry.bind("id", brian.id).mapTo&lt;Thing&gt;.list()</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并使用自动关闭的序列：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">qryAll.mapTo&lt;Thing&gt;.useSequence {<font></font>
    it.forEach(::println)<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sqlobject"><a class="anchor" href=" #_sqlobject"></a><a class="link" href=" #_sqlobject"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.8.2. </font><font style="vertical-align: inherit;">对象</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-科特林-SQLObject的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件添加了自动参数的名字在SqlObjects科特林方法以及用于科特林默认方式支持绑定。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-kotlin-sqlobject<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">jdbi.installPlugin(KotlinSqlObjectPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数绑定支持单个原始类型以及 Kotlin 或 JavaBean 样式对象作为参数（在绑定中引用为
</font></font><code>:paramName.propertyName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">不需要注释。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您通过</font></font><code>Jdbi.installPlugins()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此插件</font><font style="vertical-align: inherit;">加载所有 Jdbi 插件，</font><font style="vertical-align: inherit;">则会自动发现并注册。</font><font style="vertical-align: inherit;">否则，您可以通过以下方式附加插件：</font></font><code>Jdbi.installPlugin(KotlinSqlObjectPlugin())</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试类的一个例子：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ThingDao {<font></font>
    @SqlUpdate("insert into something (id, name) values (:something.idAndName.id, :something.idAndName.name)")<font></font>
    fun insert(something: Thing)<font></font>
<font></font>
    @SqlQuery("select id, name from something")<font></font>
    fun list(): List&lt;Thing&gt;<font></font>
}<font></font>
@Before fun setUp() {<font></font>
    val dao = db.jdbi.onDemand&lt;ThingDao&gt;()<font></font>
<font></font>
    val brian = Thing(IdAndName(1, "Brian"), null)<font></font>
    val keith = Thing(IdAndName(2, "Keith"), null)<font></font>
<font></font>
    dao.insert(brian)<font></font>
    dao.insert(keith)<font></font>
}<font></font>
@Test fun testDao() {<font></font>
    val dao = db.jdbi.onDemand&lt;ThingDao&gt;()<font></font>
<font></font>
    val rs = dao.list()<font></font>
<font></font>
    assertEquals(2, rs.size.toLong())<font></font>
    assertEquals(brian, rs[0])<font></font>
    assertEquals(keith, rs[1])<font></font>
<font></font>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lombok"><a class="anchor" href=" #_lombok"></a><a class="link" href=" #_lombok"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.9. </font><font style="vertical-align: inherit;">龙目岛</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lombok 是从 POJO 类中删除样板的好工具。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Data</span>
<span class="directive">public</span> <span class="type">void</span> DataClass {
  <span class="directive">private</span> <span class="predefined-type">Long</span> id;
  <span class="directive">private</span> <span class="predefined-type">String</span> name;
  <span class="comment">// autogenerates default constructor, getters, setters, equals, hashCode, and toString</span><font></font>
}<font></font>
<font></font>
<span class="annotation">@Value</span>
<span class="directive">public</span> <span class="type">void</span> ValueClass {
  <span class="directive">private</span> <span class="type">long</span> id;
  <span class="directive">private</span> <span class="predefined-type">String</span> name;
  <span class="comment">// autogenerates all-args constructor, getters, equals, hashCode, and toString</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lombok 和 Jdbi 大多开箱即用：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>BeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>@RegisterBeanMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来映射</font></font><code>@Data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>ConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>@RegisterConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来映射</font></font><code>@Value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>@BindBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定</font></font><code>@Data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>@Value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们说“大多是”因为有皱纹，一旦你开始Jdbi注解注释像场</font></font><code>@Nested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@ColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或键入注释资格等</font></font><code>@HStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanMapper 在 getter、setter 或 setter 参数上查找这些注释。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConstructorMapper 在构造函数参数上查找它们。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，Lombok 不会将它们移动到那里。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从 Lombok 版本 1.18.4 开始，Lombok 可以配置为将您指定的任何注释复制到生成的 getter、setter、setter 参数和构造函数参数。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>lombok.config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您的项目 src 树中</font><font style="vertical-align: inherit;">创建一个文件</font><font style="vertical-align: inherit;">（或编辑现有的），并为每个应复制的注释类型添加一行，如下例所示：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">lombok.copyableAnnotations += org.jdbi.v3.core.mapper.Nested<font></font>
lombok.copyableAnnotations += org.jdbi.v3.core.mapper.reflect.ColumnName<font></font>
lombok.copyableAnnotations += org.jdbi.v3.postgres.HStore</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oracle_12"><a class="anchor" href=" #_oracle_12"></a><a class="link" href=" #_oracle_12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.10. </font><font style="vertical-align: inherit;">甲骨文 12</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该模块添加了对 Oracle </font></font><code>RETURNING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DML 表达式的</font><font style="vertical-align: inherit;">支持</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此功能，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-oracle12<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，使用</font></font><code>OracleReturning</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">类</font></font><code>PreparedBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来获取返回的 DML。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_postgresql"><a class="anchor" href=" #_postgresql"></a><a class="link" href=" #_postgresql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11. </font><font style="vertical-align: inherit;">PostgreSQL</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3，Postgres的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件提供了加强与整合
</font></font><a href="https://jdbc.postgresql.org/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL的JDBC驱动程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此功能，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-postgres<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:postgresql://host:port/database</span><span class="delimiter">"</span></span>)<font></font>
                .installPlugin(<span class="keyword">new</span> PostgresPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该插件为 Java 8 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.time</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font><font style="vertical-align: inherit;">配置映射，</font><font style="vertical-align: inherit;">如
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instant</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duration</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InetAddress</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、类型枚举和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hstore</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它还可配置SQL数组类型的支持</font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>double</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><code>String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和</font></font><code>UUID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">详尽列表，</font><font style="vertical-align: inherit;">请参阅</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/postgres/package-summary.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">javadoc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
某些 Postgres 运算符，例如</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询运算符，会与</font><font style="vertical-align: inherit;">特殊字符</font></font><code>jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>JDBC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特殊字符</font><font style="vertical-align: inherit;">发生冲突</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，您可能需要将运算符转义为 eg</font></font><code>??</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>\:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_hstore"><a class="anchor" href=" #_hstore"></a><a class="link" href=" #_hstore"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.1. </font><font style="vertical-align: inherit;">商店</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postgres的插件提供一个</font></font><code>hstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到</font></font><code>Map&lt;String, String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列映射器，并且反之亦然参数工厂：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; accountAttributes = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select attributes from account where id = ?</span><span class="delimiter">"</span></span>, userId)<font></font>
    .mapTo(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
    .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有了</font></font><code>@HStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合格的类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">QualifiedType&lt;&gt; HSTORE_MAP = QualifiedType.of(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
    .with(HStore.class);<font></font>
<font></font>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; caps = handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">update account set attributes = :hstore</span><span class="delimiter">"</span></span>)<font></font>
    .bindByType(<span class="string"><span class="delimiter">"</span><span class="content">hstore</span><span class="delimiter">"</span></span>, mapOfStrings, HSTORE_MAP)<font></font>
    .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，SQL 对象将</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回类型视为</font></font><code>Map.Entry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
值</font><font style="vertical-align: inherit;">的集合</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用</font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释覆盖它，以便将返回类型视为单个值而不是集合：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select attributes from account where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@SingleValue</span>
  <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getAccountAttributes(<span class="type">long</span> accountId);<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装插件的默认变体添加了</font></font><code>Map</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自</font></font><code>hstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postgres 数据类型</font><font style="vertical-align: inherit;">和到</font><font style="vertical-align: inherit;">Postgres 数据类型</font><font style="vertical-align: inherit;">的原始</font><font style="vertical-align: inherit;">类型的</font><font style="vertical-align: inherit;">非限定映射</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在某些情况下，这会干扰地图的其他映射。</font><font style="vertical-align: inherit;">建议始终使用具有</font></font><code>@HStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限定类型</font><font style="vertical-align: inherit;">的变体</font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了避免绑定不合格的 Argument 和 ColumnMapper 绑定，请使用静态工厂方法安装插件：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:postgresql://host:port/database</span><span class="delimiter">"</span></span>)<font></font>
                .installPlugin(PostgresPlugin.noUnqualifiedHstoreBindings());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getgeneratedkeys_4"><a class="anchor" href=" #_getgeneratedkeys_4"></a><a class="link" href=" #_getgeneratedkeys_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.2. </font><font style="vertical-align: inherit;">@GetGeneratedKeys</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Postgres 中，</font></font><code>@GetGeneratedKeys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您请求生成的键而不命名任何列</font><font style="vertical-align: inherit;">，则</font><font style="vertical-align: inherit;">可以返回整个修改后的行。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name, created_on) values (nextval('user_seq'), ?, now())</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>
  <span class="annotation">@RegisterBeanMapper</span>(User.class)<font></font>
  User insert(<span class="predefined-type">String</span> name);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果数据库操作修改了多行（例如，将修改多行的更新），您的方法可以返回集合中所有修改过的行：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
  <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">update users set active = false where id = any(?)</span><span class="delimiter">"</span></span>)
  <span class="annotation">@GetGeneratedKeys</span>
  <span class="annotation">@RegisterBeanMapper</span>(User.class)
  <span class="predefined-type">List</span>&lt;User&gt; deactivateUsers(<span class="type">long</span>... userIds);<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_large_objects"><a class="anchor" href=" #_large_objects"></a><a class="link" href=" #_large_objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.11.3. </font><font style="vertical-align: inherit;">大型物体</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postgres 支持将大字符或二进制数据存储在与表数据分开的存储中。</font><font style="vertical-align: inherit;">Jdbi 允许您将此数据作为封闭事务的一部分传入和传出数据库。</font><font style="vertical-align: inherit;">提供了存储、读取和删除挂钩。</font><font style="vertical-align: inherit;">测试用例作为一个简单的例子：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> blobCrud(<span class="predefined-type">InputStream</span> myStream) <span class="directive">throws</span> <span class="exception">IOException</span> {<font></font>
    h.useTransaction(th -&gt; {<font></font>
        Lobject lob = th.attach(Lobject.class);<font></font>
        lob.insert(<span class="integer">1</span>, myStream);<font></font>
        readItBack = lob.readBlob(<span class="integer">1</span>);<font></font>
        lob.deleteLob(<span class="integer">1</span>);
        <span class="keyword">assert</span> lob.readBlob(<span class="integer">1</span>) == <span class="predefined-constant">null</span>;<font></font>
    });<font></font>
}<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Lobject</span> {
    <span class="comment">// CREATE TABLE lob (id int, lob oid</span>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into lob (id, lob) values (:id, :blob)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> insert(<span class="type">int</span> id, <span class="predefined-type">InputStream</span> blob);<font></font>
<font></font>
    <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select lob from lob where id = :id</span><span class="delimiter">"</span></span>)
    <span class="predefined-type">InputStream</span> readBlob(<span class="type">int</span> id);<font></font>
<font></font>
    <span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">delete from lob where id = :id returning lo_unlink(lob)</span><span class="delimiter">"</span></span>)
    <span class="type">void</span> deleteLob(<span class="type">int</span> id);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有关上游驱动程序文档，</font><font style="vertical-align: inherit;">请参阅
</font></font><a href="https://jdbc.postgresql.org/documentation/head/binary-data.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pg-JDBC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档。</font></font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring5"><a class="anchor" href=" #_spring5"></a><a class="link" href=" #_spring5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12. </font><font style="vertical-align: inherit;">春天5</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该模块提供</font></font><code>JdbiFactoryBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了一个工厂 bean，它</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在 Spring 5（或 Spring Boot）应用程序上下文中</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">单例。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用此模块，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-spring5<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后在你的 Spring 容器中配置 Jdbi factory bean，例如：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">"</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
       <span class="attribute-name">xmlns:aop</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.springframework.org/schema/aop</span><span class="delimiter">"</span></span>
       <span class="attribute-name">xmlns:tx</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.springframework.org/schema/tx</span><span class="delimiter">"</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span>
       <span class="content">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd</span>
       <span class="content">http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd</span>
       <span class="content">http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span><font></font>
<font></font>
  <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">db</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.springframework.jdbc.datasource.DriverManagerDataSource</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">url</span><span class="delimiter">"</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbc:h2:mem:testing</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/bean&gt;</span><font></font>
<font></font>
  <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">transactionManager</span><span class="delimiter">"</span></span>
    <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.springframework.jdbc.datasource.DataSourceTransactionManager</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">dataSource</span><span class="delimiter">"</span></span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">"</span><span class="content">db</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/bean&gt;</span>
  <span class="tag">&lt;tx:annotation-driven</span> <span class="attribute-name">transaction-manager</span>=<span class="string"><span class="delimiter">"</span><span class="content">transactionManager</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span><font></font>
<font></font>
  <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span>
    <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.spring5.JdbiFactoryBean</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">dataSource</span><span class="delimiter">"</span></span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">"</span><span class="content">db</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/bean&gt;</span><font></font>
<font></font>
  <i class="conum" data-value="4"></i><b>(4)</b>
  <span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">service</span><span class="delimiter">"</span></span>
    <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.example.service.MyService</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;constructor-arg</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 将连接到的 SQL 数据源。</font><font style="vertical-align: inherit;">在此示例中，我们使用 H2 数据库，但它可以是任何 JDBC 兼容的数据库。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过注释启用事务配置。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td><font style="vertical-align: inherit;"></font><code>JdbiFactoryBean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用之前</font><font style="vertical-align: inherit;">配置</font><font style="vertical-align: inherit;">的数据源进行配置。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注入</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务类。</font><font style="vertical-align: inherit;">或者，</font></font><code>@Inject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在目标类上</font><font style="vertical-align: inherit;">使用标准 JSR-330
</font><font style="vertical-align: inherit;">注释，而不是在您的</font></font><code>beans.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_installing_plugins"><a class="anchor" href=" #_installing_plugins"></a><a class="link" href=" #_installing_plugins"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12.1. </font><font style="vertical-align: inherit;">安装插件</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过扫描</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServiceLoader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清单</font><font style="vertical-align: inherit;">的类路径来自动安装插件
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.spring5.JdbiFactoryBean</span><span class="delimiter">"</span></span><span class="tag">&gt;</span><font></font>
  ...<font></font>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">autoInstallPlugins</span><span class="delimiter">"</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件也可以显式安装：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.spring5.JdbiFactoryBean</span><span class="delimiter">"</span></span><span class="tag">&gt;</span><font></font>
  ...<font></font>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">plugins</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;list&gt;</span>
      <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.sqlobject.SqlObjectPlugin</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.guava.GuavaPlugin</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/list&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并非所有插件都可以自动安装。</font><font style="vertical-align: inherit;">在这些情况下，您可以自动安装一些插件并手动安装其余插件：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.spring5.JdbiFactoryBean</span><span class="delimiter">"</span></span><span class="tag">&gt;</span><font></font>
  ...<font></font>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">autoInstallPlugins</span><span class="delimiter">"</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">plugins</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;list&gt;</span>
      <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.core.h2.H2DatabasePlugin</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/list&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_global_attributes"><a class="anchor" href=" #_global_attributes"></a><a class="link" href=" #_global_attributes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.12.2. </font><font style="vertical-align: inherit;">全局属性</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在工厂 bean 上配置全局定义的属性：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">jdbi</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.jdbi.v3.spring5.JdbiFactoryBean</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">dataSource</span><span class="delimiter">"</span></span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">"</span><span class="content">db</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">globalDefines</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;map&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">bar</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/map&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sqlite"><a class="anchor" href=" #_sqlite"></a><a class="link" href=" #_sqlite"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.13. </font><font style="vertical-align: inherit;">SQLite</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-sqlite的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件提供了使用支持
</font></font><a href="https://bitbucket.org/xerial/sqlite-jdbc/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLite的JDBC驱动程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Jdbi。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该插件为</font><font style="vertical-align: inherit;">驱动程序不支持</font><font style="vertical-align: inherit;">的 Java </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font><font style="vertical-align: inherit;">配置映射</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用这个插件，首先添加一个 Maven 依赖：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-sqlite<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后将插件安装到您的</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例中。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(<span class="string"><span class="delimiter">"</span><span class="content">jdbc:sqlite:database</span><span class="delimiter">"</span></span>)<font></font>
                .installPlugin(<span class="keyword">new</span> SQLitePlugin());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stringtemplate_4"><a class="anchor" href=" #_stringtemplate_4"></a><a class="link" href=" #_stringtemplate_4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.14. </font><font style="vertical-align: inherit;">字符串模板 4</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此模块允许您插入 StringTemplate 4 模板引擎，以代替标准的 Jdbi 模板引擎。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用模块插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-stringtemplate4<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要在 SQL 语句中使用 StringTemplate 格式，请将模板引擎设置为</font></font><code>StringTemplateEngine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义的属性提供给 StringTemplate 引擎以呈现 SQL：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> sortColumn = <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>;
<span class="predefined-type">String</span> sql = <span class="string"><span class="delimiter">"</span><span class="content">select id, name </span><span class="delimiter">"</span></span> +
             <span class="string"><span class="delimiter">"</span><span class="content">from account </span><span class="delimiter">"</span></span> +
             <span class="string"><span class="delimiter">"</span><span class="content">order by &lt;if(sort)&gt; &lt;sortBy&gt;, &lt;endif&gt; id</span><span class="delimiter">"</span></span>;<font></font>
<font></font>
<span class="predefined-type">List</span>&lt;Account&gt; accounts = handle.createQuery(sql)<font></font>
      .setTemplateEngine(<span class="keyword">new</span> StringTemplateEngine())<font></font>
      .define(<span class="string"><span class="delimiter">"</span><span class="content">sort</span><span class="delimiter">"</span></span>, <span class="predefined-constant">true</span>)<font></font>
      .define(<span class="string"><span class="delimiter">"</span><span class="content">sortBy</span><span class="delimiter">"</span></span>, sortColumn)<font></font>
      .mapTo(Account.class)<font></font>
      .list();</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于 StringTemplate 默认使用</font></font><code>&lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符来标记 ST 表达式，因此您可能需要转义一些 SQL：</font></font><code>String datePredSql = "&lt;if(datePredicate)&gt; &lt;dateColumn&gt; \\&lt; :dateFilter &lt;endif&gt;"</code>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，可以从类路径上的 StringTemplate 组文件加载 SQL 模板：</font></font></p>
</div>
<div class="listingblock">
<div class="title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com/foo/AccountDao.sql.stg</font></font></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="stringtemplate">group AccountDao;<font></font>
<font></font>
selectAll(sort,sortBy) ::= &lt;&lt;<font></font>
  select id, name<font></font>
  from account<font></font>
  order by &lt;if(sort)&gt; &lt;sortBy&gt;, &lt;endif&gt; id<font></font>
&gt;&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ST template = StringTemplateSqlLocator.findStringTemplate(
                  <span class="string"><span class="delimiter">"</span><span class="content">com/foo/AccountDao.sql.stg</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">selectAll</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
<span class="predefined-type">String</span> sql = template.add(<span class="string"><span class="delimiter">"</span><span class="content">sort</span><span class="delimiter">"</span></span>, <span class="predefined-constant">true</span>)<font></font>
                     .add(<span class="string"><span class="delimiter">"</span><span class="content">sortBy</span><span class="delimiter">"</span></span>, sortColumn)<font></font>
                     .render();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 SQL 对象中，</font></font><code>@UseStringTemplateEngine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释设置语句定位器，类似于上面的第一个示例。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.foo</span>;<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select id, name </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">from account </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">order by &lt;if(sort)&gt; &lt;sortBy&gt;, &lt;endif&gt; id</span><span class="delimiter">"</span></span>)
  <span class="annotation">@UseStringTemplateEngine</span>
  <span class="predefined-type">List</span>&lt;Account&gt; selectAll(<span class="annotation">@Define</span> <span class="type">boolean</span> sort,
                          <span class="annotation">@Define</span> <span class="predefined-type">String</span> sortBy);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者，</font></font><code>@UseStringTemplateSqlLocator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释设置语句定位器，并从类路径上的 StringTemplate 组文件加载 SQL：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.foo</span>;<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>
  <span class="annotation">@UseStringTemplateSqlLocator</span>
  <span class="predefined-type">List</span>&lt;Account&gt; selectAll(<span class="annotation">@Define</span> <span class="type">boolean</span> sort,
                          <span class="annotation">@Define</span> <span class="predefined-type">String</span> sortBy);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此示例中，由于完全限定的类名是</font></font><code>com.foo.AccountDao</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将从</font></font><code>com/foo/AccountDao.sql.stg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类路径上的</font><font style="vertical-align: inherit;">文件加载 SQL </font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，将使用与方法同名的组中的模板。</font><font style="vertical-align: inherit;">这可以在</font></font><code>@Sql___</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">上覆盖</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.foo</span>;<font></font>
<font></font>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">listSorted</span><span class="delimiter">"</span></span>)
  <span class="annotation">@UseStringTemplateSqlLocator</span>
  <span class="predefined-type">List</span>&lt;Account&gt; selectAll(<span class="annotation">@Define</span> <span class="type">boolean</span> sort,
                          <span class="annotation">@Define</span> <span class="predefined-type">String</span> sortBy);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这个例子中，SQL 模板仍然会从</font></font><code>com/foo/AccountDao.sql.stg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类路径上的</font><font style="vertical-align: inherit;">文件中加载
</font><font style="vertical-align: inherit;">，但是</font></font><code>listSorted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论方法名称如何，都会使用模板。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_vavr"><a class="anchor" href=" #_vavr"></a><a class="link" href=" #_vavr"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.15. </font><font style="vertical-align: inherit;">瓦弗尔</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vavr 插件提供了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与 Vavr 函数库的</font><font style="vertical-align: inherit;">深度集成</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的服务器Vavr值类型，如支持论点的分辨率
</font></font><code>Option&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Either&lt;L, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Lazy&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Try&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Validation&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">鉴于对于包装类型，</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册了 Mapper。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从查询中返回 Vavr 集合类型。</font><font style="vertical-align: inherit;">支持是</font></font><code>Seq&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Set&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
</font></font><code>Map&lt;K, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Multimap&lt;K, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及它们的所有亚型。</font><font style="vertical-align: inherit;">可以收集到 a </font></font><code>Traversable&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在这种情况下 a</font></font><code>List&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将被返回。</font><font style="vertical-align: inherit;">对于所有接口类型，将使用合理的默认实现（eq </font></font><code>List&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for </font></font><code>Seq&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">此外</font></font><code>Multimap&lt;K, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s 由</font></font><code>Seq&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作为默认值容器支持。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列可以映射到 Vavr 的</font></font><code>Option&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元组投影</font><font style="vertical-align: inherit;">！</font><font style="vertical-align: inherit;">耶！</font><font style="vertical-align: inherit;">Vavr 提供最多 8 个元组的元组。您可以将查询结果映射到，例如</font></font><code>Tuple3&lt;Integer, String, Long&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您选择的列数多于投影的数量，则将使用该索引之前的列。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用该插件，请添加 Maven 依赖项：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jdbi<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>jdbi3-vavr<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目前支持和测试 Vavr &gt;= 0.9.0。</font><font style="vertical-align: inherit;">该插件提取了受支持的 Vavr 版本并准备好使用。</font><font style="vertical-align: inherit;">与其他插件一样：通过</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例</font><font style="vertical-align: inherit;">安装</font><font style="vertical-align: inherit;">或使用自动安装。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">jdbi.installPlugin(<span class="keyword">new</span> VavrPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下是上述功能的一些使用示例：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> query = <span class="string"><span class="delimiter">"</span><span class="content">select * from users where :name is null or name = :name</span><span class="delimiter">"</span></span>;
<span class="predefined-type">Option</span>&lt;<span class="predefined-type">String</span>&gt; param = <span class="predefined-type">Option</span>.of(<span class="string"><span class="delimiter">"</span><span class="content">eric</span><span class="delimiter">"</span></span>);<font></font>
<font></font>
<span class="comment">// will fetch first user with given name or first user with any name (Option.none)</span>
<span class="keyword">return</span> handle.createQuery(query)<font></font>
        .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, param)<font></font>
        .mapToBean(User.class)<font></font>
        .findFirst();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中</font></font><code>param</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是一种</font></font><code>Option&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Either&lt;L, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Lazy&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Try&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或</font></font><code>Validation&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请注意，在这些类型的情况下，嵌套值必须“存在”，否则将使用</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（例如 for</font></font><code>Either.Left</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
</font></font><code>Validation.Invalid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from users</span><span class="delimiter">"</span></span>)<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;Seq&lt;<span class="predefined-type">String</span>&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这适用于所有支持的集合类型。</font><font style="vertical-align: inherit;">将使用</font><font style="vertical-align: inherit;">已安装在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 中</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的嵌套值行和列映射器</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，如果列可以为空，以下内容将起作用并且有意义：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select middle_name from users</span><span class="delimiter">"</span></span>) <span class="comment">// nulls incoming!</span>
        .collectInto(<span class="keyword">new</span> GenericType&lt;Seq&lt;<span class="predefined-type">Option</span>&lt;<span class="predefined-type">String</span>&gt;&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该插件将遵守为</font></font><code>Map&lt;K, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和</font></font><code>Multimap&lt;K, T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回类型</font><font style="vertical-align: inherit;">配置的键和值列</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在下一个示例中，我们将按用户的姓名作为关键用户，这不一定是唯一的。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Multimap&lt;<span class="predefined-type">String</span>, User&gt; usersByName = handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select * from users</span><span class="delimiter">"</span></span>)<font></font>
        .setMapKeyColumn(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>)<font></font>
        .collectInto(<span class="keyword">new</span> GenericType&lt;Multimap&lt;<span class="predefined-type">String</span>, User&gt;&gt;() {});</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后但并非最不重要的是，我们现在可以将简单的查询投射到 Vavr 元组，如下所示：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// given a 'tuples' table with t1 int, t2 varchar, t3 varchar, ...</span>
<span class="predefined-type">List</span>&lt;Tuple3&lt;<span class="predefined-type">Integer</span>, <span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt; tupleProjection = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select t1, t2, t3 from tuples</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(<span class="keyword">new</span> GenericType&lt;Tuple3&lt;<span class="predefined-type">Integer</span>, <span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
        .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只要注册了行映射器，您还可以将复杂类型投影到元组中。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// given that there are row mappers registered for both complex types</span><font></font>
Tuple2&lt;City, Address&gt; tupleProjection = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select cityname, zipcode, street, housenumber from </span><span class="delimiter">"</span></span> +
            <span class="string"><span class="delimiter">"</span><span class="content">addresses where user_id = 1</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(<span class="keyword">new</span> GenericType&lt;Tuple2&lt;City, Address&gt;&gt;() {})<font></font>
        .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您想混合复杂类型和简单类型，我们也可以满足您的需求。</font><font style="vertical-align: inherit;">使用</font></font><code>TupleMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该类，您可以配置您的投影。（实际上，您必须阅读以下内容！）</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.configure(TupleMappers.class, c -&gt;<font></font>
        c.setColumn(<span class="integer">2</span>, <span class="string"><span class="delimiter">"</span><span class="content">street</span><span class="delimiter">"</span></span>).setColumn(<span class="integer">3</span>, <span class="string"><span class="delimiter">"</span><span class="content">housenumber</span><span class="delimiter">"</span></span>));<font></font>
<font></font>
Tuple3&lt;City, <span class="predefined-type">String</span>, <span class="predefined-type">Integer</span>&gt; result = handle<font></font>
        .createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select cityname, zipcode, street, housenumber from </span><span class="delimiter">"</span></span> +
             <span class="string"><span class="delimiter">"</span><span class="content">addresses where user_id = 1</span><span class="delimiter">"</span></span>)<font></font>
        .mapTo(<span class="keyword">new</span> GenericType&lt;Tuple3&lt;City, <span class="predefined-type">String</span>, <span class="predefined-type">Integer</span>&gt;&gt;() {})<font></font>
        .one();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记住：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的配置是基于 1 的，因为它们反映了元组的值（您可以通过 eg 查询</font></font><code>._1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元组总是完全按列映射或完全通过行映射器映射。</font><font style="vertical-align: inherit;">如果你想混合行映射类型和单列映射，
</font></font><code>TupleMappers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须正确配置，即所有非行映射元组索引必须提供列配置！</font></font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cookbook"><a class="anchor" href=" #_cookbook"></a><a class="link" href=" #_cookbook"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. 食谱</font></font></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本节包括您可能喜欢使用的各种事情的示例</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="sect2">
<h3 id="_simple_dependency_injection"><a class="anchor" href=" #_simple_dependency_injection"></a><a class="link" href=" #_simple_dependency_injection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.1. </font><font style="vertical-align: inherit;">简单的依赖注入</font></font></a></h3>
<div class="paragraph">
<p><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">试图独立于使用依赖注入框架，但集成你的框架很简单。</font><font style="vertical-align: inherit;">只需对简单的自定义配置类型进行字段注入：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">InjectedDependencies</span> <span class="directive">implements</span> JdbiConfig&lt;InjectedDependencies&gt; {
    <span class="annotation">@Inject</span><font></font>
    SomeDependency dep;<font></font>
<font></font>
    <span class="directive">public</span> InjectedDependencies() {}<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> InjectedDependencies createCopy() {
        <span class="keyword">return</span> <span class="local-variable">this</span>; <span class="comment">// effectively immutable</span><font></font>
    }<font></font>
}<font></font>
<font></font>
Jdbi jdbi = Jdbi.create(myDataSource);<font></font>
myIoC.inject(jdbi.getConfig(InjectedDependencies.class));<font></font>
<font></font>
<span class="comment">// Then, in any component that needs to access it:</span>
getHandle().getConfig(InjectedDependencies.class).dep</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_like_clauses_with_parameters"><a class="anchor" href=" #_like_clauses_with_parameters"></a><a class="link" href=" #_like_clauses_with_parameters"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.2. </font><font style="vertical-align: inherit;">带参数的 LIKE 子句</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于 JDBC（因此</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）不允许将参数绑定到字符串文字的中间，因此您不能将绑定插入到</font></font><code>LIKE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句 ( </font></font><code>LIKE '%:param%'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) 中。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误用法：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from things where name like '%:search%'</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">search</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .list()</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此查询将尝试按</font></font><code>where name like '%:search%'</code> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字面意思</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font><font style="vertical-align: inherit;">，而不绑定任何参数。</font><font style="vertical-align: inherit;">这是因为 JDBC 驱动程序不会</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在字符串文字中</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绑定参数</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然而，它永远不会那么远——这个查询将抛出一个异常，因为我们默认不允许未使用的参数绑定。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解决方案是使用 SQL 字符串连接：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select name from things where name like '%' || :search || '%'</span><span class="delimiter">"</span></span>)<font></font>
    .bind(<span class="string"><span class="delimiter">"</span><span class="content">search</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="predefined-type">String</span>.class)<font></font>
    .list()</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，</font></font><code>search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以正确地将其作为参数绑定到语句中，并且一切都按预期工作。</font></font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在执行此操作之前，请检查数据库的字符串连接语法。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_topics"><a class="anchor" href=" #_advanced_topics"></a><a class="link" href=" #_advanced_topics"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. 进阶课题</font></font></a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_high_availability"><a class="anchor" href=" #_high_availability"></a><a class="link" href=" #_high_availability"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.1. </font><font style="vertical-align: inherit;">高可用性</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 可以与数据库驱动程序中的连接池和高可用性功能结合使用。</font><font style="vertical-align: inherit;">我们已经将</font></font><a href="https://brettwooldridge.github.io/HikariCP/" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HikariCP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a href="https://jdbc.postgresql.org/documentation/head/connect.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PgJDBC 连接负载平衡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能</font><font style="vertical-align: inherit;">结合使用</font><font style="vertical-align: inherit;">并取得了成功。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PGSimpleDataSource ds = <span class="keyword">new</span> PGSimpleDataSource();<font></font>
ds.setServerName(<span class="string"><span class="delimiter">"</span><span class="content">host1,host2,host3</span><span class="delimiter">"</span></span>);<font></font>
ds.setLoadBalanceHosts(<span class="predefined-constant">true</span>);<font></font>
HikariConfig hc = <span class="keyword">new</span> HikariConfig();<font></font>
hc.setDataSource(ds);<font></font>
hc.setMaximumPoolSize(<span class="integer">6</span>);<font></font>
Jdbi jdbi = Jdbi.create(<span class="keyword">new</span> HikariDataSource(hc)).installPlugin(<span class="keyword">new</span> PostgresPlugin());</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个 Jdbi 可能由任意数量的主机池支持，但连接应该都是相似的。</font><font style="vertical-align: inherit;">具体哪些参数必须保持不变，哪些可能会有所不同取决于您的数据库和驱动程序。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您想要有两个单独的池，例如一个连接到只读副本的只读集和一个仅连接到单个主机的较小的写入器池，您目前应该有单独的
</font></font><code>Jdbi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例，每个实例指向一个单独的</font></font><code>DataSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_compiling_with_parameter_names"><a class="anchor" href=" #_compiling_with_parameter_names"></a><a class="link" href=" #_compiling_with_parameter_names"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2. </font><font style="vertical-align: inherit;">使用参数名称编译</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，Java 编译器不会将构造函数和方法的参数名称写入类文件。</font><font style="vertical-align: inherit;">在运行时，反射性地询问参数名称会给出类似“arg0”、“arg1”等的值。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即用，Jdbi 使用注释来了解每个参数的名称，例如：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ConstructorMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>@ConstructorProperties</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象方法参数使用</font></font><code>@Bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释。</font></font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>) <span class="type">long</span> id, <span class="annotation">@Bind</span>(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> name); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如此冗长，非常样板。</font><font style="vertical-align: inherit;">哇。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您使用编译</font></font><code>-parameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">器标志</font><font style="vertical-align: inherit;">编译代码</font><font style="vertical-align: inherit;">，则不需要这些注释——Jdbi 自动使用方法参数名称：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlUpdate</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into users (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
<span class="type">void</span> insert(<span class="type">long</span> id, <span class="predefined-type">String</span> name);</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_maven_setup"><a class="anchor" href=" #_maven_setup"></a><a class="link" href=" #_maven_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.1. </font><font style="vertical-align: inherit;">Maven 设置</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"></font><code>maven-compiler-plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在你的 POM 中</font><font style="vertical-align: inherit;">配置</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;compilerArgs&gt;</span>
      <span class="tag">&lt;arg&gt;</span>-parameters<span class="tag">&lt;/arg&gt;</span>
    <span class="tag">&lt;/compilerArgs&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_intellij_idea_setup"><a class="anchor" href=" #_intellij_idea_setup"></a><a class="link" href=" #_intellij_idea_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.2. </font><font style="vertical-align: inherit;">IntelliJ IDEA 设置</font></font></a></h4>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件 → 设置</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建、执行、部署 → 编译器 → Java 编译器</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">额外的命令行参数： </font></font><code>-parameters</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击应用，然后单击确定。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建 → 重建项目</font></font></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_eclipse_setup"><a class="anchor" href=" #_eclipse_setup"></a><a class="link" href=" #_eclipse_setup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2.3. </font><font style="vertical-align: inherit;">日食设置</font></font></a></h4>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗口 → 首选项</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java → 编译器</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在“类文件生成”下，选中“存储有关方法参数的信息（可通过反射使用）”选项。</font></font></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_generic_types"><a class="anchor" href=" #_working_with_generic_types"></a><a class="link" href=" #_working_with_generic_types"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3. </font><font style="vertical-align: inherit;">使用泛型类型</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 提供了实用程序类，以便更轻松地使用 Java 泛型类型。</font></font></p>
</div>
<div class="sect3">
<h4 id="_generictype"><a class="anchor" href=" #_generictype"></a><a class="link" href=" #_generictype"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3.1. </font><font style="vertical-align: inherit;">通用类型</font></font></a></h4>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/generic/GenericType.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示可以以类型安全的方式传递的泛型类型签名。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过实例化匿名内部类来创建泛型类型引用：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">new</span> GenericType&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt;() {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将此类型引用传递给任何接受 的 Jdbi 方法
</font></font><code>GenericType&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，例如：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt; middleNames = handle<font></font>
    .select(<span class="string"><span class="delimiter">"</span><span class="content">select middle_name from contacts</span><span class="delimiter">"</span></span>)<font></font>
    .mapTo(<span class="keyword">new</span> GenericType&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt;() {})<font></font>
    .list();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code>GenericType.getType()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回原始
</font></font><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Type.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java.lang.reflect.Type</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于表示Java泛型对象。</font></font></p>
</div>
</div>
<div class="sect3">
<h4 id="_generictypes"><a class="anchor" href=" #_generictypes"></a><a class="link" href=" #_generictypes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3.2. </font><font style="vertical-align: inherit;">泛型类型</font></font></a></h4>
<div class="paragraph">
<p><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/generic/GenericTypes.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericTypes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供了处理 Java 泛型类型签名的方法。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在所有方法</font></font><code>GenericTypes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来讲操作</font></font><code>java.lang.reflect.Type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>getErasedType(Type)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法接受 a</font></font><code>Type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回该</font></font><code>Class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类型</font><font style="vertical-align: inherit;">的原始</font><font style="vertical-align: inherit;">值，并删除所有泛型参数：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Type</span> listOfInteger = <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt;&gt;() {}.getType();<font></font>
GenericTypes.getErasedType(listOfInteger); <span class="comment">// =&gt; List.class</span><font></font>
<font></font>
GenericTypes.getErasedType(<span class="predefined-type">String</span>.class); <span class="comment">// =&gt; String.class</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>resolveType(Type, Type)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法采用泛型类型和解析它的上下文类型。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，给定</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自</font><font style="vertical-align: inherit;">的类型变量</font></font><code>Optional&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Type</span> t = Optional.class.getTypeParameters()[<span class="integer">0</span>];</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并给出上下文类型</font></font><code>Optional&lt;String&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Type</span> optionalOfString = <span class="keyword">new</span> GenericType&lt;Optional&lt;<span class="predefined-type">String</span>&gt;&gt;() {}.getType();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>resolveType()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法回答了以下问题：“在 Optional&lt;String&gt; 类型的上下文中，什么是类型 T？”</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GenericTypes.resolveType(t, optionalOfString);
<span class="comment">// =&gt; String.class</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种解析某个泛型超类型的第一个类型参数的场景非常常见，我们为它制作了一个单独的方法：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GenericTypes.findGenericParameter(optionalOfString, Optional.class);
<span class="comment">// =&gt; Optional.of(String.class)</span><font></font>
<font></font>
<span class="predefined-type">Type</span> listOfInteger = <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt;&gt;() {}.getType();<font></font>
GenericTypes.findGenericParameter(listOfInteger, <span class="predefined-type">Collection</span>.class);
<span class="comment">// =&gt; Optional.of(Integer.class)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font><code>Optional.empty()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果无法解析类型参数，或者类型彼此无关，则</font><font style="vertical-align: inherit;">此方法将返回</font><font style="vertical-align: inherit;">：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GenericTypes.findGenericParameter(optionalOfString, <span class="predefined-type">List</span>.class);
<span class="comment">// =&gt; Optional.empty();</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_namedargumentfinder"><a class="anchor" href=" #_namedargumentfinder"></a><a class="link" href=" #_namedargumentfinder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.4. </font><font style="vertical-align: inherit;">命名参数查找器</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/argument/NamedArgumentFinder" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NamedArgumentFinder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接口，顾名思义，通过名字从一些源找到论据。</font><font style="vertical-align: inherit;">通常，单个</font></font><code>NamedArgumentFinder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例将为几个不同的名称提供参数。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在情况下，既没有</font></font><code>bindBean()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>bindFields()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>bindMethods()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也不
</font></font><code>bindMap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个不错的选择，你可以实现自己</font></font><code>NamedArgumentFinder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和绑定，与其提取并分别结合各自的说法。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Cache cache = ... <span class="comment">// e.g. Guava Cache</span><font></font>
NamedArgumentFinder cacheFinder = (name, ctx) -&gt;<font></font>
    Optional.ofNullable(cache.getIfPresent(name))<font></font>
            .map(value -&gt; ctx.findArgumentFor(<span class="predefined-type">Object</span>.class, value));<font></font>
<font></font>
stmt.bindNamedArgumentFinder(cacheFinder);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html#bindBean-java.lang.Object-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幕后</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html#bindBean-java.lang.Object-" target="_blank" rel="noopener"><font style="vertical-align: inherit;">SqlStatement.bindBean()</font></a><font style="vertical-align: inherit;">、
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html#bindMethods-java.lang.Object-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement.bindMethods()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、
 </font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html#bindFields-java.lang.Object-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement.bindFields()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html#bindMap-java.util.Map-" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement.bindMap()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法只是分别</font></font><code>NamedArgumentFinder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为 bean、方法、字段和映射</font><font style="vertical-align: inherit;">创建和绑定自定义实现
</font><font style="vertical-align: inherit;">。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_jdbiconfig"><a class="anchor" href=" #_jdbiconfig"></a><a class="link" href=" #_jdbiconfig"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.5. </font><font style="vertical-align: inherit;">配置文件</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置由</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/ConfigRegistry.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfigRegistry</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类</font><font style="vertical-align: inherit;">管理
</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个代表不同数据库上下文的 Jdbi 对象（例如，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身、一个</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handle</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例或附加的 SqlObject 类）都有自己的配置注册表。</font><font style="vertical-align: inherit;">大多数上下文实现了</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/Configurable.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口，</font><font style="vertical-align: inherit;">该
</font><font style="vertical-align: inherit;">接口允许修改其配置以及检索当前上下文的配置以供 Jdbi 核心或扩展使用。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建新的可配置上下文时，它会在创建时继承其父配置的副本 - 对原始配置的进一步修改不会影响已创建的配置上下文。</font><font style="vertical-align: inherit;">当从 Jdbi 生成 Handle、从 Handle 打开</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以及附加或创建按需扩展（例如</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlObject ）</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时
</font><font style="vertical-align: inherit;">，会发生配置上下文复制</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置本身存储在</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/JdbiConfig.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JdbiConfig</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口的</font><font style="vertical-align: inherit;">各种实现中
</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个实现都必须遵守接口的约定；</font><font style="vertical-align: inherit;">特别是它必须有一个提供有用默认值的公共无参数构造函数和一个</font><font style="vertical-align: inherit;">在配置注册表被克隆时调用</font><font style="vertical-align: inherit;">的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">createCopy</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，应该在使用上下文之前在上下文上设置配置，并且以后不要更改。</font><font style="vertical-align: inherit;">一些配置类可能是线程安全的，但大多数不是。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 的许多核心功能，例如参数或映射器注册表，只是</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JdbiConfig 的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现，</font><font style="vertical-align: inherit;">用于存储已注册的映射以供以后在查询执行期间使用。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ExampleConfig</span> <span class="directive">implements</span> JdbiConfig&lt;ExampleConfig&gt; {<font></font>
<font></font>
    <span class="directive">private</span> <span class="predefined-type">String</span> color;
    <span class="directive">private</span> <span class="type">int</span> number;<font></font>
<font></font>
    <span class="directive">public</span> ExampleConfig() {<font></font>
        color = <span class="string"><span class="delimiter">"</span><span class="content">purple</span><span class="delimiter">"</span></span>;<font></font>
        number = <span class="integer">42</span>;<font></font>
    }<font></font>
<font></font>
    <span class="directive">private</span> ExampleConfig(ExampleConfig other) {
        <span class="local-variable">this</span>.color = other.color;
        <span class="local-variable">this</span>.number = other.number;<font></font>
    }<font></font>
<font></font>
    <span class="directive">public</span> ExampleConfig setColor(<span class="predefined-type">String</span> color) {
        <span class="local-variable">this</span>.color = color;
        <span class="keyword">return</span> <span class="local-variable">this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="directive">public</span> <span class="predefined-type">String</span> getColor() {
        <span class="keyword">return</span> color;<font></font>
    }<font></font>
<font></font>
    <span class="directive">public</span> ExampleConfig setNumber(<span class="type">int</span> number) {
        <span class="local-variable">this</span>.number = number;
        <span class="keyword">return</span> <span class="local-variable">this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="directive">public</span> <span class="type">int</span> getNumber() {
        <span class="keyword">return</span> number;<font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ExampleConfig createCopy() {
        <span class="keyword">return</span> <span class="keyword">new</span> ExampleConfig(<span class="local-variable">this</span>);<font></font>
    }<font></font>
<font></font>
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_custom_jdbiconfig_type"><a class="anchor" href=" #_creating_a_custom_jdbiconfig_type"></a><a class="link" href=" #_creating_a_custom_jdbiconfig_type"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.5.1. </font><font style="vertical-align: inherit;">创建自定义 JdbiConfig 类型</font></font></a></h4>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个实现 JdbiConfig 的公共类。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加一个公共的、无参数的构造函数</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加私有的复制构造函数。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font></font><code>createCopy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用复制构造函数。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加配置属性，并为每个属性提供合理的默认值。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确保所有配置属性都被复制到复制构造函数中的新实例。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"></font><code>setConfig(ConfigRegistry)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您的配置类希望能够使用注册表中的其他配置类，请</font><font style="vertical-align: inherit;">覆盖</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如 RowMappers 注册表委托给 ColumnMappers 注册表，如果它没有为给定类型注册的映射器。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用来自对其感兴趣的其他类的配置对象。</font></font></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如 BeanMapper、FieldMapper 和 ConstructorMapper 都使用 ReflectionMappers 配置类来保持通用配置。</font></font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jdbiplugin"><a class="anchor" href=" #_jdbiplugin"></a><a class="link" href=" #_jdbiplugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.6. </font><font style="vertical-align: inherit;">插件</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JdbiPlugin 可用于捆绑批量配置。</font><font style="vertical-align: inherit;">插件可以通过 显式安装</font></font><code>Jdbi.installPlugin(JdbiPlugin)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也可以通过使用 ServiceLoader 机制从类路径自动安装</font></font><code>installPlugins()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jars 可能会提供一个</font></font><code>META-INF/services/org.jdbi.v3.core.spi.JdbiPlugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
包含插件的完全限定类名的</font><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，Jdbi 的单独工件每个都提供一个相关的插件（例如</font></font><code>jdbi3-sqlite</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并且此类模块将是可自动加载的。</font><font style="vertical-align: inherit;">不提供（例如</font></font><code>jdbi3-commons-text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或多个（例如</font></font><code>jdbi3-core</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）插件的模块通常不会。</font></font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开发人员鼓励您明确安装插件。</font><font style="vertical-align: inherit;">对其使用的模块具有声明依赖关系的代码对重构更加健壮，并为静态分析工具提供关于使用或未使用哪些代码的有用数据。
</font></font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_statementcontext"><a class="anchor" href=" #_statementcontext"></a><a class="link" href=" #_statementcontext"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.7. </font><font style="vertical-align: inherit;">语句上下文</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/StatementContext.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StatementContext</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类是有关创建和未适当持有的语句执行中的各种状态下的载流子</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或其它特定的语句类本身。</font><font style="vertical-align: inherit;">除其他外，它拥有开放的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JDBC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资源、处理过的 SQL 语句和累积的绑定。</font><font style="vertical-align: inherit;">它暴露于大多数用户扩展点的实现，例如</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RowMapper、*ColumnMapper*s 或 *CollectorFactory</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StatementContext</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身不打算延长，一般扩展应该不需要变异的环境。</font><font style="vertical-align: inherit;">有关高级用法的更多信息，请阅读 JavaDoc。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_user_defined_annotations"><a class="anchor" href=" #_user_defined_annotations"></a><a class="link" href=" #_user_defined_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8. </font><font style="vertical-align: inherit;">用户定义的注释</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象旨在使用用户定义的注释进行扩展。</font><font style="vertical-align: inherit;">事实上，Jdbi 中提供的大多数注释都与下面概述的方法相关联。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象中有几种不同类别的注释，了解它们之间的区别很重要：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href=" #_statement_customizing_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statement Customizing Annotations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font><font style="vertical-align: inherit;">在执行之前</font><font style="vertical-align: inherit;">配置方法的底层
</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些只能在串联使用与像注解
</font></font><code>@SqlQuery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@SqlUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等，并没有关于默认方法的工作。</font></font></p>
</li>
<li>
<p><a href=" #_configuration_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置注释</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 在</font><font style="vertical-align: inherit;">SQL 对象或其方法之一的范围内</font><font style="vertical-align: inherit;">修改</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/ConfigRegistry.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfigRegistry</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">配置
</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><a href=" #_method_decorating_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法装饰注解</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">——用一些额外的行为装饰一个方法调用，例如</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解将方法调用包装在一个</font></font><code>handle.inTransaction()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用中。</font></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦您知道您想要哪种类型的注释，请继续下面的相应部分并按照指南进行设置。</font></font></p>
</div>
<div class="sect3">
<h4 id="_statement_customizing_annotations"><a class="anchor" href=" #_statement_customizing_annotations"></a><a class="link" href=" #_statement_customizing_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8.1. </font><font style="vertical-align: inherit;">语句自定义注解</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 语句自定义注释用于对</font><font style="vertical-align: inherit;">与 SQL 方法关联</font><font style="vertical-align: inherit;">的</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用一些更改
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，这些注释与核心中的 API 方法相关。</font><font style="vertical-align: inherit;">例如</font></font><code>@Bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对应于</font></font><code>SqlStatement.bind()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>@MaxRows</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对应于
</font></font><code>Query.setMaxRows()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义注释仅在</font><font style="vertical-align: inherit;">创建</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlStatement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后应用
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="paragraph">
<p>You can create your own SQL statement customizing annotations and attach runtime
behavior to them.</p>
</div>
<div class="paragraph">
<p>First, create an annotation that you want to attach a statement customization
to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER}) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="annotation">@interface</span> MaxRows {
  <span class="type">int</span> value();<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td>All statement customizing annotations should have a <code>RUNTIME</code> retention
policy.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td>Statement customizing annotations only work on types, methods, or
parameters. Strictly speaking, the <code>@Target</code> annotation is not required, but
it’s a good practice to include it, so that annotations can only be applied
where they will actually do something.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Placing a customizing annotation on a type means "apply this customization to
every method."</p>
</div>
<div class="paragraph">
<p>When used on parameters, annotations may use the argument passed to the method
while processing the annotation.</p>
</div>
<div class="paragraph">
<p>Next, we write an implementation of the
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementCustomizerFactory.html" target="_blank" rel="noopener">SqlStatementCustomizerFactory</a>
class, to process the annotation and apply the customization to the statement.</p>
</div>
<div class="paragraph">
<p>The <code>SqlStatementCustomizerFactory</code> produces two different types of "statement
customizer" command objects:
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementCustomizer.html" target="_blank" rel="noopener">SqlStatementCustomizer</a>
(for annotations on types or methods), and
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementParameterCustomizer.html" target="_blank" rel="noopener">SqlStatementParameterCustomizer</a>
(for annotations on method parameters).</p>
</div>
<div class="paragraph">
<p>Let’s implement a statement customizer factory for our annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MaxRowsFactory</span> <span class="directive">implements</span> SqlStatementCustomizerFactory {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> SqlStatementCustomizer createForType(<span class="predefined-type">Annotation</span> annotation,
                                                <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType) {
        <span class="directive">final</span> <span class="type">int</span> maxRows = ((MaxRows)annotation).value(); <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">return</span> stmt -&gt; ((<span class="predefined-type">Query</span>)stmt).setMaxRows(maxRows); <i class="conum" data-value="2"></i><b>(2)</b><font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> SqlStatementCustomizer createForMethod(<span class="predefined-type">Annotation</span> annotation,
                                                  <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType,
                                                  <span class="predefined-type">Method</span> method) {
        <span class="keyword">return</span> createForType(annotation, sqlObjectType); <i class="conum" data-value="3"></i><b>(3)</b><font></font>
    }<font></font>
<font></font>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> SqlStatementParameterCustomizer createForParameter(<span class="predefined-type">Annotation</span> annotation,
                                                              <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType,
                                                              <span class="predefined-type">Method</span> method,<font></font>
                                                              Parameter param,<font></font>
                                                              <span class="type">int</span> index,
                                                              <span class="predefined-type">Type</span> type) {
        <span class="keyword">return</span> (stmt, maxRows) -&gt; ((<span class="predefined-type">Query</span>)stmt).setMaxRows((<span class="predefined-type">Integer</span>) maxRows); <i class="conum" data-value="4"></i><b>(4)</b><font></font>
    }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td>Extract the max rows from the annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementCustomizer.html" target="_blank" rel="noopener">SqlStatementCustomizer</a>
can be implemented as a lambda—​it receives a
<a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlStatement.html" target="_blank" rel="noopener">SqlStatement</a> as a
parameter, calls whatever method it wants on the statement, and returns
void.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td>Since the customization for this annotation is the same at the method level
as at the type level, we simply delegate to the type-level method for
brevity.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b></td>
<td><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementParameterCustomizer.html" target="_blank" rel="noopener">SqlStatementParameterCustomizer</a>
can also be implemented as a lambda. It accepts a <code>SqlStatement</code> and the
value that was passed into the method on the annotated parameter.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Finally, add the
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/customizer/SqlStatementCustomizingAnnotation.html" target="_blank" rel="noopener">@SqlStatementCustomizingAnnotation</a>
annotation the <code>@MaxRows</code> annotation type. This tells Jdbi that <code>MaxRowsFactory</code>
implements the behavior of the <code>@MaxRows</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlStatementCustomizingAnnotation</span>(MaxRowsFactory.class)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER})
<span class="directive">public</span> <span class="annotation">@interface</span> MaxRows {
    <span class="type">int</span> value() <span class="keyword">default</span> -<span class="integer">1</span>;<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your statement customizing annotation is now ready to use on any SQL object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Dao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from contacts</span><span class="delimiter">"</span></span>)
  <span class="annotation">@MaxRows</span>(<span class="integer">100</span>)
  <span class="predefined-type">List</span>&lt;Contact&gt; list();<font></font>
<font></font>
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from contacts</span><span class="delimiter">"</span></span>)
  <span class="predefined-type">List</span>&lt;Contact&gt; list(<span class="annotation">@MaxRows</span> <span class="type">int</span> maxRows);<font></font>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
We chose <code>@MaxRows</code> as an example here because it was easy to understand.
In practice, you will get better database performance by using a <code>LIMIT</code> clause
in your SQL statement than by using <code>@MaxRows</code>.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_annotations"><a class="anchor" href=" #_configuration_annotations"></a><a class="link" href=" #_configuration_annotations">9.8.2. Configuration Annotations</a></h4>
<div class="paragraph">
<p>Configuration annotations are used to apply some change to the
<a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/ConfigRegistry.html" target="_blank" rel="noopener">ConfigRegistry</a> associated with
a SQL object or method.</p>
</div>
<div class="paragraph">
<p>Typically these annotations correlate to a method of
<a href="http://jdbi.org/apidocs/org/jdbi/v3/core/config/Configurable.html" target="_blank" rel="noopener">Configurable</a> (<code>Jdbi</code>,
<code>Handle</code>, and <code>SqlStatement</code> all implement this interface). For example,
<code>@RegisterColumnMapper</code> correlates to <code>Configurable.registerColumnMapper()</code>.</p>
</div>
<div class="paragraph">
<p>You can create your own configuration annotations, and attach runtime behavior
to them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write a new configuration annotation, with any attributes you need.</p>
</li>
<li>
<p>Write an implementation of
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/config/Configurer.html" target="_blank" rel="noopener">Configurer</a> which performs
the configuration associated with your annotation.</p>
</li>
<li>
<p>Add the <code>@ConfiguringAnnotation</code> annotation to your configuration annotation
type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the above steps completed, Jdbi will invoke your configurer whenever it
encounters the associated annotation.</p>
</div>
<div class="paragraph">
<p>Let’s re-implement one of Jdbi’s built-in annotations as an example:</p>
</div>
<div class="paragraph">
<p>The <code>@RegisterColumnMapper</code> annotation has an attribute to specify the class of
the column mapper to register. Wherever the annotation is used, we want Jdbi to
create an instance of that mapper type, and register it with the config
registry.</p>
</div>
<div class="paragraph">
<p>First, let’s create the new annotation type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD}) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="annotation">@interface</span> RegisterColumnMapper{
  <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ColumnMapper&lt;?&gt;&gt; value();<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td>All configuration annotations should have a <code>RUNTIME</code> retention policy.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td>Configuration annotations only work on types and methods. Strictly speaking,
the <code>@Target</code> annotation is not required, but it’s a good practice to
include it, so that annotations can only be applied where they will actually
do something.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在类型上放置配置注释意味着“将此配置应用于每个方法”。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，我们编写</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/config/Configurer.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类</font><font style="vertical-align: inherit;">的实现
</font><font style="vertical-align: inherit;">，以处理注解并应用配置：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">RegisterColumnMapperImpl</span> <span class="directive">implements</span> Configurer {
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> configureForMethod(ConfigRegistry registry,
                                 <span class="predefined-type">Annotation</span> annotation,
                                 <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType,
                                 <span class="predefined-type">Method</span> method) {<font></font>
    configure(registry, (RegisterColumnMapper) annotation);<font></font>
  }<font></font>
<font></font>
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> configureForType(ConfigRegistry registry,
                               <span class="predefined-type">Annotation</span> annotation,
                               <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType) {<font></font>
    configure(registry, (RegisterColumnMapper) annotation);<font></font>
  }<font></font>
<font></font>
  <span class="directive">private</span> <span class="type">void</span> configure(ConfigRegistry registry,<font></font>
                         RegisterColumnMapper registerColumnMapper) { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="keyword">try</span> {
      <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ColumnMapper&gt; mapperType = registerColumnMapper.value();<font></font>
      ColumnMapper mapper = mapperType.getConstructor().newInstance();<font></font>
      registry.get(ColumnMappers.class).register(mapper);<font></font>
    }<font></font>
    <span class="keyword">catch</span> (<span class="exception">NoSuchMethodException</span> e) {
      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">"</span><span class="content">Cannot construct </span><span class="delimiter">"</span></span> + mapperType, e);<font></font>
    }<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此示例中，我们将应用相同的配置，无论
</font></font><code>@RegisterColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释是用于 SQL 对象类型还是方法。</font><font style="vertical-align: inherit;">然而，这不是必需的——一些注解可能会根据注解是放在类型上还是方法上来选择应用不同的配置。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于只有一个目标的配置注解（例如</font></font><code>@KeyColumn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
</font></font><code>@ValueColumn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能只应用于方法），您只需要实现</font></font><code>Configurer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适合注解目标</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">方法。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，将</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/config/ConfiguringAnnotation.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ConfiguringAnnotation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注释</font><font style="vertical-align: inherit;">添加
</font><font style="vertical-align: inherit;">到您的</font></font><code>@RegisterColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释类型中。</font><font style="vertical-align: inherit;">这告诉 Jdbi
</font></font><code>RegisterColumnMapperImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font></font><code>@RegisterColumnMapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释</font><font style="vertical-align: inherit;">的行为
</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ConfiguringAnnotation</span>(RegisterColumnMapperImpl.class)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD})
<span class="directive">public</span> <span class="annotation">@interface</span> RegisterColumnMapper {
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> TemplateEngine&gt; value();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的配置注释现在可以在任何 SQL 对象中使用：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AccountDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select balance from accounts where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@RegisterColumnMapper</span>(MoneyMapper.class)
  <span class="directive">public</span> Money getBalance(<span class="type">long</span> accountId);<font></font>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_method_decorating_annotations"><a class="anchor" href=" #_method_decorating_annotations"></a><a class="link" href=" #_method_decorating_annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8.3. </font><font style="vertical-align: inherit;">方法装饰注解</font></font></a></h4>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法修饰注解用于通过附加（或替代）行为增强 SQL 对象方法。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在内部，SQL Object 用</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/Handler.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口</font><font style="vertical-align: inherit;">的实例表示每个方法的行为</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每次在 SQL 对象实例上调用方法时，都会通过执行给定方法的处理程序来执行该方法。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您使用装饰注释（如</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，方法的常规处理程序被包装在另一个处理程序中，该处理程序可能会在将调用传递给原始处理程序之前和/或之后执行某些操作。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">装饰器甚至可以执行一些操作</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用原始操作，例如缓存注释。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们重新实现</font></font><code>@Transaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解，看看它是如何工作的：</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，创建注释类型：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.METHOD) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="annotation">@interface</span> Transaction {<font></font>
    TransactionIsolationLevel value();<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有装饰注释都应该有一个</font></font><code>RUNTIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保留策略。</font></font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">装饰注解仅适用于类型和方法。</font><font style="vertical-align: inherit;">严格来说，</font></font><code>@Target</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解不是必需的，但包含它是一个很好的做法，这样注解只能应用于它们实际会做某事的地方。</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Placing a decorating annotation on a type means "apply this decoration to every
method."</p>
</div>
<div class="paragraph">
<p>Next we write an implementation of the
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/HandlerDecorator.html" target="_blank" rel="noopener">HandlerDecorator</a> interface, to
process the annotation and apply the decoration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TransactionDecorator</span> <span class="directive">implements</span> HandlerDecorator {
  <span class="directive">public</span> <span class="predefined-type">Handler</span> decorateHandler(<span class="predefined-type">Handler</span> base,
                                 <span class="predefined-type">Class</span>&lt;?&gt; sqlObjectType,
                                 <span class="predefined-type">Method</span> method) {<font></font>
    Transaction anno = method.getAnnotation(Transaction.class); <i class="conum" data-value="1"></i><b>(1)</b>
    TransactionIsolationLevel isolation = anno.value(); <i class="conum" data-value="2"></i><b>(2)</b><font></font>
<font></font>
    <span class="keyword">return</span> (target, args, handleSupplier) -&gt; handleSupplier.getHandle() <i class="conum" data-value="3"></i><b>(3)</b><font></font>
        .inTransaction(isolation, h -&gt; base.invoke(target, args, handleSupplier));<font></font>
  }<font></font>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b></td>
<td>Get the <code>@Transaction</code> annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b></td>
<td>Extract the transaction isolation level from the annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b></td>
<td>The <code>Handler</code> interface accepts a target (the SQL Object instance being
invoked), an <code>Object[]</code> array of arguments passed to the method, and a
<code>HandleSupplier</code>.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Finally, add the
<a href="http://jdbi.org/apidocs/org/jdbi/v3/sqlobject/SqlMethodDecoratingAnnotation.html" target="_blank" rel="noopener">@SqlMethodDecoratingAnnotation</a>
annotation to your <code>@Transaction</code> annotation type. This tells Jdbi that
<code>TransactionDecorator</code> implements the behavior of the <code>@Transaction</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SqlMethodDecoratingAnnotation</span>(TransactionDecorator.class)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.METHOD)
<span class="directive">public</span> <span class="annotation">@interface</span> Transaction {<font></font>
    TransactionIsolationLevel value();<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your decorating annotation is now ready to use in any SQL object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ContactDao</span> {
  <span class="annotation">@SqlBatch</span>(<span class="string"><span class="delimiter">"</span><span class="content">insert into contacts (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)
  <span class="annotation">@Transaction</span>
  <span class="type">void</span> batchInsert(<span class="annotation">@BindBean</span> Contact... contacts);<font></font>
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_decorator_order"><a class="anchor" href=" #_decorator_order"></a><a class="link" href=" #_decorator_order">Decorator Order</a></h5>
<div class="paragraph">
<p>If a SQL object method has two or more decorating annotations applied, and the
order of decorations is important, use the <code>@DecoratorOrder</code> annotation. If no order
is declared, type decorators apply first, then method decorators, but the order is
not further specified.</p>
</div>
<div class="paragraph">
<p>For example, suppose a method were annotated both with <code>@Cached</code> and
<code>@Transaction</code> (just go with it..). We would probably want the <code>@Cached</code>
annotation to go first, so that transactions are not created unnecessarily when
the cache already contains the entry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ContactDao</span> {
  <span class="annotation">@SqlQuery</span>(<span class="string"><span class="delimiter">"</span><span class="content">select * from contacts where id = ?</span><span class="delimiter">"</span></span>)
  <span class="annotation">@Cached</span>
  <span class="annotation">@Transaction</span>
  <span class="annotation">@DecoratorOrder</span>(Cached.class, Transaction.class)<font></font>
  Contact getById(<span class="type">long</span> id);<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Decorator order is expressed from outermost to innermost.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_templateengine"><a class="anchor" href=" #_templateengine"></a><a class="link" href=" #_templateengine">9.9. TemplateEngine</a></h3>
<div class="paragraph">
<p>Jdbi uses a <a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/TemplateEngine.html" target="_blank" rel="noopener">TemplateEngine</a>
implementation to render templates into SQL. Template engines take a SQL
template string and the <code>StatementContext</code> as input, and produce a parseable
SQL string as output.</p>
</div>
<div class="paragraph">
<p>Out of the box, Jdbi is configured to use <code>DefinedAttributeTemplateEngine</code>,
which replaces angle-bracked tokens like <code>&lt;name&gt;</code> in your SQL statements with
the string value of the named attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> tableName = <span class="string"><span class="delimiter">"</span><span class="content">customers</span><span class="delimiter">"</span></span>;
<span class="predefined-type">Class</span>&lt;?&gt; entityClass = Customer.class;<font></font>
<font></font>
handle.createQuery(<span class="string"><span class="delimiter">"</span><span class="content">select &lt;columns&gt; from &lt;table&gt;</span><span class="delimiter">"</span></span>)<font></font>
      .define(<span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">customers</span><span class="delimiter">"</span></span>)<font></font>
      .defineList(<span class="string"><span class="delimiter">"</span><span class="content">columns</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>)<font></font>
      .mapToMap()<font></font>
      .list() <span class="comment">// =&gt; "select id, name from customers"</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content">
The <code>defineList</code> method defines a list of elements as the comma-separated
splice of String values of the individual elements. In the above example,
the <code>columns</code> attribute is defined as <code>"id, name"</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Any custom template engine can be used. Simply implement the <code>TemplateEngine</code>
interface, then call <code>setTemplateEngine()</code> on the <code>Jdbi</code>, <code>Handle</code>, or on a SQL
statement like <code>Update</code> or <code>Query</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TemplateEngine templateEngine = (template, ctx) -&gt; {<font></font>
  ...<font></font>
};<font></font>
<font></font>
jdbi.setTemplateEngine(templateEngine);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
Jdbi also provides <code>StringTemplateEngine</code>,
which renders templates using the StringTemplate library. See
<a href=" #_stringtemplate_4">StringTemplate 4</a>.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_sqlparser"><a class="anchor" href=" #_sqlparser"></a><a class="link" href=" #_sqlparser">9.10. SqlParser</a></h3>
<div class="paragraph">
<p>After the SQL template has been rendered, Jdbi uses a
<a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlParser.html" target="_blank" rel="noopener">SqlParser</a> to parse out any named
parameters from the SQL statement. This Produces a <code>ParsedSql</code> object, which
contains all the information Jdbi needs to bind parameters and execute your SQL
statement.</p>
</div>
<div class="paragraph">
<p>Out of the box, Jdbi is configured to use <code>ColonPrefixSqlParser</code>, which
recognizes colon-prefixed named parameters, e.g. <code>:name</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into characters (id, name) values (:id, :name)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">1</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Dolores Abernathy</span><span class="delimiter">"</span></span>)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Jdbi also provides <code>HashPrefixSqlParser</code>, which recognizes hash-prefixed
parameters, e.g. <code>#hashtag</code>. Use this parser by calling <code>setSqlParser()</code> on the
<code>Jdbi</code>, <code>Handle</code>, or any SQL statement such as <code>Query</code> or <code>Update</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">handle.setSqlParser(<span class="keyword">new</span> HashPrefixSqlParser());<font></font>
handle.createUpdate(<span class="string"><span class="delimiter">"</span><span class="content">insert into characters (id, name) values (#id, #name)</span><span class="delimiter">"</span></span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>, <span class="integer">2</span>)<font></font>
      .bind(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Teddy Flood</span><span class="delimiter">"</span></span>)<font></font>
      .execute();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content">
The default parsers recognize any Java identifier as a parameter or attribute name.
Even some strange cases like emoji are allowed, although the Jdbi authors encourage appropriate discretion 🧐.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="笔记"></i>
</td>
<td class="content"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
默认解析器会尝试忽略字符串字面量内部的类似参数的构造，因为 JDBC 驱动程序无论如何都不会让您在那里绑定参数。
</font></font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于阅读过</font></font><a href="https://www.amazon.com/Compilers-Principles-Techniques-Tools-2nd/dp/0321486811" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">龙之书的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无畏冒险者来说
</font><font style="vertical-align: inherit;">，任何自定义 SQL 解析器都可以使用。</font><font style="vertical-align: inherit;">只需实现</font></font><code>SqlParser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口，然后在 Jdbi、Handle 或 SQL 语句上设置它：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SqlParser parser = (sql, ctx) -&gt; {<font></font>
  ...<font></font>
};<font></font>
<font></font>
jdbi.setParser(parser);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sqllogger"><a class="anchor" href=" #_sqllogger"></a><a class="link" href=" #_sqllogger"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.11. </font><font style="vertical-align: inherit;">日志记录器</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/SqlLogger.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SqlLogger</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口之前和执行每个语句后调用，并考虑到目前</font></font><code>StatementContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，登录所需的任何相关信息：主要是在各个编译阶段的查询，属性和绑定，以及重要的时间戳。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个简单的</font></font><a href="http://jdbi.org/apidocs/org/jdbi/v3/core/statement/Slf4JSqlLogger.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slf4JSqlLogger</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实现，它记录所有已执行的语句以进行调试。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_resultproducer"><a class="anchor" href=" #_resultproducer"></a><a class="link" href=" #_resultproducer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.12. </font><font style="vertical-align: inherit;">结果生产者</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甲</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultProducer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要懒惰地供给</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的PreparedStatement</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并产生一个结果。</font><font style="vertical-align: inherit;">最常见的生产路径，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行（） </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">将检索</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在查询结果，然后使用
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultSetScanner</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或更高级别的映射器，以产生结果。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个示例替代用途是仅返回修改的行数，如在 UPDATE 或 INSERT 语句中：</font></font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> ResultProducer&lt;<span class="predefined-type">Integer</span>&gt; returningUpdateCount() {
    <span class="keyword">return</span> (statementSupplier, ctx) -&gt; {
        <span class="keyword">try</span> {
            <span class="keyword">return</span> statementSupplier.get().getUpdateCount();<font></font>
        } <span class="keyword">finally</span> {<font></font>
            ctx.close();<font></font>
        }<font></font>
    };<font></font>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您获得lazy 语句，您有责任确保最终关闭上下文以释放数据库资源。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数用户不需要实现</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResultProducer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_generator"><a class="anchor" href=" #_generator"></a><a class="link" href=" #_generator"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.13. </font><font style="vertical-align: inherit;">发电机</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdbi 包括一个实验性的 SqlObject 代码生成器。</font><font style="vertical-align: inherit;">如果您将</font></font><code>jdbi3-generator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工件</font><font style="vertical-align: inherit;">包含
</font><font style="vertical-align: inherit;">为注释处理器并使用 注释您的 SqlObject 定义</font></font><code>@GenerateSqlObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则生成器将生成一个实现类并避免使用</font></font><code>Proxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例。</font><font style="vertical-align: inherit;">这可能对</font></font><code>graal-native</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
编译</font><font style="vertical-align: inherit;">有用</font><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix"><a class="anchor" href=" #_appendix"></a><a class="link" href=" #_appendix"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. 附录</font></font></a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_best_practices"><a class="anchor" href=" #_best_practices"></a><a class="link" href=" #_best_practices"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1. </font><font style="vertical-align: inherit;">最佳实践</font></font></a></h3>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽可能针对真实数据库测试您的 SQL 对象 (DAO)。</font><font style="vertical-align: inherit;">Jdbi 试图采取防御措施，当你错误地把握住它时，它会急切地失败。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>-parameters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器标志来避免</font></font><code>@Bind("foo") String foo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象方法参数中的</font><font style="vertical-align: inherit;">所有这些
</font><font style="vertical-align: inherit;">冗余限定符。</font><font style="vertical-align: inherit;">请参阅</font></font><a href=" #_compiling_with_parameter_names"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用参数名称进行编译</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用分析器！</font><font style="vertical-align: inherit;">性能问题的真正根本原因往往是一个惊喜。</font><font style="vertical-align: inherit;">先测量，</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调整性能。</font><font style="vertical-align: inherit;">然后再次测量以确保它有所作为。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">别忘了带毛巾！</font></font></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_api_reference"><a class="anchor" href=" #_api_reference"></a><a class="link" href=" #_api_reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.2. </font><font style="vertical-align: inherit;">API 参考</font></font></a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://jdbi.org/apidocs/index.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Javadoc</font></font></a></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs-kotlin/jdbi3-kotlin/index.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin</font></font></a></p>
</li>
<li>
<p><a href="http://jdbi.org/apidocs-kotlin/jdbi3-kotlin-sqlobject/index.html" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi3-kotlin-sqlobject</font></font></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_projects"><a class="anchor" href=" #_related_projects"></a><a class="link" href=" #_related_projects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.3. </font><font style="vertical-align: inherit;">相关项目</font></font></a></h3>
<div class="paragraph">
<p><a href="https://github.com/opentable/otj-pg-embedded" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式 Postgres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使针对真实数据库的测试变得快速而简单。</font></font></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/arteam/dropwizard-jdbi3" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropwizard-jdbi3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提供与 DropWizard 的集成。</font></font></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/arteam/metrics-jdbi3" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">metrics-jdbi3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
工具使用 DropWizard-Metrics 来发出语句计时统计信息。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您知道与 Jdbi 相关的项目吗？</font><font style="vertical-align: inherit;">向我们发送问题，我们将在此处添加链接！</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_contributing"><a class="anchor" href=" #_contributing"></a><a class="link" href=" #_contributing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.4. </font><font style="vertical-align: inherit;">贡献</font></font></a></h3>
<div class="paragraph">
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 GitHub 进行协作。</font><font style="vertical-align: inherit;">请查看
</font></font><a href="https://github.com/jdbi/jdbi" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目页面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取更多信息。</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您有问题，我们有一个
</font></font><a href="https://groups.google.com/group/jdbi" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Group 邮件列表</font></font></a></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户有时会</font></font><a href="irc://irc.freenode.net/#jdbi" target="_blank" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Freenode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上
</font><a href="irc://irc.freenode.net/#jdbi" target="_blank" rel="noopener"><font style="vertical-align: inherit;">的 #jdbi 中的 IRC 上闲逛</font></a><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_upgrading_from_v2_to_v3"><a class="anchor" href=" #_upgrading_from_v2_to_v3"></a><a class="link" href=" #_upgrading_from_v2_to_v3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.5. </font><font style="vertical-align: inherit;">从 v2 升级到 v3</font></font></a></h3>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经在使用 Jdbi v2？</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下是帮助您升级的差异的快速摘要：</font></font></p>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maven 工件重命名和拆分：</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">老的： </font></font><code>org.jdbi:jdbi</code></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新：</font></font><code>org.jdbi:jdbi3-core</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>org.jdbi:jdbi3-sqlobject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根包重命名：</font></font><code>org.skife.jdbi.v2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→</font></font><code>org.jdbi.v3</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">核心API：</font></font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>IDBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→</font></font><code>Jdbi</code></p>
<div class="ulist">
<ul>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code>Jdbi.create()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工厂方法而不是构造函数进行</font><font style="vertical-align: inherit;">实例化</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>DBIException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> → </font></font><code>JdbiException</code></p>
</li>
<li>
<p><code>Handle.select(String, …​)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在返回 a</font></font><code>Query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于进一步的方法链接，而不是 a </font></font><code>List&lt;Map&lt;String, Object&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">调用
</font></font><code>Handle.select(sql, …​).mapToMap().list()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与 v2 相同的效果。</font></font></p>
</li>
<li>
<p><code>Handle.insert()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>Handle.update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已合并为
</font></font><code>Handle.execute()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
</li>
<li>
<p><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不再是通用的。</font></font></p>
</li>
<li>
<p><code>AbstractArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code>ArgumentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
处理单个参数类型的工厂</font><font style="vertical-align: inherit;">的通用实现</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p>Argument and mapper factories now operate in terms of
<code>java.lang.reflect.Type</code> instead of <code>java.lang.Class</code>. This allows Jdbi to
handle arguments and mappers for generic types.</p>
</li>
<li>
<p>Argument and mapper factories now have a single <code>build()</code> method that returns
an <code>Optional</code>, instead of separate <code>accepts()</code> and <code>build()</code> methods.</p>
</li>
<li>
<p><code>ResultSetMapper</code> → <code>RowMapper</code>. The row index parameter was also removed
from <code>RowMapper</code>--the current row number can be retrieved directly from the
<code>ResultSet</code>.</p>
</li>
<li>
<p><code>ResultColumnMapper</code> → <code>ColumnMapper</code></p>
</li>
<li>
<p><code>ResultSetMapperFactory</code> → <code>RowMapperFactory</code></p>
</li>
<li>
<p><code>ResultColumnMapperFactory</code> → <code>ColumnMapperFactory</code></p>
</li>
<li>
<p><code>Query</code> no longer maps to <code>Map&lt;String, Object&gt;</code> by default. Call
<code>Query.mapToMap()</code>, <code>.mapToBean(type)</code>, <code>.map(mapper)</code> or <code>.mapTo(type)</code>.</p>
</li>
<li>
<p><code>ResultBearing&lt;T&gt;</code> was refactored into <code>ResultBearing</code> (no generic parameter)
and <code>ResultIterable&lt;T&gt;</code>. Call <code>.mapTo(type)</code> to get a <code>ResultIterable&lt;T&gt;</code>.</p>
</li>
<li>
<p><code>TransactionConsumer</code> and <code>TransactionCallback</code> only take a <code>Handle</code> now—​the
<code>TransactionStatus</code> argument is removed. Just rollback the handle now.</p>
</li>
<li>
<p><code>TransactionStatus</code> class removed.</p>
</li>
<li>
<p><code>CallbackFailedException</code> class removed. The functional interfaces like
<code>HandleConsumer</code>, <code>HandleCallback</code>, <code>TransactionCallback</code>, etc can now throw
any exception type. Methods like <code>Jdbi.inTransaction</code> that take these
callbacks use exception transparency to throw only the exception thrown by
the callback. If your callback throws no checked exceptions, you don’t need
a try/catch block.</p>
</li>
<li>
<p><code>StatementLocator</code> interface removed from core. All core statements expect to
receive the actual SQL string now. A similar concept, <code>SqlLocator</code> was added
but is specific to SQL Object.</p>
</li>
<li>
<p><code>StatementRewriter</code> refactored into <code>TemplateEngine</code>, and <code>SqlParser</code>.</p>
</li>
<li>
<p>StringTemplate no longer required to process <code>&lt;name&gt;</code>-style tokens in SQL.</p>
</li>
<li>
<p>Custom SqlParser implementations must now provide a way to transform raw
parameter names to names that will be properly parsed out as named params.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SQL Object API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SQL Object support is not installed by default. It must be added as a
separate dependency, and the plugin installed into the <code>Jdbi</code> object:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Jdbi jdbi = Jdbi.create(...);<font></font>
jdbi.installPlugin(<span class="keyword">new</span> SqlObjectPlugin());</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>SQL Object types in v3 must be public interfaces—​no classes. Method return
types must likewise be public. This is due to SQL Object implementation
switching from CGLIB to <code>java.lang.reflect.Proxy</code>, which only supports
interfaces.</p>
</li>
<li>
<p><code>GetHandle</code> → <code>SqlObject</code></p>
</li>
<li>
<p><code>SqlLocator</code> replaces <code>StatementLocator</code>, and only applies to SQL Objects.</p>
</li>
<li>
<p><code>@RegisterMapper</code> divided into <code>@RegisterRowMapper</code> and
<code>@RegisterColumnMapper</code>.</p>
</li>
<li>
<p><code>@Bind</code> annotations on SQL Object method parameters can be made optional,
by compiling your code with the <code>-parameters</code> compiler flag enabled.</p>
</li>
<li>
<p><code>@BindIn</code> → <code>@BindList</code>, and no longer requires StringTemplate</p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按需 SQL 对象与返回</font></font><code>Iterable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或</font></font><code>FluentIterable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">按需对象在每次方法调用后都严格关闭句柄，不再像 v2 中那样“让门打开”让您完成对可交互对象的消费。</font><font style="vertical-align: inherit;">这排除了连接泄漏的主要来源。</font></font></p>
</li>
<li>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL 对象不再是可关闭的——它们要么是按需的，要么它们的生命周期与</font></font><code>Handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它们所附加到</font><font style="vertical-align: inherit;">的生命周期相关联</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li>
<p><code>@BindAnnotation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元注释已删除。</font><font style="vertical-align: inherit;">使用
</font></font><code>@SqlStatementCustomizingAnnotation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来代替。</font></font></p>
</li>
<li>
<p><code>@SingleValueResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font><code>@SingleValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">注释可用于方法返回类型或</font></font><code>@SqlBatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。</font></font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
版本 3.21.1-SNAPSHOT</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后更新 07/16/2021 14:53 -0700
</font></font></div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Jdbi 3 开发者指南_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>

<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>
